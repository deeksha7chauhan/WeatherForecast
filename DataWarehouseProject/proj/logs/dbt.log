[0m16:44:31.027618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675d8b0>]}


============================== 16:44:31.030070 | 222fb4b5-a5d3-4983-b2b1-300a430a56ed ==============================
[0m16:44:31.030070 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:44:31.030371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:44:31.572570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '222fb4b5-a5d3-4983-b2b1-300a430a56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a147230>]}
[0m16:44:31.593618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '222fb4b5-a5d3-4983-b2b1-300a430a56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a83530>]}
[0m16:44:31.594157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:44:31.605680 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:44:31.606156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:44:31.606332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '222fb4b5-a5d3-4983-b2b1-300a430a56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f53710>]}
[0m16:44:32.106117 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.DAILY_WEATHER' which was not found
[0m16:44:32.108863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1165353, "process_user_time": 1.280048, "process_kernel_time": 0.207732, "process_mem_max_rss": "165789696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:32.109142 [debug] [MainThread]: Command `dbt run` failed at 16:44:32.109097 after 1.12 seconds
[0m16:44:32.109333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a504a10>]}
[0m16:44:32.109476 [debug] [MainThread]: Flushing usage events
[0m16:47:56.728208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10292f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104475af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044757c0>]}


============================== 16:47:56.730812 | 2983bdd0-b57b-4e26-a36a-625254588661 ==============================
[0m16:47:56.730812 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:47:56.731108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:57.262663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27c80>]}
[0m16:47:57.283994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040744a0>]}
[0m16:47:57.284540 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:47:57.294071 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:47:57.294544 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:47:57.294724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be3f50>]}
[0m16:47:57.832195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ecce0>]}
[0m16:47:57.879554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087301a0>]}
[0m16:47:57.879785 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 459 macros
[0m16:47:57.879941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2983bdd0-b57b-4e26-a36a-625254588661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6c30>]}
[0m16:47:57.880784 [info ] [MainThread]: 
[0m16:47:57.881022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:57.882866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:47:57.888496 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:47:57.888645 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:47:57.888760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:58.756241 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:47:58.756838 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:47:58.757297 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:47:58.757628 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:47:58.758032 [debug] [ThreadPool]: On list_weather: No close available on handle
[0m16:47:58.758788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:58.759089 [debug] [MainThread]: Connection 'list_weather' was properly closed.
[0m16:47:58.759428 [info ] [MainThread]: 
[0m16:47:58.759786 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m16:47:58.760323 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "weather"
  Database Error
    250001 (08001): Failed to connect to DB: ewb58515.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m16:47:58.763299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0674694, "process_user_time": 1.541803, "process_kernel_time": 0.275316, "process_mem_max_rss": "178503680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:58.763820 [debug] [MainThread]: Command `dbt run` failed at 16:47:58.763726 after 2.07 seconds
[0m16:47:58.764165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e26c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ec2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ab590>]}
[0m16:47:58.764503 [debug] [MainThread]: Flushing usage events
[0m16:50:29.299127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f5910>]}


============================== 16:50:29.301692 | 1939aca8-60d4-46c3-ae6c-c3a85866a937 ==============================
[0m16:50:29.301692 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:50:29.301982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:29.812432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0c650>]}
[0m16:50:29.833477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba721b0>]}
[0m16:50:29.834011 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:50:29.844541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:50:29.919663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:29.919922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:29.938282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1037d0>]}
[0m16:50:29.984427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c216660>]}
[0m16:50:29.984664 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 459 macros
[0m16:50:29.984826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a6180>]}
[0m16:50:29.985684 [info ] [MainThread]: 
[0m16:50:29.985947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:29.987717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:50:29.994185 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:50:29.994351 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:50:29.994466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:30.742435 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.748 seconds
[0m16:50:30.745805 [debug] [ThreadPool]: On list_weather: Close
[0m16:50:30.899093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m16:50:30.914171 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:50:30.914588 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:50:30.914895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:31.347105 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.432 seconds
[0m16:50:31.353088 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:50:31.501102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b519a0>]}
[0m16:50:31.502272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:31.502779 [info ] [MainThread]: 
[0m16:50:31.508135 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:50:31.508925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:50:31.509424 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:50:31.519545 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:50:31.521173 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:50:31.521591 [debug] [Thread-1 (]: Began running node model.proj.my_first_dbt_model
[0m16:50:31.522191 [info ] [Thread-1 (]: 1 of 3 START sql table model data.my_first_dbt_model ........................... [RUN]
[0m16:50:31.522688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.my_first_dbt_model)
[0m16:50:31.523088 [debug] [Thread-1 (]: Began compiling node model.proj.my_first_dbt_model
[0m16:50:31.525760 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.my_first_dbt_model"
[0m16:50:31.526442 [debug] [Thread-1 (]: Began executing node model.proj.my_first_dbt_model
[0m16:50:31.549480 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.my_first_dbt_model"
[0m16:50:31.550399 [debug] [Thread-1 (]: Using snowflake connection "model.proj.my_first_dbt_model"
[0m16:50:31.550645 [debug] [Thread-1 (]: On model.proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.my_first_dbt_model"} */
create or replace transient table weather.data.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:50:31.550863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:33.233742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.682 seconds
[0m16:50:33.262333 [debug] [Thread-1 (]: On model.proj.my_first_dbt_model: Close
[0m16:50:33.394243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfaa0f0>]}
[0m16:50:33.394968 [info ] [Thread-1 (]: 1 of 3 OK created sql table model data.my_first_dbt_model ...................... [[32mSUCCESS 1[0m in 1.87s]
[0m16:50:33.395566 [debug] [Thread-1 (]: Finished running node model.proj.my_first_dbt_model
[0m16:50:33.395959 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:50:33.396461 [info ] [Thread-1 (]: 2 of 3 START sql table model data.temperature_range ............................ [RUN]
[0m16:50:33.396925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.my_first_dbt_model, now model.proj.temperature_range)
[0m16:50:33.397256 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m16:50:33.402193 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m16:50:33.402911 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m16:50:33.405531 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m16:50:33.406583 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m16:50:33.406867 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m16:50:33.407113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:34.052527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a992-0004-3863-0002-62e7000235da
[0m16:50:34.053211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m16:50:34.053749 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m16:50:34.213071 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m16:50:34.213587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c11cf20>]}
[0m16:50:34.214131 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.82s]
[0m16:50:34.214628 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:50:34.214957 [debug] [Thread-1 (]: Began running node model.proj.my_second_dbt_model
[0m16:50:34.215897 [info ] [Thread-1 (]: 3 of 3 START sql view model data.my_second_dbt_model ........................... [RUN]
[0m16:50:34.216259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.temperature_range, now model.proj.my_second_dbt_model)
[0m16:50:34.216536 [debug] [Thread-1 (]: Began compiling node model.proj.my_second_dbt_model
[0m16:50:34.219157 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.my_second_dbt_model"
[0m16:50:34.219628 [debug] [Thread-1 (]: Began executing node model.proj.my_second_dbt_model
[0m16:50:34.234649 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.my_second_dbt_model"
[0m16:50:34.235189 [debug] [Thread-1 (]: Using snowflake connection "model.proj.my_second_dbt_model"
[0m16:50:34.235406 [debug] [Thread-1 (]: On model.proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.my_second_dbt_model"} */
create or replace   view weather.data.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from weather.data.my_first_dbt_model
where id = 1
  );
[0m16:50:34.235595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:35.077178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m16:50:35.081665 [debug] [Thread-1 (]: On model.proj.my_second_dbt_model: Close
[0m16:50:35.204501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1939aca8-60d4-46c3-ae6c-c3a85866a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6c8770>]}
[0m16:50:35.205671 [info ] [Thread-1 (]: 3 of 3 OK created sql view model data.my_second_dbt_model ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m16:50:35.206487 [debug] [Thread-1 (]: Finished running node model.proj.my_second_dbt_model
[0m16:50:35.207879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:35.208209 [debug] [MainThread]: Connection 'model.proj.my_second_dbt_model' was properly closed.
[0m16:50:35.208619 [info ] [MainThread]: 
[0m16:50:35.208985 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m16:50:35.210012 [debug] [MainThread]: Command end result
[0m16:50:35.239478 [info ] [MainThread]: 
[0m16:50:35.239754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:35.239948 [info ] [MainThread]: 
[0m16:50:35.240178 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m16:50:35.240354 [info ] [MainThread]: 
[0m16:50:35.240533 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:50:35.242537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9739485, "process_user_time": 1.38552, "process_kernel_time": 0.248612, "process_mem_max_rss": "175865856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:35.243030 [debug] [MainThread]: Command `dbt run` failed at 16:50:35.242958 after 5.97 seconds
[0m16:50:35.243306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d47e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d47440>]}
[0m16:50:35.243532 [debug] [MainThread]: Flushing usage events
[0m16:53:00.474697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a71b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a71880>]}


============================== 16:53:00.477491 | 65f119ee-3b37-49af-83a5-835b61e99cf6 ==============================
[0m16:53:00.477491 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:53:00.477817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:53:01.017684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e156cf0>]}
[0m16:53:01.038729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4bac30>]}
[0m16:53:01.039301 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:53:01.050111 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:53:01.112184 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m16:53:01.112488 [debug] [MainThread]: Partial parsing: deleted file: proj://models/example/my_first_dbt_model.sql
[0m16:53:01.112619 [debug] [MainThread]: Partial parsing: deleted file: proj://models/example/my_second_dbt_model.sql
[0m16:53:01.112812 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/temperature_range.sql
[0m16:53:01.258028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.proj.example
[0m16:53:01.263143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9063c0>]}
[0m16:53:01.309123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed08da0>]}
[0m16:53:01.309343 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m16:53:01.309498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed66de0>]}
[0m16:53:01.310270 [info ] [MainThread]: 
[0m16:53:01.310514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:01.310890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:53:01.316557 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:53:01.316705 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:53:01.316822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:01.976903 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.660 seconds
[0m16:53:01.982284 [debug] [ThreadPool]: On list_weather: Close
[0m16:53:02.120789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m16:53:02.131820 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:53:02.132205 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:53:02.132512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:02.924671 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.792 seconds
[0m16:53:02.931028 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:53:03.083358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfe120>]}
[0m16:53:03.084521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:03.085024 [info ] [MainThread]: 
[0m16:53:03.089395 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:53:03.089995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:53:03.090404 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:53:03.100317 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:53:03.101487 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:53:03.102236 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:53:03.102762 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m16:53:03.103160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m16:53:03.103479 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m16:53:03.108417 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m16:53:03.109169 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m16:53:03.130897 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m16:53:03.131664 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m16:53:03.131896 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m16:53:03.132096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:03.694668 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a995-0004-3864-0002-62e700022596
[0m16:53:03.695153 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m16:53:03.695584 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m16:53:03.869570 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m16:53:03.870981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65f119ee-3b37-49af-83a5-835b61e99cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108715460>]}
[0m16:53:03.871553 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.77s]
[0m16:53:03.872055 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:53:03.873685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:03.873915 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m16:53:03.874146 [info ] [MainThread]: 
[0m16:53:03.874389 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m16:53:03.874921 [debug] [MainThread]: Command end result
[0m16:53:03.895872 [info ] [MainThread]: 
[0m16:53:03.896135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:03.896334 [info ] [MainThread]: 
[0m16:53:03.896562 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m16:53:03.896736 [info ] [MainThread]: 
[0m16:53:03.896903 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:53:03.898891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4573648, "process_user_time": 1.327874, "process_kernel_time": 0.247973, "process_mem_max_rss": "180142080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:03.899269 [debug] [MainThread]: Command `dbt run` failed at 16:53:03.899207 after 3.46 seconds
[0m16:53:03.899486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a71a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebcc410>]}
[0m16:53:03.899672 [debug] [MainThread]: Flushing usage events
[0m17:00:24.740750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45970>]}


============================== 17:00:24.743330 | 17ea7963-37b2-46f4-a1db-bfc5e9cc29a1 ==============================
[0m17:00:24.743330 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:00:24.743622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:25.277646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96f3b0>]}
[0m17:00:25.298884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45a60>]}
[0m17:00:25.299429 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:00:25.309012 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:00:25.371730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:25.372050 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/temperature_range.sql
[0m17:00:25.517781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.proj.example
[0m17:00:25.522847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae806e0>]}
[0m17:00:25.567339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb4b30>]}
[0m17:00:25.567556 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m17:00:25.567712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad242c0>]}
[0m17:00:25.568474 [info ] [MainThread]: 
[0m17:00:25.568732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:00:25.569111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m17:00:25.575014 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m17:00:25.575166 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m17:00:25.575297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:26.238477 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.663 seconds
[0m17:00:26.243187 [debug] [ThreadPool]: On list_weather: Close
[0m17:00:26.365194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m17:00:26.378523 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m17:00:26.378987 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m17:00:26.379294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:26.926950 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.547 seconds
[0m17:00:26.933578 [debug] [ThreadPool]: On list_weather_data: Close
[0m17:00:27.066643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad922a0>]}
[0m17:00:27.067798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:27.068320 [info ] [MainThread]: 
[0m17:00:27.071967 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m17:00:27.072641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m17:00:27.073106 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m17:00:27.083160 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m17:00:27.084362 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m17:00:27.085205 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m17:00:27.085812 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m17:00:27.086279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m17:00:27.086614 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m17:00:27.092965 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m17:00:27.093735 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m17:00:27.115117 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m17:00:27.116016 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m17:00:27.116246 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m17:00:27.116454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:27.588611 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a99c-0004-386b-0002-62e700021eae
[0m17:00:27.589145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m17:00:27.589679 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m17:00:27.723059 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:00:27.724650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17ea7963-37b2-46f4-a1db-bfc5e9cc29a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adac290>]}
[0m17:00:27.725309 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.64s]
[0m17:00:27.725889 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m17:00:27.727417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:27.727652 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m17:00:27.727888 [info ] [MainThread]: 
[0m17:00:27.728138 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m17:00:27.728650 [debug] [MainThread]: Command end result
[0m17:00:27.750855 [info ] [MainThread]: 
[0m17:00:27.751102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:00:27.751270 [info ] [MainThread]: 
[0m17:00:27.751484 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:00:27.751645 [info ] [MainThread]: 
[0m17:00:27.751814 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:00:27.753590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0476198, "process_user_time": 1.352291, "process_kernel_time": 0.255717, "process_mem_max_rss": "179404800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:00:27.753947 [debug] [MainThread]: Command `dbt run` failed at 17:00:27.753889 after 3.05 seconds
[0m17:00:27.754173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45c40>]}
[0m17:00:27.754380 [debug] [MainThread]: Flushing usage events
[0m17:11:15.195181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042939e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fd760>]}


============================== 17:11:15.197866 | 4293aee5-8618-4c0d-a95c-f5fe9986710d ==============================
[0m17:11:15.197866 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:11:15.198191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:15.729426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599cd70>]}
[0m17:11:15.750498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653530>]}
[0m17:11:15.751020 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:11:15.760847 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:11:15.801527 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:11:15.801812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c3a10>]}
[0m17:11:16.324340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66c90>]}
[0m17:11:16.368553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c31580>]}
[0m17:11:16.368789 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m17:11:16.368949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108beca70>]}
[0m17:11:16.369695 [info ] [MainThread]: 
[0m17:11:16.369951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:16.370315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m17:11:16.376086 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m17:11:16.376230 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m17:11:16.376345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:17.049992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.673 seconds
[0m17:11:17.053921 [debug] [ThreadPool]: On list_weather: Close
[0m17:11:17.205052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m17:11:17.219801 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m17:11:17.220280 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m17:11:17.220582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:17.749998 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.529 seconds
[0m17:11:17.754653 [debug] [ThreadPool]: On list_weather_data: Close
[0m17:11:17.889019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bec920>]}
[0m17:11:17.889736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:17.890119 [info ] [MainThread]: 
[0m17:11:17.893543 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m17:11:17.894000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m17:11:17.894344 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m17:11:17.902064 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m17:11:17.902998 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m17:11:17.903610 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m17:11:17.904162 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m17:11:17.904499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m17:11:17.904768 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m17:11:17.910458 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m17:11:17.911186 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m17:11:17.930738 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m17:11:17.931571 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m17:11:17.931785 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m17:11:17.931971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:18.417447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a9a7-0004-3868-0002-62e7000264fe
[0m17:11:18.418122 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m17:11:18.418805 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m17:11:18.546642 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:11:18.548507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4293aee5-8618-4c0d-a95c-f5fe9986710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb1970>]}
[0m17:11:18.549256 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.64s]
[0m17:11:18.549857 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m17:11:18.551501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:18.551776 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m17:11:18.552051 [info ] [MainThread]: 
[0m17:11:18.552330 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m17:11:18.552918 [debug] [MainThread]: Command end result
[0m17:11:18.576613 [info ] [MainThread]: 
[0m17:11:18.576884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:18.577071 [info ] [MainThread]: 
[0m17:11:18.577302 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:11:18.577478 [info ] [MainThread]: 
[0m17:11:18.577656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:18.579611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4168084, "process_user_time": 1.719308, "process_kernel_time": 0.245161, "process_mem_max_rss": "181059584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:11:18.579934 [debug] [MainThread]: Command `dbt run` failed at 17:11:18.579881 after 3.42 seconds
[0m17:11:18.580147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042939e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104347200>]}
[0m17:11:18.580341 [debug] [MainThread]: Flushing usage events
[0m17:13:51.441505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104431070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470d910>]}


============================== 17:13:51.443949 | 81d232a0-3bac-4234-9d65-b2068a91495d ==============================
[0m17:13:51.443949 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:13:51.444240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:51.924826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838f5f0>]}
[0m17:13:51.945944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c8f50>]}
[0m17:13:51.946493 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:13:51.956323 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:13:52.016107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:52.016429 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/temperature_range.sql
[0m17:13:52.165720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108909e50>]}
[0m17:13:52.208618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108984ce0>]}
[0m17:13:52.208836 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m17:13:52.208998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a3e60>]}
[0m17:13:52.209770 [info ] [MainThread]: 
[0m17:13:52.210025 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:52.210410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m17:13:52.216232 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m17:13:52.216377 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m17:13:52.216493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:52.953111 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.736 seconds
[0m17:13:52.958508 [debug] [ThreadPool]: On list_weather: Close
[0m17:13:53.089157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m17:13:53.097328 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m17:13:53.097604 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m17:13:53.097817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:53.773505 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.675 seconds
[0m17:13:53.778729 [debug] [ThreadPool]: On list_weather_data: Close
[0m17:13:53.939334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abab40>]}
[0m17:13:53.939904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:53.940217 [info ] [MainThread]: 
[0m17:13:53.943265 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m17:13:53.943720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m17:13:53.944057 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m17:13:53.950945 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m17:13:53.951740 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m17:13:53.952341 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m17:13:53.952683 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m17:13:53.952961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m17:13:53.953187 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m17:13:53.957391 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m17:13:53.957857 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m17:13:53.976647 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m17:13:53.977430 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m17:13:53.977653 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m17:13:53.977844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:54.464691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a9a9-0004-3869-0002-62e700027616
[0m17:13:54.465237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m17:13:54.465762 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m17:13:54.592694 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:13:54.595270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81d232a0-3bac-4234-9d65-b2068a91495d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cad310>]}
[0m17:13:54.596277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.64s]
[0m17:13:54.596977 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m17:13:54.599293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:54.599717 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m17:13:54.600078 [info ] [MainThread]: 
[0m17:13:54.600441 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m17:13:54.601207 [debug] [MainThread]: Command end result
[0m17:13:54.627785 [info ] [MainThread]: 
[0m17:13:54.628128 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:13:54.628325 [info ] [MainThread]: 
[0m17:13:54.628574 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:13:54.628760 [info ] [MainThread]: 
[0m17:13:54.628950 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:13:54.631154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2198706, "process_user_time": 1.328505, "process_kernel_time": 0.228527, "process_mem_max_rss": "179388416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:13:54.631590 [debug] [MainThread]: Command `dbt run` failed at 17:13:54.631527 after 3.22 seconds
[0m17:13:54.631879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470dbb0>]}
[0m17:13:54.632115 [debug] [MainThread]: Flushing usage events
[0m17:21:06.290676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106121af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106121820>]}


============================== 17:21:06.293443 | a5e6f82f-0907-4c3f-b366-468d9745a91b ==============================
[0m17:21:06.293443 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:21:06.293777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:06.807793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098971a0>]}
[0m17:21:06.829000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6a9f0>]}
[0m17:21:06.829549 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:21:06.838943 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:21:06.901617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:06.901818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:06.919521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718bdd0>]}
[0m17:21:06.967079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a155910>]}
[0m17:21:06.967292 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m17:21:06.967456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e43200>]}
[0m17:21:06.968243 [info ] [MainThread]: 
[0m17:21:06.968510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:06.968899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m17:21:06.975285 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m17:21:06.975439 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m17:21:06.975558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:08.325627 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.350 seconds
[0m17:21:08.329097 [debug] [ThreadPool]: On list_weather: Close
[0m17:21:08.474622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m17:21:08.488613 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m17:21:08.489075 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m17:21:08.489366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:09.069066 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.579 seconds
[0m17:21:09.073072 [debug] [ThreadPool]: On list_weather_data: Close
[0m17:21:09.200094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8aea0>]}
[0m17:21:09.200710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:09.201028 [info ] [MainThread]: 
[0m17:21:09.204027 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m17:21:09.204482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m17:21:09.204837 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m17:21:09.212280 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m17:21:09.213152 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m17:21:09.213858 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m17:21:09.214352 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m17:21:09.214706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m17:21:09.214957 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m17:21:09.219276 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m17:21:09.219884 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m17:21:09.239792 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m17:21:09.240562 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m17:21:09.240778 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m17:21:09.240965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:09.762850 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a9b1-0004-3865-0002-62e7000285ae
[0m17:21:09.763319 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m17:21:09.763765 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m17:21:10.421224 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:21:10.422648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e6f82f-0907-4c3f-b366-468d9745a91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ebef0>]}
[0m17:21:10.423225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 1.21s]
[0m17:21:10.423667 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m17:21:10.425111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:10.425317 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m17:21:10.425528 [info ] [MainThread]: 
[0m17:21:10.425752 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m17:21:10.426193 [debug] [MainThread]: Command end result
[0m17:21:10.444879 [info ] [MainThread]: 
[0m17:21:10.445124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:10.445284 [info ] [MainThread]: 
[0m17:21:10.445499 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:21:10.445664 [info ] [MainThread]: 
[0m17:21:10.445844 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:21:10.447687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.190883, "process_user_time": 1.192537, "process_kernel_time": 0.24931, "process_mem_max_rss": "174653440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:10.448026 [debug] [MainThread]: Command `dbt run` failed at 17:21:10.447975 after 4.19 seconds
[0m17:21:10.448235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a386ff0>]}
[0m17:21:10.448411 [debug] [MainThread]: Flushing usage events
[0m17:24:41.294661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1d430>]}


============================== 17:24:41.297442 | 13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3 ==============================
[0m17:24:41.297442 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:24:41.297779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:41.819527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5471a0>]}
[0m17:24:41.840726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f9700>]}
[0m17:24:41.841289 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:24:41.851235 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:24:41.913754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:41.913960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:41.931603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc7380>]}
[0m17:24:41.978452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce86180>]}
[0m17:24:41.978669 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m17:24:41.978839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd78500>]}
[0m17:24:41.979613 [info ] [MainThread]: 
[0m17:24:41.979875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:41.980259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m17:24:41.986637 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m17:24:41.986794 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m17:24:41.986911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:42.587855 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.601 seconds
[0m17:24:42.592000 [debug] [ThreadPool]: On list_weather: Close
[0m17:24:42.729612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m17:24:42.737420 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m17:24:42.737722 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m17:24:42.737933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:43.276105 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.538 seconds
[0m17:24:43.280028 [debug] [ThreadPool]: On list_weather_data: Close
[0m17:24:43.412169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb3aea0>]}
[0m17:24:43.413400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:43.413865 [info ] [MainThread]: 
[0m17:24:43.417150 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m17:24:43.417823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m17:24:43.418273 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m17:24:43.427089 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m17:24:43.428080 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m17:24:43.428763 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m17:24:43.429296 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m17:24:43.429686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m17:24:43.429971 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m17:24:43.434821 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m17:24:43.435574 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m17:24:43.457632 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m17:24:43.458436 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m17:24:43.458669 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data;
[0m17:24:43.458867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:43.984313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a9b4-0004-3863-0002-62e700023616
[0m17:24:43.984963 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 26 unexpected ';'.
[0m17:24:43.985734 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m17:24:44.144469 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:24:44.145702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c19cbc-29a8-4d7a-a8bd-2c1aea75cfc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bd3a0>]}
[0m17:24:44.146214 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.72s]
[0m17:24:44.146664 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m17:24:44.147991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:44.148217 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m17:24:44.148434 [info ] [MainThread]: 
[0m17:24:44.148664 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m17:24:44.149122 [debug] [MainThread]: Command end result
[0m17:24:44.166439 [info ] [MainThread]: 
[0m17:24:44.166680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:44.166837 [info ] [MainThread]: 
[0m17:24:44.167030 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 26 unexpected ';'.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m17:24:44.167189 [info ] [MainThread]: 
[0m17:24:44.167347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:44.169223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9108596, "process_user_time": 1.18081, "process_kernel_time": 0.239425, "process_mem_max_rss": "173998080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:44.169552 [debug] [MainThread]: Command `dbt run` failed at 17:24:44.169498 after 2.91 seconds
[0m17:24:44.169760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108867b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1d8b0>]}
[0m17:24:44.169942 [debug] [MainThread]: Flushing usage events
[0m17:53:18.410849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2da00>]}


============================== 17:53:18.413595 | 37a26334-d7ba-4387-8c20-19b1f9100e5c ==============================
[0m17:53:18.413595 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:53:18.413926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:18.933262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a26334-d7ba-4387-8c20-19b1f9100e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ddc0>]}
[0m17:53:18.954501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37a26334-d7ba-4387-8c20-19b1f9100e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103ca40>]}
[0m17:53:18.955065 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:53:18.965230 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:53:19.028270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:19.028674 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m17:53:19.181093 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m17:53:19.183788 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.8060152, "process_user_time": 0.994875, "process_kernel_time": 0.203828, "process_mem_max_rss": "166395904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:19.184092 [debug] [MainThread]: Command `dbt compile` failed at 17:53:19.184043 after 0.81 seconds
[0m17:53:19.184282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11585b440>]}
[0m17:53:19.184431 [debug] [MainThread]: Flushing usage events
[0m17:53:30.186021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a5910>]}


============================== 17:53:30.187897 | 0f079e6d-c815-42d8-a4a7-b0e2bed67755 ==============================
[0m17:53:30.187897 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:53:30.188186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:53:30.484120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f079e6d-c815-42d8-a4a7-b0e2bed67755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108378830>]}
[0m17:53:30.505403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f079e6d-c815-42d8-a4a7-b0e2bed67755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794b530>]}
[0m17:53:30.505970 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:53:30.514902 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:53:30.574400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:30.574797 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m17:53:30.726110 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m17:53:30.728831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5717779, "process_user_time": 0.984532, "process_kernel_time": 0.122894, "process_mem_max_rss": "167362560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:30.729122 [debug] [MainThread]: Command `dbt run` failed at 17:53:30.729076 after 0.57 seconds
[0m17:53:30.729321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8e00>]}
[0m17:53:30.729474 [debug] [MainThread]: Flushing usage events
[0m17:54:15.133705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108575550>]}


============================== 17:54:15.135587 | e174b50a-e9b2-40a1-b016-6d445554ba81 ==============================
[0m17:54:15.135587 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:15.135877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:54:15.440303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e174b50a-e9b2-40a1-b016-6d445554ba81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d67560>]}
[0m17:54:15.461156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e174b50a-e9b2-40a1-b016-6d445554ba81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095befc0>]}
[0m17:54:15.461516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:15.469564 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:15.517727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:15.518101 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m17:54:15.666747 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m17:54:15.667767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5620707, "process_user_time": 0.979964, "process_kernel_time": 0.124359, "process_mem_max_rss": "163905536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:15.668037 [debug] [MainThread]: Command `dbt run` failed at 17:54:15.667992 after 0.56 seconds
[0m17:54:15.668220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f05f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76eb40>]}
[0m17:54:15.668370 [debug] [MainThread]: Flushing usage events
[0m17:56:19.182034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d6f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043959a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043956d0>]}


============================== 17:56:19.184833 | 9c389d22-9d19-457f-be54-568facb30c9a ==============================
[0m17:56:19.184833 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:56:19.185163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:56:19.729707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c389d22-9d19-457f-be54-568facb30c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0de20>]}
[0m17:56:19.750846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c389d22-9d19-457f-be54-568facb30c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107585670>]}
[0m17:56:19.751357 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:56:19.762299 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:56:19.826137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:19.826532 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m17:56:19.978840 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m17:56:19.981679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.83342063, "process_user_time": 0.996324, "process_kernel_time": 0.219014, "process_mem_max_rss": "165953536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:56:19.981958 [debug] [MainThread]: Command `dbt run` failed at 17:56:19.981910 after 0.83 seconds
[0m17:56:19.982147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104394b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103159c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cb9d90>]}
[0m17:56:19.982301 [debug] [MainThread]: Flushing usage events
[0m17:57:42.040982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107369010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045435f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a6af00>]}


============================== 17:57:42.043829 | d7e3df95-1a88-4532-832a-b1a544727fbe ==============================
[0m17:57:42.043829 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:57:42.044158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:42.582391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7e3df95-1a88-4532-832a-b1a544727fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d43590>]}
[0m17:57:42.603584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7e3df95-1a88-4532-832a-b1a544727fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107947230>]}
[0m17:57:42.604098 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:57:42.614207 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:57:42.676602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:42.676988 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m17:57:42.833767 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m17:57:42.835851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8269537, "process_user_time": 1.006911, "process_kernel_time": 0.212708, "process_mem_max_rss": "167821312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:57:42.836221 [debug] [MainThread]: Command `dbt run` failed at 17:57:42.836166 after 0.83 seconds
[0m17:57:42.836453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149591f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b5d90>]}
[0m17:57:42.836993 [debug] [MainThread]: Flushing usage events
[0m18:00:08.854603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf1490>]}


============================== 18:00:08.857304 | 4916c73f-b395-46d3-9d74-ad14268e0442 ==============================
[0m18:00:08.857304 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:00:08.857583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:00:08.865550 [info ] [MainThread]: dbt version: 1.8.7
[0m18:00:08.865719 [info ] [MainThread]: python version: 3.12.2
[0m18:00:08.865843 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m18:00:08.865954 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m18:00:09.335544 [info ] [MainThread]: Using profiles dir at /Users/gayatripatil/.dbt
[0m18:00:09.335810 [info ] [MainThread]: Using profiles.yml file at /Users/gayatripatil/.dbt/profiles.yml
[0m18:00:09.335968 [info ] [MainThread]: Using dbt_project.yml file at /Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/dbt_project.yml
[0m18:00:09.336382 [info ] [MainThread]: adapter type: snowflake
[0m18:00:09.336560 [info ] [MainThread]: adapter version: 1.8.4
[0m18:00:09.368973 [info ] [MainThread]: Configuration:
[0m18:00:09.369181 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:00:09.369310 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:00:09.369440 [info ] [MainThread]: Required dependencies:
[0m18:00:09.369610 [debug] [MainThread]: Executing "git --help"
[0m18:00:09.384667 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:00:09.385117 [debug] [MainThread]: STDERR: "b''"
[0m18:00:09.385259 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:00:09.385401 [info ] [MainThread]: Connection:
[0m18:00:09.385539 [info ] [MainThread]:   account: ewb58515
[0m18:00:09.385652 [info ] [MainThread]:   user: gayatripatil22
[0m18:00:09.385751 [info ] [MainThread]:   database: weather
[0m18:00:09.385851 [info ] [MainThread]:   warehouse: compute_wh
[0m18:00:09.385947 [info ] [MainThread]:   role: Accountadmin
[0m18:00:09.386045 [info ] [MainThread]:   schema: data
[0m18:00:09.386144 [info ] [MainThread]:   authenticator: None
[0m18:00:09.386239 [info ] [MainThread]:   oauth_client_id: None
[0m18:00:09.386339 [info ] [MainThread]:   query_tag: None
[0m18:00:09.386436 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:00:09.386533 [info ] [MainThread]:   host: None
[0m18:00:09.386629 [info ] [MainThread]:   port: None
[0m18:00:09.386724 [info ] [MainThread]:   proxy_host: None
[0m18:00:09.386818 [info ] [MainThread]:   proxy_port: None
[0m18:00:09.386911 [info ] [MainThread]:   protocol: None
[0m18:00:09.387010 [info ] [MainThread]:   connect_retries: 1
[0m18:00:09.387106 [info ] [MainThread]:   connect_timeout: None
[0m18:00:09.387200 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:00:09.387296 [info ] [MainThread]:   retry_all: False
[0m18:00:09.387387 [info ] [MainThread]:   insecure_mode: False
[0m18:00:09.387481 [info ] [MainThread]:   reuse_connections: None
[0m18:00:09.387795 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:09.391183 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:00:09.391922 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:00:09.392059 [debug] [MainThread]: On debug: select 1 as id
[0m18:00:09.392174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:09.958903 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.566 seconds
[0m18:00:09.962969 [debug] [MainThread]: On debug: Close
[0m18:00:10.103273 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:00:10.104329 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:00:10.108474 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2844008, "process_user_time": 0.854628, "process_kernel_time": 0.204065, "process_mem_max_rss": "166543360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:00:10.109417 [debug] [MainThread]: Command `dbt debug` succeeded at 18:00:10.109267 after 1.29 seconds
[0m18:00:10.109988 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:00:10.110764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b846d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adad80>]}
[0m18:00:10.111448 [debug] [MainThread]: Flushing usage events
[0m18:00:36.977554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108915940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089154f0>]}


============================== 18:00:36.979477 | a4bc204d-67c4-4abc-a635-73cc10352e34 ==============================
[0m18:00:36.979477 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:00:36.979758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:37.296366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4bc204d-67c4-4abc-a635-73cc10352e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c597500>]}
[0m18:00:37.317260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4bc204d-67c4-4abc-a635-73cc10352e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3bd190>]}
[0m18:00:37.317609 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:37.326100 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:00:37.389046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:37.389439 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m18:00:37.540413 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m18:00:37.541467 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.59156144, "process_user_time": 0.9818, "process_kernel_time": 0.126126, "process_mem_max_rss": "165822464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:00:37.541782 [debug] [MainThread]: Command `dbt source freshness` failed at 18:00:37.541733 after 0.59 seconds
[0m18:00:37.541964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089158e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca632c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991a780>]}
[0m18:00:37.542118 [debug] [MainThread]: Flushing usage events
[0m18:01:18.649662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105887740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a91f0>]}


============================== 18:01:18.651520 | 7febb26f-a575-45db-af8c-2753874bc59c ==============================
[0m18:01:18.651520 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:18.651810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:18.945937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7febb26f-a575-45db-af8c-2753874bc59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077120f0>]}
[0m18:01:18.966859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7febb26f-a575-45db-af8c-2753874bc59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ec2f0>]}
[0m18:01:18.967217 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:18.975260 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:19.023923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:19.024302 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m18:01:19.173537 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m18:01:19.174603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5523655, "process_user_time": 0.982867, "process_kernel_time": 0.122236, "process_mem_max_rss": "165822464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:01:19.174897 [debug] [MainThread]: Command `dbt run` failed at 18:01:19.174851 after 0.55 seconds
[0m18:01:19.175081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f011f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a728e30>]}
[0m18:01:19.175230 [debug] [MainThread]: Flushing usage events
[0m18:30:59.384797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d24c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109475940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094751f0>]}


============================== 18:30:59.387468 | df2d6b4f-2885-46bf-914f-98697a41c531 ==============================
[0m18:30:59.387468 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:30:59.387799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:59.887023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2d6b4f-2885-46bf-914f-98697a41c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b4650>]}
[0m18:30:59.908147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2d6b4f-2885-46bf-914f-98697a41c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d17be30>]}
[0m18:30:59.908692 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:30:59.918087 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:30:59.980607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:59.980992 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m18:31:00.133234 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m18:31:00.135841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7833677, "process_user_time": 0.997042, "process_kernel_time": 0.200491, "process_mem_max_rss": "165920768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:00.136126 [debug] [MainThread]: Command `dbt run` failed at 18:31:00.136078 after 0.78 seconds
[0m18:31:00.136319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebce990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109475850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094757c0>]}
[0m18:31:00.136471 [debug] [MainThread]: Flushing usage events
[0m18:40:37.551928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f9a30>]}


============================== 18:40:37.554526 | f6f16a19-ddd9-402e-ac8c-cca0f65362f0 ==============================
[0m18:40:37.554526 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:37.554806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:40:39.247248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6f16a19-ddd9-402e-ac8c-cca0f65362f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be9b80>]}
[0m18:40:39.268369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6f16a19-ddd9-402e-ac8c-cca0f65362f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108152240>]}
[0m18:40:39.268914 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:40:39.303715 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:40:39.366897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:39.367263 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m18:40:39.517708 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m18:40:39.546484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0277154, "process_user_time": 1.119724, "process_kernel_time": 0.274697, "process_mem_max_rss": "167641088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:39.546817 [debug] [MainThread]: Command `dbt run` failed at 18:40:39.546767 after 2.03 seconds
[0m18:40:39.547026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c51370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e7a40>]}
[0m18:40:39.547204 [debug] [MainThread]: Flushing usage events
[0m18:41:32.684395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a72dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a72d9a0>]}


============================== 18:41:32.687033 | 28754cc1-5173-4cb5-b29a-90d359e343be ==============================
[0m18:41:32.687033 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:41:32.687323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:33.179846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28754cc1-5173-4cb5-b29a-90d359e343be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d307c80>]}
[0m18:41:33.200702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28754cc1-5173-4cb5-b29a-90d359e343be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ad100>]}
[0m18:41:33.201907 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:41:33.213171 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:41:33.274342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:33.274727 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m18:41:33.426814 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m18:41:33.429590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7757214, "process_user_time": 0.996593, "process_kernel_time": 0.203403, "process_mem_max_rss": "165199872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:41:33.429864 [debug] [MainThread]: Command `dbt run` failed at 18:41:33.429820 after 0.78 seconds
[0m18:41:33.430048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9051f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f283740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a72dc70>]}
[0m18:41:33.430191 [debug] [MainThread]: Flushing usage events
[0m23:17:37.374943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106180740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106906e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdd7f0>]}


============================== 23:17:37.377569 | 16094c8e-1165-4a05-a85f-9ac3c06d42de ==============================
[0m23:17:37.377569 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:17:37.377884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:17:37.903150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16094c8e-1165-4a05-a85f-9ac3c06d42de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069300b0>]}
[0m23:17:37.924359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16094c8e-1165-4a05-a85f-9ac3c06d42de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f00140>]}
[0m23:17:37.924900 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:17:37.963410 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:17:38.025647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:17:38.026033 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m23:17:38.177161 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m23:17:38.179899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.83750427, "process_user_time": 1.005821, "process_kernel_time": 0.216656, "process_mem_max_rss": "166068224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:17:38.180173 [debug] [MainThread]: Command `dbt run` failed at 23:17:38.180129 after 0.84 seconds
[0m23:17:38.180362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a58b0>]}
[0m23:17:38.180511 [debug] [MainThread]: Flushing usage events
[0m16:33:20.108692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e7d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99580>]}


============================== 16:33:20.111289 | ab5c8e80-43df-41f9-9394-c304f8881f7e ==============================
[0m16:33:20.111289 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:33:20.111615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:20.120467 [info ] [MainThread]: dbt version: 1.8.7
[0m16:33:20.120637 [info ] [MainThread]: python version: 3.12.2
[0m16:33:20.120764 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m16:33:20.120874 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m16:33:20.557034 [info ] [MainThread]: Using profiles dir at /Users/gayatripatil/.dbt
[0m16:33:20.557286 [info ] [MainThread]: Using profiles.yml file at /Users/gayatripatil/.dbt/profiles.yml
[0m16:33:20.557439 [info ] [MainThread]: Using dbt_project.yml file at /Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/dbt_project.yml
[0m16:33:20.557859 [info ] [MainThread]: adapter type: snowflake
[0m16:33:20.558032 [info ] [MainThread]: adapter version: 1.8.4
[0m16:33:20.590344 [info ] [MainThread]: Configuration:
[0m16:33:20.590539 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:33:20.590676 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:33:20.590794 [info ] [MainThread]: Required dependencies:
[0m16:33:20.590949 [debug] [MainThread]: Executing "git --help"
[0m16:33:20.617905 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:33:20.618356 [debug] [MainThread]: STDERR: "b''"
[0m16:33:20.618490 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:33:20.618632 [info ] [MainThread]: Connection:
[0m16:33:20.618768 [info ] [MainThread]:   account: ewb58515
[0m16:33:20.618874 [info ] [MainThread]:   user: gayatripatil22
[0m16:33:20.618976 [info ] [MainThread]:   database: weather
[0m16:33:20.619079 [info ] [MainThread]:   warehouse: compute_wh
[0m16:33:20.619176 [info ] [MainThread]:   role: Accountadmin
[0m16:33:20.619275 [info ] [MainThread]:   schema: data
[0m16:33:20.619374 [info ] [MainThread]:   authenticator: None
[0m16:33:20.619478 [info ] [MainThread]:   oauth_client_id: None
[0m16:33:20.619574 [info ] [MainThread]:   query_tag: None
[0m16:33:20.619672 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:33:20.619770 [info ] [MainThread]:   host: None
[0m16:33:20.619865 [info ] [MainThread]:   port: None
[0m16:33:20.619960 [info ] [MainThread]:   proxy_host: None
[0m16:33:20.620058 [info ] [MainThread]:   proxy_port: None
[0m16:33:20.620152 [info ] [MainThread]:   protocol: None
[0m16:33:20.620247 [info ] [MainThread]:   connect_retries: 1
[0m16:33:20.620344 [info ] [MainThread]:   connect_timeout: None
[0m16:33:20.620438 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:33:20.620534 [info ] [MainThread]:   retry_all: False
[0m16:33:20.620629 [info ] [MainThread]:   insecure_mode: False
[0m16:33:20.620722 [info ] [MainThread]:   reuse_connections: None
[0m16:33:20.621025 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:33:20.624944 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:33:20.625670 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:33:20.625807 [debug] [MainThread]: On debug: select 1 as id
[0m16:33:20.625924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:21.807929 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.182 seconds
[0m16:33:21.810668 [debug] [MainThread]: On debug: Close
[0m16:33:21.969056 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:33:21.969600 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:33:21.973731 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8956714, "process_user_time": 0.872483, "process_kernel_time": 0.197583, "process_mem_max_rss": "167182336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:33:21.974483 [debug] [MainThread]: Command `dbt debug` succeeded at 16:33:21.974347 after 1.90 seconds
[0m16:33:21.974881 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:33:21.975251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d74560>]}
[0m16:33:21.975671 [debug] [MainThread]: Flushing usage events
[0m16:33:30.685755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10279c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436d7f0>]}


============================== 16:33:30.687608 | b09586b1-fb87-45cc-9f84-3475d1bb74a9 ==============================
[0m16:33:30.687608 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:33:30.687895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:31.003493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09586b1-fb87-45cc-9f84-3475d1bb74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042533b0>]}
[0m16:33:31.024486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09586b1-fb87-45cc-9f84-3475d1bb74a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d3380>]}
[0m16:33:31.024839 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:33:31.033513 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:33:31.095527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:33:31.095914 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:33:31.246499 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m16:33:31.247536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5894667, "process_user_time": 0.98207, "process_kernel_time": 0.128845, "process_mem_max_rss": "166854656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:33:31.247809 [debug] [MainThread]: Command `dbt run` failed at 16:33:31.247764 after 0.59 seconds
[0m16:33:31.247995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108141850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c590a0>]}
[0m16:33:31.248145 [debug] [MainThread]: Flushing usage events
[0m16:34:07.615289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a218b0>]}


============================== 16:34:07.617231 | 587300c6-332a-4a58-9a0a-734d32f6c074 ==============================
[0m16:34:07.617231 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:34:07.617521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:07.925339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '587300c6-332a-4a58-9a0a-734d32f6c074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c6f60>]}
[0m16:34:07.946506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '587300c6-332a-4a58-9a0a-734d32f6c074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ff2f0>]}
[0m16:34:07.946882 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:34:07.954943 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:34:08.004401 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m16:34:08.004822 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:34:08.005024 [debug] [MainThread]: Partial parsing: deleted file: proj://models/input/daily_weather.sql
[0m16:34:08.159978 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.temperature_range' (models/output/temperature_range.sql) depends on a node named 'daily_weather' which was not found
[0m16:34:08.161014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5749718, "process_user_time": 0.979655, "process_kernel_time": 0.152616, "process_mem_max_rss": "165445632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:08.161289 [debug] [MainThread]: Command `dbt run` failed at 16:34:08.161242 after 0.58 seconds
[0m16:34:08.161476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cba34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb839e0>]}
[0m16:34:08.161628 [debug] [MainThread]: Flushing usage events
[0m16:35:11.873217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bfd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c97c0>]}


============================== 16:35:11.875809 | 88db3a44-ccc4-4e97-8bee-57927c0e0074 ==============================
[0m16:35:11.875809 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:35:11.876103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:35:12.337624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88db3a44-ccc4-4e97-8bee-57927c0e0074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a41e20>]}
[0m16:35:12.358495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88db3a44-ccc4-4e97-8bee-57927c0e0074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107464ef0>]}
[0m16:35:12.359711 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:35:12.370186 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:35:12.430650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:35:12.431048 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:35:12.431201 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m16:35:12.581884 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m16:35:12.584257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7415389, "process_user_time": 0.996373, "process_kernel_time": 0.190099, "process_mem_max_rss": "166461440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:12.584528 [debug] [MainThread]: Command `dbt run` failed at 16:35:12.584483 after 0.74 seconds
[0m16:35:12.584706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041218b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084091f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bcf80>]}
[0m16:35:12.584853 [debug] [MainThread]: Flushing usage events
[0m16:37:07.039480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd700>]}


============================== 16:37:07.041867 | a83d6057-2a24-44c5-ac75-e15ce0a80866 ==============================
[0m16:37:07.041867 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:37:07.042147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:07.439612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a83d6057-2a24-44c5-ac75-e15ce0a80866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ab0b0>]}
[0m16:37:07.460784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a83d6057-2a24-44c5-ac75-e15ce0a80866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce8ef0>]}
[0m16:37:07.461961 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:37:07.470288 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:37:07.530138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:37:07.530562 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:37:07.530720 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m16:37:07.680056 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m16:37:07.687138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6766536, "process_user_time": 0.998676, "process_kernel_time": 0.165554, "process_mem_max_rss": "165412864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:07.687428 [debug] [MainThread]: Command `dbt run` failed at 16:37:07.687381 after 0.68 seconds
[0m16:37:07.687618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd910>]}
[0m16:37:07.687776 [debug] [MainThread]: Flushing usage events
[0m16:40:43.244486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d15a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104629c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046299d0>]}


============================== 16:40:43.247117 | 65074602-9f51-4aa6-8155-66af66868923 ==============================
[0m16:40:43.247117 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:40:43.247444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:40:43.747111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65074602-9f51-4aa6-8155-66af66868923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105690950>]}
[0m16:40:43.768142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65074602-9f51-4aa6-8155-66af66868923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437f530>]}
[0m16:40:43.768669 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:40:43.778535 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:40:43.841202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:40:43.841601 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:40:43.841750 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m16:40:43.992837 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'weather.data.daily_weather' which was not found
[0m16:40:43.995670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7844242, "process_user_time": 0.992744, "process_kernel_time": 0.192264, "process_mem_max_rss": "167526400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:40:43.995967 [debug] [MainThread]: Command `dbt run` failed at 16:40:43.995924 after 0.78 seconds
[0m16:40:43.996169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104629c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888e270>]}
[0m16:40:43.996328 [debug] [MainThread]: Flushing usage events
[0m16:41:59.833873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ff770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105371a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105371790>]}


============================== 16:41:59.835799 | 0a09aa23-9341-4348-bee3-18b20c4445e1 ==============================
[0m16:41:59.835799 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:41:59.836087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:42:00.140687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a09aa23-9341-4348-bee3-18b20c4445e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528ef0>]}
[0m16:42:00.161598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a09aa23-9341-4348-bee3-18b20c4445e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ee540>]}
[0m16:42:00.161969 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:42:00.170208 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:42:00.219801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:42:00.220171 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:42:00.220324 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m16:42:00.370655 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'weather.data.daily_weather' which was not found
[0m16:42:00.371696 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.56587815, "process_user_time": 0.981457, "process_kernel_time": 0.148801, "process_mem_max_rss": "166412288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:00.372012 [debug] [MainThread]: Command `dbt source freshness` failed at 16:42:00.371964 after 0.57 seconds
[0m16:42:00.372198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105371a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ccaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035db050>]}
[0m16:42:00.372352 [debug] [MainThread]: Flushing usage events
[0m16:43:34.129778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104855be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104855910>]}


============================== 16:43:34.132612 | 0a84ef1c-2266-4a74-a7b1-f33cab214648 ==============================
[0m16:43:34.132612 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:43:34.132933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:43:34.632748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a84ef1c-2266-4a74-a7b1-f33cab214648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104882180>]}
[0m16:43:34.653668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a84ef1c-2266-4a74-a7b1-f33cab214648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed4ef0>]}
[0m16:43:34.654882 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:43:34.666554 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:43:34.726991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:43:34.727384 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m16:43:34.727535 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m16:43:34.879106 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m16:43:34.881864 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.7824897, "process_user_time": 0.994788, "process_kernel_time": 0.200845, "process_mem_max_rss": "164331520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:34.882185 [debug] [MainThread]: Command `dbt source freshness` failed at 16:43:34.882135 after 0.78 seconds
[0m16:43:34.882364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857d7c0>]}
[0m16:43:34.882518 [debug] [MainThread]: Flushing usage events
[0m16:45:12.111059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108750ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a01190>]}


============================== 16:45:12.113469 | 8a50289f-3a91-4ba5-877a-bd11852d3b7a ==============================
[0m16:45:12.113469 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:45:12.113752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:12.175052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a50289f-3a91-4ba5-877a-bd11852d3b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ed8b0>]}
[0m16:45:12.189561 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10789375, "process_user_time": 0.577447, "process_kernel_time": 0.10279, "process_mem_max_rss": "94306304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:12.189805 [debug] [MainThread]: Command `dbt clean` succeeded at 16:45:12.189767 after 0.11 seconds
[0m16:45:12.190027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a01490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107813fb0>]}
[0m16:45:12.190170 [debug] [MainThread]: Flushing usage events
[0m16:45:24.712600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b96d0>]}


============================== 16:45:24.714461 | 7055cbc5-0505-4621-bb2f-0e86c992abd3 ==============================
[0m16:45:24.714461 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:45:24.714743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m16:45:25.123823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac82f0>]}
[0m16:45:25.144817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c0aa0>]}
[0m16:45:25.146036 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:45:25.157926 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:45:25.158445 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:45:25.158623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa7320>]}
[0m16:45:25.686793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c33c470>]}
[0m16:45:25.731301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f8920>]}
[0m16:45:25.731552 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m16:45:25.731708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c33da60>]}
[0m16:45:25.732526 [info ] [MainThread]: 
[0m16:45:25.732790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:25.734522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m16:45:25.741117 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:45:25.741266 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:45:25.741387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:26.571482 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.830 seconds
[0m16:45:26.575522 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:45:26.711124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7055cbc5-0505-4621-bb2f-0e86c992abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c276c90>]}
[0m16:45:26.711650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:26.711931 [info ] [MainThread]: 
[0m16:45:26.715849 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:45:26.716221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:45:26.716510 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:45:26.722908 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:45:26.723870 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m16:45:26.724400 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:45:26.725006 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:45:26.725386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m16:45:26.725658 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m16:45:26.727561 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m16:45:26.728107 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m16:45:26.728526 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:45:26.728937 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_date.db8671eb3d
[0m16:45:26.729267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.temperature_range, now test.proj.not_null_temperature_range_date.db8671eb3d)
[0m16:45:26.729483 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_date.db8671eb3d
[0m16:45:26.737555 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_date.db8671eb3d"
[0m16:45:26.738034 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_date.db8671eb3d
[0m16:45:26.738410 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_date.db8671eb3d
[0m16:45:26.738630 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_date.b53bc42835
[0m16:45:26.738848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_date.db8671eb3d, now test.proj.unique_temperature_range_date.b53bc42835)
[0m16:45:26.739033 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_date.b53bc42835
[0m16:45:26.742464 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_date.b53bc42835"
[0m16:45:26.742812 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_date.b53bc42835
[0m16:45:26.743149 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_date.b53bc42835
[0m16:45:26.743547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:26.743692 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_date.b53bc42835' was properly closed.
[0m16:45:26.744171 [debug] [MainThread]: Command end result
[0m16:45:26.760024 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0753584, "process_user_time": 1.503038, "process_kernel_time": 0.190424, "process_mem_max_rss": "176160768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:26.760305 [debug] [MainThread]: Command `dbt compile` succeeded at 16:45:26.760261 after 2.08 seconds
[0m16:45:26.760478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c088e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93f80>]}
[0m16:45:26.760642 [debug] [MainThread]: Flushing usage events
[0m16:45:35.378503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef5910>]}


============================== 16:45:35.380368 | 42d871b2-e470-48ec-ad84-45a610d95045 ==============================
[0m16:45:35.380368 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:45:35.380655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:45:35.676279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45e20>]}
[0m16:45:35.697538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9fa0>]}
[0m16:45:35.697888 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:45:35.705833 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:45:35.754557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:35.754755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:35.772346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac604d0>]}
[0m16:45:35.811895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af62720>]}
[0m16:45:35.812121 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m16:45:35.812290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd0b90>]}
[0m16:45:35.813066 [info ] [MainThread]: 
[0m16:45:35.813334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:35.815061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:45:35.821603 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:45:35.821758 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:45:35.821880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:36.325476 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.503 seconds
[0m16:45:36.331294 [debug] [ThreadPool]: On list_weather: Close
[0m16:45:36.476776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m16:45:36.486453 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:45:36.486777 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:45:36.487016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:36.995635 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.508 seconds
[0m16:45:37.001759 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:45:37.126147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b117f50>]}
[0m16:45:37.127369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:37.127866 [info ] [MainThread]: 
[0m16:45:37.131930 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:45:37.132692 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m16:45:37.133267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:45:37.133696 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:45:37.142769 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:45:37.143748 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m16:45:37.163675 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m16:45:37.168123 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m16:45:37.171914 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m16:45:37.172156 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m16:45:37.172362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:37.700210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m16:45:37.715453 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m16:45:37.717074 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m16:45:37.717470 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m16:45:37.859746 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8af2d-0004-3869-0002-62e70002764e
[0m16:45:37.860282 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m16:45:37.860824 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m16:45:37.995487 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:45:37.997085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d871b2-e470-48ec-ad84-45a610d95045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afcc920>]}
[0m16:45:37.997763 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.86s]
[0m16:45:37.998360 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:45:37.999759 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:45:38.000265 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m16:45:38.000662 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:45:38.001584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:38.001862 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m16:45:38.002120 [info ] [MainThread]: 
[0m16:45:38.002370 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m16:45:38.002909 [debug] [MainThread]: Command end result
[0m16:45:38.022880 [info ] [MainThread]: 
[0m16:45:38.023153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:38.023336 [info ] [MainThread]: 
[0m16:45:38.023567 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:45:38.023743 [info ] [MainThread]: 
[0m16:45:38.023918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:45:38.025473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6748116, "process_user_time": 1.196701, "process_kernel_time": 0.156426, "process_mem_max_rss": "175030272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:38.025802 [debug] [MainThread]: Command `dbt run` failed at 16:45:38.025744 after 2.68 seconds
[0m16:45:38.026020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4ef0>]}
[0m16:45:38.026210 [debug] [MainThread]: Flushing usage events
[0m16:52:48.893276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111969cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111969a00>]}


============================== 16:52:48.896145 | a010962f-c602-497d-b484-3118439039a7 ==============================
[0m16:52:48.896145 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:52:48.896467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:49.461545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158df5f0>]}
[0m16:52:49.483363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e18530>]}
[0m16:52:49.483903 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:52:49.494756 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:52:49.558418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:49.558632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:49.576852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d3a40>]}
[0m16:52:49.623965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174021b0>]}
[0m16:52:49.624201 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m16:52:49.624360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1173fc4a0>]}
[0m16:52:49.625176 [info ] [MainThread]: 
[0m16:52:49.625435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:49.627222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:52:49.633622 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:52:49.633797 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:52:49.633920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:50.249786 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.615 seconds
[0m16:52:50.253481 [debug] [ThreadPool]: On list_weather: Close
[0m16:52:50.406608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m16:52:50.418506 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:52:50.418969 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:52:50.419274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:50.920834 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.501 seconds
[0m16:52:50.925224 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:52:51.120412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a17f0>]}
[0m16:52:51.121673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:51.122204 [info ] [MainThread]: 
[0m16:52:51.125863 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:52:51.126694 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m16:52:51.127303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:52:51.127753 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:52:51.138226 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:52:51.139134 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m16:52:51.160698 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m16:52:51.165002 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m16:52:51.168914 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m16:52:51.169148 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m16:52:51.169350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:51.702127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m16:52:51.718406 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m16:52:51.719603 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m16:52:51.719988 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m16:52:51.816514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8af34-0004-386a-0002-62e70002d156
[0m16:52:51.817307 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m16:52:51.818062 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m16:52:51.946970 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:52:51.948855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a010962f-c602-497d-b484-3118439039a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178800e0>]}
[0m16:52:51.949504 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.82s]
[0m16:52:51.950100 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:52:51.951573 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:52:51.952044 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m16:52:51.952455 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:52:51.953422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:51.953693 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m16:52:51.953965 [info ] [MainThread]: 
[0m16:52:51.954252 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m16:52:51.954860 [debug] [MainThread]: Command end result
[0m16:52:51.976862 [info ] [MainThread]: 
[0m16:52:51.977142 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:51.977328 [info ] [MainThread]: 
[0m16:52:51.977555 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:52:51.977731 [info ] [MainThread]: 
[0m16:52:51.977910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:52:51.979636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1222863, "process_user_time": 1.28305, "process_kernel_time": 0.277581, "process_mem_max_rss": "168902656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:51.979984 [debug] [MainThread]: Command `dbt run` failed at 16:52:51.979928 after 3.12 seconds
[0m16:52:51.980204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11138a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178c0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178c12b0>]}
[0m16:52:51.980400 [debug] [MainThread]: Flushing usage events
[0m16:53:14.539581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dca930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087592e0>]}


============================== 16:53:14.542181 | 497643cb-8632-4ea7-a7ab-71d31b157b82 ==============================
[0m16:53:14.542181 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:53:14.542469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:53:14.602934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497643cb-8632-4ea7-a7ab-71d31b157b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a2330>]}
[0m16:53:14.614150 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10864633, "process_user_time": 0.578143, "process_kernel_time": 0.123807, "process_mem_max_rss": "95305728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:14.614397 [debug] [MainThread]: Command `dbt clean` succeeded at 16:53:14.614359 after 0.11 seconds
[0m16:53:14.614620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aba240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108780d10>]}
[0m16:53:14.614761 [debug] [MainThread]: Flushing usage events
[0m16:53:19.957028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2d9d0>]}


============================== 16:53:19.959434 | 6b58a14d-1c17-4407-b73b-c08c76a3ea03 ==============================
[0m16:53:19.959434 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:53:19.959720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:20.486672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea2000>]}
[0m16:53:20.507874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe1310>]}
[0m16:53:20.508428 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:53:20.520476 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:53:20.520957 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:53:20.521126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725ab70>]}
[0m16:53:21.056817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4333b0>]}
[0m16:53:21.102672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b791340>]}
[0m16:53:21.102915 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m16:53:21.103068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44dfa0>]}
[0m16:53:21.103852 [info ] [MainThread]: 
[0m16:53:21.104118 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:21.105887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m16:53:21.111569 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m16:53:21.111715 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m16:53:21.111832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:21.855378 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.743 seconds
[0m16:53:21.859240 [debug] [ThreadPool]: On list_weather: Close
[0m16:53:22.022920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m16:53:22.038101 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m16:53:22.038589 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m16:53:22.038905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:22.515986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m16:53:22.519778 [debug] [ThreadPool]: On list_weather_data: Close
[0m16:53:22.669572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9c2c0>]}
[0m16:53:22.671049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:22.671538 [info ] [MainThread]: 
[0m16:53:22.675925 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m16:53:22.676771 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m16:53:22.677373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m16:53:22.677804 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m16:53:22.688266 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m16:53:22.689455 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m16:53:22.717012 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m16:53:22.717982 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m16:53:22.718222 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m16:53:22.718431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:23.160278 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8af35-0004-386a-0002-62e70002d15a
[0m16:53:23.160843 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m16:53:23.161397 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m16:53:23.310223 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:53:23.312299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b58a14d-1c17-4407-b73b-c08c76a3ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050150a0>]}
[0m16:53:23.313133 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.63s]
[0m16:53:23.313870 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m16:53:23.315940 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m16:53:23.316626 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m16:53:23.317158 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m16:53:23.318214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:23.318532 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m16:53:23.318833 [info ] [MainThread]: 
[0m16:53:23.319136 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m16:53:23.319793 [debug] [MainThread]: Command end result
[0m16:53:23.341814 [info ] [MainThread]: 
[0m16:53:23.342097 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:23.342293 [info ] [MainThread]: 
[0m16:53:23.342527 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m16:53:23.342712 [info ] [MainThread]: 
[0m16:53:23.342896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:53:23.344378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.419031, "process_user_time": 1.704885, "process_kernel_time": 0.253624, "process_mem_max_rss": "174047232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:23.344702 [debug] [MainThread]: Command `dbt run` failed at 16:53:23.344646 after 3.42 seconds
[0m16:53:23.344933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b42ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf5c70>]}
[0m16:53:23.345139 [debug] [MainThread]: Flushing usage events
[0m19:13:23.473185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d418b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d41580>]}


============================== 19:13:23.475987 | 0dc952aa-8e7d-40bf-83eb-f13e60404620 ==============================
[0m19:13:23.475987 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:13:23.476303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:24.032269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6fef60>]}
[0m19:13:24.053372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8cb90>]}
[0m19:13:24.053886 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:13:24.063038 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:13:24.125386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:24.125587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:24.143338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753e810>]}
[0m19:13:24.189652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ada6300>]}
[0m19:13:24.189887 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:13:24.190044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109618740>]}
[0m19:13:24.190871 [info ] [MainThread]: 
[0m19:13:24.191140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:24.192886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:13:24.199509 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:13:24.199664 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:13:24.199797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:24.814553 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.614 seconds
[0m19:13:24.818296 [debug] [ThreadPool]: On list_weather: Close
[0m19:13:24.950684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:13:24.961900 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:13:24.962337 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:13:24.962626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:25.514945 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.552 seconds
[0m19:13:25.521251 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:13:25.668873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae8350>]}
[0m19:13:25.670217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:25.670742 [info ] [MainThread]: 
[0m19:13:25.675312 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:13:25.676141 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m19:13:25.676728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:13:25.677155 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:13:25.687401 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:13:25.688268 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:13:25.709671 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m19:13:25.713978 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m19:13:25.718004 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:13:25.718242 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m19:13:25.718446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:26.240846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m19:13:26.254356 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:13:26.255300 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:13:26.255595 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:13:26.392204 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afc1-0004-3987-0002-62e70002931e
[0m19:13:26.392779 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:13:26.393341 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:13:26.542469 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:13:26.544146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc952aa-8e7d-40bf-83eb-f13e60404620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e9100>]}
[0m19:13:26.544761 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.87s]
[0m19:13:26.545279 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:13:26.546567 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:13:26.546905 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m19:13:26.547226 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:13:26.548017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:26.548244 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m19:13:26.548474 [info ] [MainThread]: 
[0m19:13:26.548722 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m19:13:26.549265 [debug] [MainThread]: Command end result
[0m19:13:26.568336 [info ] [MainThread]: 
[0m19:13:26.568586 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:26.568775 [info ] [MainThread]: 
[0m19:13:26.568990 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:13:26.569156 [info ] [MainThread]: 
[0m19:13:26.569321 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m19:13:26.571515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.137274, "process_user_time": 1.234058, "process_kernel_time": 0.254524, "process_mem_max_rss": "168755200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:13:26.571855 [debug] [MainThread]: Command `dbt run` failed at 19:13:26.571801 after 3.14 seconds
[0m19:13:26.572079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d40e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a16e40>]}
[0m19:13:26.572272 [debug] [MainThread]: Flushing usage events
[0m19:18:24.064925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677d7c0>]}


============================== 19:18:24.067600 | d7eba381-6f0f-4a61-b7fc-7e4bf05921c8 ==============================
[0m19:18:24.067600 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:24.067925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:18:24.599619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7b5c0>]}
[0m19:18:24.620772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6c7d0>]}
[0m19:18:24.621312 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:18:24.631930 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:18:24.694252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:24.694464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:24.712135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49f170>]}
[0m19:18:24.758383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e63c0>]}
[0m19:18:24.758604 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:18:24.758763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a9e20>]}
[0m19:18:24.759560 [info ] [MainThread]: 
[0m19:18:24.759826 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:24.761561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:18:24.768029 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:18:24.768188 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:18:24.768309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:25.316163 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.548 seconds
[0m19:18:25.318788 [debug] [ThreadPool]: On list_weather: Close
[0m19:18:25.437329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:18:25.448510 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:18:25.448881 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:18:25.449166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:25.950406 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.501 seconds
[0m19:18:25.956463 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:18:26.078052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a46a570>]}
[0m19:18:26.079232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:26.079835 [info ] [MainThread]: 
[0m19:18:26.083306 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:18:26.084077 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m19:18:26.084633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:18:26.085051 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:18:26.094152 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:18:26.094904 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:18:26.115423 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m19:18:26.119671 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m19:18:26.123598 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:18:26.123832 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m19:18:26.124032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:26.612143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m19:18:26.627226 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:18:26.628255 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:18:26.628607 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:18:26.746847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afc6-0004-3868-0002-62e7000265ee
[0m19:18:26.747700 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:18:26.748423 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:18:26.882631 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:18:26.884728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eba381-6f0f-4a61-b7fc-7e4bf05921c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ff380>]}
[0m19:18:26.885570 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.80s]
[0m19:18:26.886331 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:18:26.888100 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:18:26.888564 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m19:18:26.889026 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:18:26.890045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:26.890306 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m19:18:26.890574 [info ] [MainThread]: 
[0m19:18:26.890863 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m19:18:26.891494 [debug] [MainThread]: Command end result
[0m19:18:26.913733 [info ] [MainThread]: 
[0m19:18:26.914018 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:18:26.914208 [info ] [MainThread]: 
[0m19:18:26.914433 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:18:26.914608 [info ] [MainThread]: 
[0m19:18:26.914788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m19:18:26.916756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8876565, "process_user_time": 1.22351, "process_kernel_time": 0.254723, "process_mem_max_rss": "173604864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:18:26.917172 [debug] [MainThread]: Command `dbt run` failed at 19:18:26.917106 after 2.89 seconds
[0m19:18:26.917434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3ef0>]}
[0m19:18:26.917643 [debug] [MainThread]: Flushing usage events
[0m19:26:20.782805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106330410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089019a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108901640>]}


============================== 19:26:20.785708 | 245effed-8a44-4c70-9244-e569591b4ed1 ==============================
[0m19:26:20.785708 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:26:20.786032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:21.318729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba23bf0>]}
[0m19:26:21.339846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892a210>]}
[0m19:26:21.340388 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:26:21.351710 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:26:21.414522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:21.414749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:21.432567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ef080>]}
[0m19:26:21.478880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c966360>]}
[0m19:26:21.479105 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:26:21.479260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eecfe0>]}
[0m19:26:21.480031 [info ] [MainThread]: 
[0m19:26:21.480292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:21.482042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:26:21.488593 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:26:21.488747 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:26:21.488869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:22.040754 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.552 seconds
[0m19:26:22.043663 [debug] [ThreadPool]: On list_weather: Close
[0m19:26:22.171741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:26:22.181561 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:26:22.181923 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:26:22.182177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:22.623251 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.441 seconds
[0m19:26:22.627234 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:26:22.741525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ee540>]}
[0m19:26:22.742697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:22.743174 [info ] [MainThread]: 
[0m19:26:22.747331 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:26:22.748149 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m19:26:22.748810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:26:22.749234 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:26:22.758148 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:26:22.758946 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:26:22.778624 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m19:26:22.782907 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m19:26:22.786620 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:26:22.786855 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m19:26:22.787057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:23.290505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m19:26:23.308799 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:26:23.310045 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:26:23.310439 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:26:23.423448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afce-0004-3863-0002-62e700023736
[0m19:26:23.423975 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:26:23.424465 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:26:23.564498 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:26:23.566731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245effed-8a44-4c70-9244-e569591b4ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a5d30>]}
[0m19:26:23.567621 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.82s]
[0m19:26:23.568290 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:26:23.569721 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:26:23.570205 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m19:26:23.570585 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:26:23.571608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:23.571964 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m19:26:23.572278 [info ] [MainThread]: 
[0m19:26:23.572590 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m19:26:23.573248 [debug] [MainThread]: Command end result
[0m19:26:23.594311 [info ] [MainThread]: 
[0m19:26:23.594617 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:26:23.594808 [info ] [MainThread]: 
[0m19:26:23.595040 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:26:23.595215 [info ] [MainThread]: 
[0m19:26:23.595399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m19:26:23.597242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8476682, "process_user_time": 1.221473, "process_kernel_time": 0.256171, "process_mem_max_rss": "168411136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:26:23.597574 [debug] [MainThread]: Command `dbt run` failed at 19:26:23.597524 after 2.85 seconds
[0m19:26:23.597790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f72240>]}
[0m19:26:23.597980 [debug] [MainThread]: Flushing usage events
[0m19:26:48.127408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f53620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dd670>]}


============================== 19:26:48.129964 | 83168e75-0b34-4d19-a323-ff3949127d3d ==============================
[0m19:26:48.129964 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:26:48.130257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:48.627113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cd9d0>]}
[0m19:26:48.648269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fc9e0>]}
[0m19:26:48.648821 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:26:48.658602 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:26:48.720711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:48.720932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:48.739234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106700ec0>]}
[0m19:26:48.783759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa42600>]}
[0m19:26:48.783987 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:26:48.784147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a056330>]}
[0m19:26:48.784919 [info ] [MainThread]: 
[0m19:26:48.785197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:48.786970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:26:48.793271 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:26:48.793428 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:26:48.793559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:49.319732 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.526 seconds
[0m19:26:49.322872 [debug] [ThreadPool]: On list_weather: Close
[0m19:26:49.470876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:26:49.484676 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:26:49.485065 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:26:49.485350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:49.963206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.478 seconds
[0m19:26:49.968077 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:26:50.132185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105235550>]}
[0m19:26:50.133337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:50.133864 [info ] [MainThread]: 
[0m19:26:50.138099 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:26:50.138989 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m19:26:50.139798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:26:50.140348 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:26:50.149814 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:26:50.150585 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:26:50.174290 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:26:50.174977 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:26:50.175223 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:26:50.175439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:50.632157 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afce-0004-3864-0002-62e7000226d6
[0m19:26:50.632782 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:26:50.633347 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:26:50.765362 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:26:50.767806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83168e75-0b34-4d19-a323-ff3949127d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f85040>]}
[0m19:26:50.768673 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.63s]
[0m19:26:50.769730 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:26:50.783909 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:26:50.788233 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m19:26:50.788761 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:26:50.789552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:50.789757 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m19:26:50.789949 [info ] [MainThread]: 
[0m19:26:50.790155 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m19:26:50.791172 [debug] [MainThread]: Command end result
[0m19:26:50.811380 [info ] [MainThread]: 
[0m19:26:50.811752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:26:50.811983 [info ] [MainThread]: 
[0m19:26:50.812218 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:26:50.812394 [info ] [MainThread]: 
[0m19:26:50.812568 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m19:26:50.814877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.717414, "process_user_time": 1.195686, "process_kernel_time": 0.243517, "process_mem_max_rss": "173277184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:26:50.815213 [debug] [MainThread]: Command `dbt run` failed at 19:26:50.815162 after 2.72 seconds
[0m19:26:50.815440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ddfd0>]}
[0m19:26:50.815644 [debug] [MainThread]: Flushing usage events
[0m19:31:30.444419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b5280>]}


============================== 19:31:30.447272 | a8a3e72e-2d15-46ff-882d-4ca811853897 ==============================
[0m19:31:30.447272 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:31:30.447600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:30.530140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8a3e72e-2d15-46ff-882d-4ca811853897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a95820>]}
[0m19:31:30.541851 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13311712, "process_user_time": 0.573396, "process_kernel_time": 0.124133, "process_mem_max_rss": "95387648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:31:30.542100 [debug] [MainThread]: Command `dbt clean` succeeded at 19:31:30.542061 after 0.13 seconds
[0m19:31:30.542252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104403d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108070cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814c920>]}
[0m19:31:30.542389 [debug] [MainThread]: Flushing usage events
[0m19:31:35.961132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cf3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108539370>]}


============================== 19:31:35.962991 | d768a45f-3f31-4440-80ef-faf83022591b ==============================
[0m19:31:35.962991 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:31:35.963281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:31:35.969167 [info ] [MainThread]: dbt version: 1.8.7
[0m19:31:35.969352 [info ] [MainThread]: python version: 3.12.2
[0m19:31:35.969486 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m19:31:35.969602 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m19:31:36.431383 [info ] [MainThread]: Using profiles dir at /Users/gayatripatil/.dbt
[0m19:31:36.431647 [info ] [MainThread]: Using profiles.yml file at /Users/gayatripatil/.dbt/profiles.yml
[0m19:31:36.431806 [info ] [MainThread]: Using dbt_project.yml file at /Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/dbt_project.yml
[0m19:31:36.432236 [info ] [MainThread]: adapter type: snowflake
[0m19:31:36.432419 [info ] [MainThread]: adapter version: 1.8.4
[0m19:31:36.465137 [info ] [MainThread]: Configuration:
[0m19:31:36.465358 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:31:36.465494 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:31:36.465609 [info ] [MainThread]: Required dependencies:
[0m19:31:36.465756 [debug] [MainThread]: Executing "git --help"
[0m19:31:36.482064 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:31:36.482507 [debug] [MainThread]: STDERR: "b''"
[0m19:31:36.482652 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:31:36.482792 [info ] [MainThread]: Connection:
[0m19:31:36.482935 [info ] [MainThread]:   account: ewb58515
[0m19:31:36.483046 [info ] [MainThread]:   user: gayatripatil22
[0m19:31:36.483148 [info ] [MainThread]:   database: weather
[0m19:31:36.483253 [info ] [MainThread]:   warehouse: compute_wh
[0m19:31:36.483355 [info ] [MainThread]:   role: Accountadmin
[0m19:31:36.483467 [info ] [MainThread]:   schema: data
[0m19:31:36.483568 [info ] [MainThread]:   authenticator: None
[0m19:31:36.483667 [info ] [MainThread]:   oauth_client_id: None
[0m19:31:36.483766 [info ] [MainThread]:   query_tag: None
[0m19:31:36.483863 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:31:36.483961 [info ] [MainThread]:   host: None
[0m19:31:36.484058 [info ] [MainThread]:   port: None
[0m19:31:36.484152 [info ] [MainThread]:   proxy_host: None
[0m19:31:36.484249 [info ] [MainThread]:   proxy_port: None
[0m19:31:36.484344 [info ] [MainThread]:   protocol: None
[0m19:31:36.484437 [info ] [MainThread]:   connect_retries: 1
[0m19:31:36.484535 [info ] [MainThread]:   connect_timeout: None
[0m19:31:36.484629 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:31:36.484727 [info ] [MainThread]:   retry_all: False
[0m19:31:36.484823 [info ] [MainThread]:   insecure_mode: False
[0m19:31:36.484915 [info ] [MainThread]:   reuse_connections: None
[0m19:31:36.485244 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:31:36.489019 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:31:36.489758 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:31:36.489905 [debug] [MainThread]: On debug: select 1 as id
[0m19:31:36.490017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:37.064301 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.574 seconds
[0m19:31:37.067433 [debug] [MainThread]: On debug: Close
[0m19:31:37.228511 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:31:37.229813 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:31:37.232589 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2992933, "process_user_time": 0.860999, "process_kernel_time": 0.180269, "process_mem_max_rss": "167591936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:31:37.233134 [debug] [MainThread]: Command `dbt debug` succeeded at 19:31:37.233044 after 1.30 seconds
[0m19:31:37.233425 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:31:37.233726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee2cf0>]}
[0m19:31:37.234049 [debug] [MainThread]: Flushing usage events
[0m19:36:41.106495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106298350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bdb50>]}


============================== 19:36:41.109291 | 6467735d-b9f5-458b-ac5c-c91ab1b30391 ==============================
[0m19:36:41.109291 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:36:41.109621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:41.637483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bf980>]}
[0m19:36:41.658721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b3530>]}
[0m19:36:41.659258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:36:41.671180 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:36:41.671671 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:36:41.671857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a099490>]}
[0m19:36:42.214243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3dcbc0>]}
[0m19:36:42.261144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3df680>]}
[0m19:36:42.261419 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:36:42.261585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6467735d-b9f5-458b-ac5c-c91ab1b30391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bdfa0>]}
[0m19:36:42.262412 [info ] [MainThread]: 
[0m19:36:42.262591 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:36:42.273988 [info ] [MainThread]: Done.
[0m19:36:42.275754 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 1.2027913, "process_user_time": 1.372668, "process_kernel_time": 0.213251, "process_mem_max_rss": "168132608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:42.276057 [debug] [MainThread]: Command `dbt source freshness` succeeded at 19:36:42.276018 after 1.20 seconds
[0m19:36:42.276242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e91610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0988f0>]}
[0m19:36:42.276385 [debug] [MainThread]: Flushing usage events
[0m19:36:47.958761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c45370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f1820>]}


============================== 19:36:47.960739 | 9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd ==============================
[0m19:36:47.960739 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:36:47.961028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:36:48.271777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c054e60>]}
[0m19:36:48.292792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2cef0>]}
[0m19:36:48.293165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:36:48.301221 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:36:48.352333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:48.352525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:48.370120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c123290>]}
[0m19:36:48.410331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3200b0>]}
[0m19:36:48.410542 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:36:48.410709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0fbb00>]}
[0m19:36:48.411446 [info ] [MainThread]: 
[0m19:36:48.411710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:48.413437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:36:48.419926 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:36:48.420083 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:36:48.420205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:49.075395 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.655 seconds
[0m19:36:49.081212 [debug] [ThreadPool]: On list_weather: Close
[0m19:36:49.233281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:36:49.242787 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:36:49.243121 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:36:49.243357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:49.740519 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.497 seconds
[0m19:36:49.744612 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:36:49.874193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c473bf0>]}
[0m19:36:49.875377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:49.875919 [info ] [MainThread]: 
[0m19:36:49.879657 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:36:49.880538 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:36:49.881118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:36:49.881585 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:36:49.891872 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:36:49.893112 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:36:49.918372 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:36:49.919357 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:36:49.919623 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:36:49.919852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:51.327499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m19:36:51.357594 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:36:51.498182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107899160>]}
[0m19:36:51.499469 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.62s]
[0m19:36:51.500572 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:36:51.501763 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:36:51.502310 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:36:51.502828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:36:51.503233 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:36:51.506777 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:36:51.508563 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:36:51.511366 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:36:51.512653 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:36:51.512977 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATE,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATE, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATE DESC
        );
[0m19:36:51.513279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:52.024027 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afd8-0004-386b-0002-62e700021ff6
[0m19:36:52.024850 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'DATE'
[0m19:36:52.025585 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:36:52.158448 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:36:52.158977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f78cd08-5c1d-4091-b9e3-c2a7a84f57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5cb6b0>]}
[0m19:36:52.159615 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.66s]
[0m19:36:52.160183 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:36:52.161944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:52.162182 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:36:52.162460 [info ] [MainThread]: 
[0m19:36:52.162710 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m19:36:52.163347 [debug] [MainThread]: Command end result
[0m19:36:52.184221 [info ] [MainThread]: 
[0m19:36:52.184479 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:52.184667 [info ] [MainThread]: 
[0m19:36:52.184896 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:36:52.185082 [info ] [MainThread]: 
[0m19:36:52.185276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:36:52.186692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2557893, "process_user_time": 1.283229, "process_kernel_time": 0.200219, "process_mem_max_rss": "172572672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:52.187010 [debug] [MainThread]: Command `dbt run` failed at 19:36:52.186958 after 4.26 seconds
[0m19:36:52.187222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd29100>]}
[0m19:36:52.187409 [debug] [MainThread]: Flushing usage events
[0m19:39:51.411472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108925a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089257c0>]}


============================== 19:39:51.414257 | 06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab ==============================
[0m19:39:51.414257 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:39:51.414597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:39:51.938063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ee570>]}
[0m19:39:51.959712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1cbe00>]}
[0m19:39:51.960287 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:39:51.970465 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:39:52.032643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:52.032959 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/temperature_range.sql
[0m19:39:52.182723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb23830>]}
[0m19:39:52.227208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cba0dd0>]}
[0m19:39:52.227436 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:39:52.227597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf2570>]}
[0m19:39:52.228378 [info ] [MainThread]: 
[0m19:39:52.228641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:52.230375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:39:52.236292 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:39:52.236442 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:39:52.236568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:52.801342 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.564 seconds
[0m19:39:52.806372 [debug] [ThreadPool]: On list_weather: Close
[0m19:39:52.957554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:39:52.969680 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:39:52.970093 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:39:52.970392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:53.484419 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.514 seconds
[0m19:39:53.489782 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:39:53.612420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca86960>]}
[0m19:39:53.613068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:53.613396 [info ] [MainThread]: 
[0m19:39:53.616287 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:39:53.616786 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:39:53.617152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:39:53.617433 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:39:53.624401 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:39:53.625333 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:39:53.645210 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:39:53.646083 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:39:53.646317 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:39:53.646509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:54.826549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.180 seconds
[0m19:39:54.854973 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:39:54.983028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d2690>]}
[0m19:39:54.983903 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.36s]
[0m19:39:54.984653 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:39:54.985650 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:39:54.986174 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:39:54.986624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:39:54.986936 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:39:54.989620 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:39:54.990322 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:39:54.994446 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:39:54.995450 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:39:54.995787 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATE DESC
        );
[0m19:39:54.996101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:55.502414 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afdb-0004-386c-0002-62e70002475e
[0m19:39:55.503155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 9
invalid identifier 'DATE'
[0m19:39:55.503823 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:39:55.619076 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  000904 (42000): SQL compilation error: error line 19 at position 9
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:39:55.619575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d5ebe1-99a7-4f63-9e45-cb543ce5b8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9e360>]}
[0m19:39:55.620184 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.63s]
[0m19:39:55.620746 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:39:55.622323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:55.622577 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:39:55.622859 [info ] [MainThread]: 
[0m19:39:55.623116 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m19:39:55.623743 [debug] [MainThread]: Command end result
[0m19:39:55.643617 [info ] [MainThread]: 
[0m19:39:55.643870 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:39:55.644055 [info ] [MainThread]: 
[0m19:39:55.644294 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  000904 (42000): SQL compilation error: error line 19 at position 9
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:39:55.644475 [info ] [MainThread]: 
[0m19:39:55.644651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:39:55.646439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2695656, "process_user_time": 1.409832, "process_kernel_time": 0.254576, "process_mem_max_rss": "182435840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:39:55.646794 [debug] [MainThread]: Command `dbt run` failed at 19:39:55.646739 after 4.27 seconds
[0m19:39:55.647015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089256a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108925a00>]}
[0m19:39:55.647209 [debug] [MainThread]: Flushing usage events
[0m19:40:15.493581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108645730>]}


============================== 19:40:15.496279 | 95303c5d-9d84-4250-8ce4-8b6b6c7fb675 ==============================
[0m19:40:15.496279 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:40:15.496574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:40:15.975855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7b230>]}
[0m19:40:15.996766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6ca40>]}
[0m19:40:15.997996 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:40:16.008543 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:40:16.069667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:16.069979 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/temperature_range.sql
[0m19:40:16.219779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c765760>]}
[0m19:40:16.263105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8c0c20>]}
[0m19:40:16.263322 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:40:16.263480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f2180>]}
[0m19:40:16.264256 [info ] [MainThread]: 
[0m19:40:16.264509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:16.266255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:40:16.272135 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:40:16.272287 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:40:16.272414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:16.788940 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.516 seconds
[0m19:40:16.794708 [debug] [ThreadPool]: On list_weather: Close
[0m19:40:16.927649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:40:16.941072 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:40:16.941516 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:40:16.941816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:17.473596 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.532 seconds
[0m19:40:17.478362 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:40:17.612873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f7da0>]}
[0m19:40:17.614704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:17.615599 [info ] [MainThread]: 
[0m19:40:17.619096 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:40:17.619802 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:40:17.620377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:40:17.620788 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:40:17.628981 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:40:17.629615 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:40:17.651495 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:40:17.652214 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:40:17.652453 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:40:17.652659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:18.790486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m19:40:18.821481 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:40:18.958258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fa540>]}
[0m19:40:18.959099 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.34s]
[0m19:40:18.959727 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:40:18.960623 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:40:18.961077 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:40:18.961503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:40:18.961824 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:40:18.964488 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:40:18.966146 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:40:18.969923 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:40:18.970965 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:40:18.971259 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:40:18.971529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:20.121940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m19:40:20.126284 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:40:20.250074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95303c5d-9d84-4250-8ce4-8b6b6c7fb675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb6570>]}
[0m19:40:20.251026 [info ] [Thread-1 (]: 2 of 2 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.29s]
[0m19:40:20.251638 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:40:20.252759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:20.253037 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:40:20.253377 [info ] [MainThread]: 
[0m19:40:20.253671 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m19:40:20.254422 [debug] [MainThread]: Command end result
[0m19:40:20.274979 [info ] [MainThread]: 
[0m19:40:20.275254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:20.275444 [info ] [MainThread]: 
[0m19:40:20.275633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:40:20.277538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.814241, "process_user_time": 1.422961, "process_kernel_time": 0.246619, "process_mem_max_rss": "178929664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:40:20.277894 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:20.277838 after 4.81 seconds
[0m19:40:20.278118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108645880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb36fc0>]}
[0m19:40:20.278316 [debug] [MainThread]: Flushing usage events
[0m19:41:27.096464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d32690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f17f0>]}


============================== 19:41:27.099405 | d5415cfe-f667-4c1e-b0f6-81ba7352ada9 ==============================
[0m19:41:27.099405 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:27.099723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:41:27.625225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f3980>]}
[0m19:41:27.646297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c49e0>]}
[0m19:41:27.646838 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:41:27.658427 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:41:27.721500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:27.721802 [debug] [MainThread]: Partial parsing: updated file: proj://models/input/daily_weather.sql
[0m19:41:27.817740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94bce0>]}
[0m19:41:27.862235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a8170>]}
[0m19:41:27.862454 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:41:27.862614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a508380>]}
[0m19:41:27.863381 [info ] [MainThread]: 
[0m19:41:27.863634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:41:27.865488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:41:27.871143 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:41:27.871295 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:41:27.871413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:28.410585 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.539 seconds
[0m19:41:28.416034 [debug] [ThreadPool]: On list_weather: Close
[0m19:41:28.536750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:41:28.549806 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:41:28.550238 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:41:28.550526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:29.024337 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.474 seconds
[0m19:41:29.028384 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:41:29.174083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050494c0>]}
[0m19:41:29.175273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:29.175976 [info ] [MainThread]: 
[0m19:41:29.179535 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:41:29.180190 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:41:29.180714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:41:29.181118 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:41:29.189721 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:41:29.190870 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:41:29.212773 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:41:29.213380 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:41:29.213600 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (-- 
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:41:29.213793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:30.572465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m19:41:30.604354 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:41:30.719331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abdbc80>]}
[0m19:41:30.720106 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.54s]
[0m19:41:30.720702 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:41:30.721555 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:41:30.722085 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:41:30.722474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:41:30.722787 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:41:30.725433 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:41:30.727008 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:41:30.729441 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:41:30.730404 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:41:30.730715 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:41:30.731003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:32.008579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.277 seconds
[0m19:41:32.014598 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:41:32.134709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5415cfe-f667-4c1e-b0f6-81ba7352ada9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad098e0>]}
[0m19:41:32.136030 [info ] [Thread-1 (]: 2 of 2 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m19:41:32.136954 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:41:32.138313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:32.138707 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:41:32.139121 [info ] [MainThread]: 
[0m19:41:32.139490 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m19:41:32.140384 [debug] [MainThread]: Command end result
[0m19:41:32.166492 [info ] [MainThread]: 
[0m19:41:32.166771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:32.166955 [info ] [MainThread]: 
[0m19:41:32.167164 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:41:32.169591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1062126, "process_user_time": 1.368727, "process_kernel_time": 0.255028, "process_mem_max_rss": "178470912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:32.169983 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:32.169923 after 5.11 seconds
[0m19:41:32.170239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623b5f0>]}
[0m19:41:32.170454 [debug] [MainThread]: Flushing usage events
[0m19:41:37.012499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3d310>]}


============================== 19:41:37.014370 | ed570dc7-3dfe-4b23-ae7c-4e760b33d629 ==============================
[0m19:41:37.014370 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:37.014655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:41:37.074408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed570dc7-3dfe-4b23-ae7c-4e760b33d629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b11d60>]}
[0m19:41:37.081888 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09721621, "process_user_time": 0.572626, "process_kernel_time": 0.089973, "process_mem_max_rss": "94535680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:37.082116 [debug] [MainThread]: Command `dbt clean` succeeded at 19:41:37.082077 after 0.10 seconds
[0m19:41:37.082342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b130b0>]}
[0m19:41:37.082482 [debug] [MainThread]: Flushing usage events
[0m19:41:40.345866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106945b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069457f0>]}


============================== 19:41:40.347722 | a7655a46-46ef-4cdc-9125-c698bfee90a9 ==============================
[0m19:41:40.347722 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:40.348012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:41:40.658098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513da60>]}
[0m19:41:40.679099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107063e30>]}
[0m19:41:40.679466 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:41:40.688135 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:41:40.688596 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:41:40.688780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a52d790>]}
[0m19:41:41.214709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cda60>]}
[0m19:41:41.256267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac45310>]}
[0m19:41:41.256540 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:41:41.256711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4b740>]}
[0m19:41:41.257490 [info ] [MainThread]: 
[0m19:41:41.257746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:41:41.259470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:41:41.265204 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:41:41.265354 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:41:41.265478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:41.741414 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.476 seconds
[0m19:41:41.745018 [debug] [ThreadPool]: On list_weather: Close
[0m19:41:41.871907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:41:41.887099 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:41:41.887615 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:41:41.887924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:42.386920 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.499 seconds
[0m19:41:42.393422 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:41:42.511241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90cb00>]}
[0m19:41:42.512457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:42.512997 [info ] [MainThread]: 
[0m19:41:42.516869 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:41:42.517633 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:41:42.518347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:41:42.518866 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:41:42.529759 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:41:42.531085 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:41:42.554223 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:41:42.555138 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:41:42.555367 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (-- 
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:41:42.555571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:43.680646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.124 seconds
[0m19:41:43.711179 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:41:43.840252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fa360>]}
[0m19:41:43.841003 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.32s]
[0m19:41:43.841563 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:41:43.842361 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:41:43.842862 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:41:43.843336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:41:43.843650 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:41:43.845946 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:41:43.846688 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:41:43.848807 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:41:43.849843 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:41:43.850133 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:41:43.850395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:44.907536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.057 seconds
[0m19:41:44.914519 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:41:45.033939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7655a46-46ef-4cdc-9125-c698bfee90a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7ef9b0>]}
[0m19:41:45.035184 [info ] [Thread-1 (]: 2 of 2 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.19s]
[0m19:41:45.036000 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:41:45.037362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:45.037742 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:41:45.038167 [info ] [MainThread]: 
[0m19:41:45.038540 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m19:41:45.039446 [debug] [MainThread]: Command end result
[0m19:41:45.064775 [info ] [MainThread]: 
[0m19:41:45.065084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:45.065290 [info ] [MainThread]: 
[0m19:41:45.065490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:41:45.067400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7492504, "process_user_time": 1.768439, "process_kernel_time": 0.19182, "process_mem_max_rss": "179290112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:45.067790 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:45.067727 after 4.75 seconds
[0m19:41:45.068057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063948c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106397200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac459a0>]}
[0m19:41:45.068285 [debug] [MainThread]: Flushing usage events
[0m19:41:54.129545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102837650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104385a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104385790>]}


============================== 19:41:54.131972 | 22c36462-d567-43b6-a393-af9f31ff32dc ==============================
[0m19:41:54.131972 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:54.132261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:54.541307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6cb00>]}
[0m19:41:54.562330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae0f0>]}
[0m19:41:54.563604 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:41:54.573265 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:41:54.633492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:54.633716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:54.651412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2e750>]}
[0m19:41:54.695733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ea600>]}
[0m19:41:54.695959 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:41:54.696116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e48c0>]}
[0m19:41:54.696909 [info ] [MainThread]: 
[0m19:41:54.697168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:41:54.698915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:41:54.705339 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:41:54.705503 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:41:54.705623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:55.177756 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.472 seconds
[0m19:41:55.181398 [debug] [ThreadPool]: On list_weather: Close
[0m19:41:55.300906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:41:55.311169 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:41:55.311512 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:41:55.311755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:55.784365 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.472 seconds
[0m19:41:55.788683 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:41:55.926531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b77d0>]}
[0m19:41:55.927501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:55.928139 [info ] [MainThread]: 
[0m19:41:55.931725 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:41:55.932643 [info ] [Thread-1 (]: 1 of 2 START sql table model data.daily_weather ................................ [RUN]
[0m19:41:55.933365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:41:55.933891 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:41:55.945004 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:41:55.946162 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:41:55.972241 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:41:55.973089 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:41:55.973340 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace transient table weather.data.daily_weather
         as
        (-- 
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
        );
[0m19:41:55.973543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:57.094593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.121 seconds
[0m19:41:57.125438 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:41:57.258608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392cec0>]}
[0m19:41:57.259539 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.daily_weather ........................... [[32mSUCCESS 1[0m in 1.32s]
[0m19:41:57.260278 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:41:57.261368 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:41:57.262028 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:41:57.262590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:41:57.263002 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:41:57.266392 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:41:57.267137 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:41:57.269935 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:41:57.271189 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:41:57.271578 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:41:57.271919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:58.527167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.255 seconds
[0m19:41:58.531022 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:41:58.651467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c36462-d567-43b6-a393-af9f31ff32dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108620830>]}
[0m19:41:58.652694 [info ] [Thread-1 (]: 2 of 2 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.39s]
[0m19:41:58.653280 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:41:58.655094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:58.655657 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:41:58.656211 [info ] [MainThread]: 
[0m19:41:58.656676 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m19:41:58.657731 [debug] [MainThread]: Command end result
[0m19:41:58.685441 [info ] [MainThread]: 
[0m19:41:58.685854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:58.686079 [info ] [MainThread]: 
[0m19:41:58.686295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:41:58.689281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5904326, "process_user_time": 1.292083, "process_kernel_time": 0.216265, "process_mem_max_rss": "172883968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:58.689708 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:58.689642 after 4.59 seconds
[0m19:41:58.690070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fe270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105424770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408eba0>]}
[0m19:41:58.690379 [debug] [MainThread]: Flushing usage events
[0m19:45:57.318007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a5280>]}


============================== 19:45:57.320879 | e6a06111-fc11-41ae-aa0c-71a7b965feb1 ==============================
[0m19:45:57.320879 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:45:57.321220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:45:57.404216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6a06111-fc11-41ae-aa0c-71a7b965feb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095c70>]}
[0m19:45:57.415597 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13115841, "process_user_time": 0.572341, "process_kernel_time": 0.127048, "process_mem_max_rss": "94470144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:45:57.415845 [debug] [MainThread]: Command `dbt clean` succeeded at 19:45:57.415806 after 0.13 seconds
[0m19:45:57.416068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107865400>]}
[0m19:45:57.416223 [debug] [MainThread]: Flushing usage events
[0m19:46:13.476450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ef0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799820>]}


============================== 19:46:13.479072 | cc16cb58-df7f-4c0e-a836-1d901b895531 ==============================
[0m19:46:13.479072 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:46:13.479353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:13.999268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e11e20>]}
[0m19:46:14.020098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c6270>]}
[0m19:46:14.021349 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:46:14.038842 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:46:14.039327 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:46:14.039500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b7e60>]}
[0m19:46:14.578059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ce3c0>]}
[0m19:46:14.623884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109391400>]}
[0m19:46:14.624116 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:46:14.624270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910e4e0>]}
[0m19:46:14.625046 [info ] [MainThread]: 
[0m19:46:14.625300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:46:14.627080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:46:14.632763 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:46:14.632913 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:46:14.633030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:15.303877 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.670 seconds
[0m19:46:15.308097 [debug] [ThreadPool]: On list_weather: Close
[0m19:46:15.429093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:46:15.439787 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:46:15.440188 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:46:15.440477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:15.881761 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.441 seconds
[0m19:46:15.885774 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:46:16.019153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d8e90>]}
[0m19:46:16.020023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:16.020444 [info ] [MainThread]: 
[0m19:46:16.023340 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:46:16.023967 [info ] [Thread-1 (]: 1 of 2 START sql view model data.daily_weather ................................. [RUN]
[0m19:46:16.024479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:46:16.024885 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:46:16.034357 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:46:16.035475 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:46:16.053228 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m19:46:16.057350 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m19:46:16.061152 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:46:16.061382 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m19:46:16.061581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:16.620101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m19:46:16.635123 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:46:16.636264 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:46:16.636560 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:46:16.766848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afe2-0004-3863-0002-62e70002379e
[0m19:46:16.767356 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:46:16.767829 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:46:16.910488 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:46:16.913080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc16cb58-df7f-4c0e-a836-1d901b895531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093525a0>]}
[0m19:46:16.914119 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.89s]
[0m19:46:16.914995 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:46:16.916806 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:46:16.917382 [info ] [Thread-1 (]: 2 of 2 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m19:46:16.917901 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:46:16.919121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:16.919461 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m19:46:16.919781 [info ] [MainThread]: 
[0m19:46:16.920078 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m19:46:16.920716 [debug] [MainThread]: Command end result
[0m19:46:16.944514 [info ] [MainThread]: 
[0m19:46:16.944800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:16.944996 [info ] [MainThread]: 
[0m19:46:16.945232 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m19:46:16.945420 [info ] [MainThread]: 
[0m19:46:16.945598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m19:46:16.947420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.500958, "process_user_time": 1.707032, "process_kernel_time": 0.256315, "process_mem_max_rss": "177799168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:16.947756 [debug] [MainThread]: Command `dbt run` failed at 19:46:16.947699 after 3.50 seconds
[0m19:46:16.947985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109130a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109052660>]}
[0m19:46:16.948198 [debug] [MainThread]: Flushing usage events
[0m19:47:55.627856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7d7f0>]}


============================== 19:47:55.630682 | d20c85c3-5a8c-469a-8cfa-848fefb83b34 ==============================
[0m19:47:55.630682 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:47:55.630978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:56.173032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105643fe0>]}
[0m19:47:56.194233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bd670>]}
[0m19:47:56.194774 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:47:56.204766 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:47:56.246641 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:47:56.246905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104320080>]}
[0m19:47:56.771533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bef320>]}
[0m19:47:56.815549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a5bb0>]}
[0m19:47:56.815792 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:47:56.815954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fea900>]}
[0m19:47:56.816749 [info ] [MainThread]: 
[0m19:47:56.816998 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:47:56.817378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:47:56.823198 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:47:56.823348 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:47:56.823468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:57.470444 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.645 seconds
[0m19:47:57.474577 [debug] [ThreadPool]: On list_weather: Close
[0m19:47:57.617230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:47:57.626950 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:47:57.627337 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:47:57.627590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:58.105653 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.478 seconds
[0m19:47:58.110466 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:47:58.257773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b2210>]}
[0m19:47:58.259027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:58.259526 [info ] [MainThread]: 
[0m19:47:58.264048 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:47:58.264762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:47:58.265197 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:47:58.274210 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:47:58.275322 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:47:58.276120 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:47:58.276571 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m19:47:58.276930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:47:58.277207 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:47:58.282365 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:47:58.283083 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:47:58.303980 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:47:58.304896 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:47:58.305140 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:47:58.305358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:58.807363 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afe3-0004-3867-0002-62e700020746
[0m19:47:58.807935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m19:47:58.808487 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:47:58.940636 [debug] [Thread-1 (]: Database Error in model temperature_range (models/output/temperature_range.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:47:58.942404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd20c85c3-5a8c-469a-8cfa-848fefb83b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0a870>]}
[0m19:47:58.943088 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data.temperature_range ................... [[31mERROR[0m in 0.66s]
[0m19:47:58.943696 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:47:58.945779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:58.946163 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:47:58.946731 [info ] [MainThread]: 
[0m19:47:58.947127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m19:47:58.947845 [debug] [MainThread]: Command end result
[0m19:47:58.973488 [info ] [MainThread]: 
[0m19:47:58.973886 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:47:58.974109 [info ] [MainThread]: 
[0m19:47:58.974386 [error] [MainThread]:   Database Error in model temperature_range (models/output/temperature_range.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/output/temperature_range.sql
[0m19:47:58.974586 [info ] [MainThread]: 
[0m19:47:58.974787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:47:58.976866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3826087, "process_user_time": 1.708025, "process_kernel_time": 0.260204, "process_mem_max_rss": "178356224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:58.977315 [debug] [MainThread]: Command `dbt run` failed at 19:47:58.977239 after 3.38 seconds
[0m19:47:58.977608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa0e90>]}
[0m19:47:58.977864 [debug] [MainThread]: Flushing usage events
[0m19:49:30.405256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105661e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bd3a0>]}


============================== 19:49:30.407923 | ce7f6323-3fc7-40a6-a7ae-7d09afd59ac0 ==============================
[0m19:49:30.407923 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:30.408246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:49:30.488754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce7f6323-3fc7-40a6-a7ae-7d09afd59ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8fa70>]}
[0m19:49:30.500310 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12738496, "process_user_time": 0.573575, "process_kernel_time": 0.11515, "process_mem_max_rss": "94748672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:30.500553 [debug] [MainThread]: Command `dbt clean` succeeded at 19:49:30.500514 after 0.13 seconds
[0m19:49:30.500785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106157b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613fc50>]}
[0m19:49:30.500941 [debug] [MainThread]: Flushing usage events
[0m19:49:34.534595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a78b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d1a30>]}


============================== 19:49:34.536477 | 74248d32-3628-4a95-adf7-f4bbe1642404 ==============================
[0m19:49:34.536477 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:34.536769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:49:35.016397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce82f0>]}
[0m19:49:35.037291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811d100>]}
[0m19:49:35.038496 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:49:35.048487 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:49:35.048969 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:49:35.049143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e3a70>]}
[0m19:49:35.583265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075559d0>]}
[0m19:49:35.624742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d1490>]}
[0m19:49:35.624985 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 459 macros
[0m19:49:35.625147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787f80>]}
[0m19:49:35.625915 [info ] [MainThread]: 
[0m19:49:35.626184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:49:35.626557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:49:35.632142 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:49:35.632292 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:49:35.632413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:36.180229 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.547 seconds
[0m19:49:36.185209 [debug] [ThreadPool]: On list_weather: Close
[0m19:49:36.322224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:49:36.333938 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:49:36.334390 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:49:36.334697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:36.836113 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.501 seconds
[0m19:49:36.841907 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:49:36.999405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a97f0>]}
[0m19:49:36.999986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:49:37.000276 [info ] [MainThread]: 
[0m19:49:37.003168 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:49:37.003538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:49:37.003834 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:49:37.011069 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:49:37.012294 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:49:37.012802 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:49:37.013165 [info ] [Thread-1 (]: 1 of 1 START sql table model data.temperature_range ............................ [RUN]
[0m19:49:37.013472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.temperature_range)
[0m19:49:37.013697 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:49:37.017693 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:49:37.018274 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:49:37.036048 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:49:37.037086 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:49:37.037308 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:49:37.037505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:38.409649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m19:49:38.438784 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:49:38.565163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74248d32-3628-4a95-adf7-f4bbe1642404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108186300>]}
[0m19:49:38.566401 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.55s]
[0m19:49:38.567643 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:49:38.569371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:38.569772 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:49:38.570140 [info ] [MainThread]: 
[0m19:49:38.570507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m19:49:38.571272 [debug] [MainThread]: Command end result
[0m19:49:38.596847 [info ] [MainThread]: 
[0m19:49:38.597182 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:38.597377 [info ] [MainThread]: 
[0m19:49:38.597584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:49:38.599276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.092357, "process_user_time": 1.686356, "process_kernel_time": 0.208266, "process_mem_max_rss": "179601408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:38.599629 [debug] [MainThread]: Command `dbt run` succeeded at 19:49:38.599567 after 4.09 seconds
[0m19:49:38.599868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bce90>]}
[0m19:49:38.600094 [debug] [MainThread]: Flushing usage events
[0m19:54:10.235252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108205a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108205760>]}


============================== 19:54:10.237238 | 5f392c97-6d0a-4fcd-acf1-fa3e311d0207 ==============================
[0m19:54:10.237238 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:54:10.237521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:54:10.545908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a24650>]}
[0m19:54:10.567398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc3f140>]}
[0m19:54:10.567767 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:54:10.575721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:54:10.626404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:54:10.626672 [debug] [MainThread]: Partial parsing: added file: proj://models/output/solar_efficiency.sql
[0m19:54:10.718968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3638c0>]}
[0m19:54:10.757815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09b9e0>]}
[0m19:54:10.758040 [info ] [MainThread]: Found 3 models, 2 data tests, 2 sources, 459 macros
[0m19:54:10.758201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c381e80>]}
[0m19:54:10.758999 [info ] [MainThread]: 
[0m19:54:10.759256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:10.761051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:54:10.766713 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:54:10.766865 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:54:10.766985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:11.312775 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.545 seconds
[0m19:54:11.318423 [debug] [ThreadPool]: On list_weather: Close
[0m19:54:11.449120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:54:11.463370 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:54:11.463791 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:54:11.464078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:54:11.899337 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.435 seconds
[0m19:54:11.904901 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:54:12.032439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a59850>]}
[0m19:54:12.033495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:12.034032 [info ] [MainThread]: 
[0m19:54:12.036609 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:54:12.037197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:54:12.037646 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:54:12.046372 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:54:12.047383 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:54:12.048061 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:54:12.048532 [info ] [Thread-1 (]: 1 of 2 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:54:12.048871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.solar_efficiency)
[0m19:54:12.049148 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:54:12.054401 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:54:12.054994 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:54:12.075235 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:54:12.076107 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:54:12.076353 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:54:12.076568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:13.069777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m19:54:13.097174 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:54:13.225245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beb2180>]}
[0m19:54:13.226450 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.17s]
[0m19:54:13.227242 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:54:13.227740 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:54:13.228394 [info ] [Thread-1 (]: 2 of 2 START sql table model data.temperature_range ............................ [RUN]
[0m19:54:13.228946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:54:13.229358 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:54:13.235704 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:54:13.236372 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:54:13.240551 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:54:13.241639 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:54:13.241977 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:54:13.242274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:14.379512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m19:54:14.389167 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:54:14.526284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f392c97-6d0a-4fcd-acf1-fa3e311d0207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c71eb40>]}
[0m19:54:14.528121 [info ] [Thread-1 (]: 2 of 2 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.30s]
[0m19:54:14.529187 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:54:14.531161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:14.531667 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:54:14.532266 [info ] [MainThread]: 
[0m19:54:14.532708 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m19:54:14.533811 [debug] [MainThread]: Command end result
[0m19:54:14.561390 [info ] [MainThread]: 
[0m19:54:14.561795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:14.562028 [info ] [MainThread]: 
[0m19:54:14.562264 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:54:14.563948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3566647, "process_user_time": 1.382068, "process_kernel_time": 0.189541, "process_mem_max_rss": "177995776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:54:14.564384 [debug] [MainThread]: Command `dbt run` succeeded at 19:54:14.564319 after 4.36 seconds
[0m19:54:14.564677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108205970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108205a00>]}
[0m19:54:14.564977 [debug] [MainThread]: Flushing usage events
[0m19:58:35.454099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc1820>]}


============================== 19:58:35.456284 | 56dddaf2-5e7a-40ae-a16f-f6a13015e34d ==============================
[0m19:58:35.456284 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:58:35.456564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:58:35.778097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e1520>]}
[0m19:58:35.798980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffa120>]}
[0m19:58:35.799351 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:58:35.807942 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:58:35.858612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:58:35.858883 [debug] [MainThread]: Partial parsing: added file: proj://models/output/pressure_drops.sql
[0m19:58:35.859029 [debug] [MainThread]: Partial parsing: added file: proj://models/output/daily_changes.sql
[0m19:58:35.952443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9dc3e0>]}
[0m19:58:35.991397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd7ce30>]}
[0m19:58:35.991624 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m19:58:35.991790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9de840>]}
[0m19:58:35.992605 [info ] [MainThread]: 
[0m19:58:35.992869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:35.994740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:58:36.000666 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:58:36.000815 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:58:36.000950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:36.609996 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.609 seconds
[0m19:58:36.615187 [debug] [ThreadPool]: On list_weather: Close
[0m19:58:36.742898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:58:36.756956 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:58:36.757385 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:58:36.757666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:37.344814 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.587 seconds
[0m19:58:37.351126 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:58:37.503397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc26f00>]}
[0m19:58:37.504515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:37.505025 [info ] [MainThread]: 
[0m19:58:37.508477 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:58:37.509129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:58:37.509572 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:58:37.519863 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:58:37.521205 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:58:37.522059 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m19:58:37.522639 [info ] [Thread-1 (]: 1 of 4 START sql table model data.daily_changes ................................ [RUN]
[0m19:58:37.523138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.daily_changes)
[0m19:58:37.523499 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m19:58:37.533259 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m19:58:37.533890 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m19:58:37.554644 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m19:58:37.555740 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m19:58:37.555996 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY date) AS prev_temp,
        LAG(humidity) OVER (ORDER BY date) AS prev_humidity
    FROM __dbt__cte__daily_weather
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime;
[0m19:58:37.556222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:38.034022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afee-0004-3864-0002-62e70002276a
[0m19:58:38.034758 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 17 unexpected ';'.
[0m19:58:38.035355 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m19:58:38.169393 [debug] [Thread-1 (]: Database Error in model daily_changes (models/output/daily_changes.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 17 unexpected ';'.
  compiled code at target/run/proj/models/output/daily_changes.sql
[0m19:58:38.172001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108164ec0>]}
[0m19:58:38.173000 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model data.daily_changes ....................... [[31mERROR[0m in 0.65s]
[0m19:58:38.173749 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m19:58:38.174397 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m19:58:38.175839 [info ] [Thread-1 (]: 2 of 4 START sql table model data.pressure_drops ............................... [RUN]
[0m19:58:38.176426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.pressure_drops)
[0m19:58:38.176843 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m19:58:38.185835 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m19:58:38.186522 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m19:58:38.190412 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m19:58:38.191753 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m19:58:38.192101 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY date) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY date)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY date)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM __dbt__cte__daily_weather
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m19:58:38.192415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:38.637694 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afee-0004-3868-0002-62e7000266c2
[0m19:58:38.639101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 45
invalid identifier 'DATE'
[0m19:58:38.640341 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m19:58:38.792775 [debug] [Thread-1 (]: Database Error in model pressure_drops (models/output/pressure_drops.sql)
  000904 (42000): SQL compilation error: error line 15 at position 45
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/pressure_drops.sql
[0m19:58:38.793230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0de450>]}
[0m19:58:38.793716 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model data.pressure_drops ...................... [[31mERROR[0m in 0.62s]
[0m19:58:38.794134 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m19:58:38.794428 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:58:38.794830 [info ] [Thread-1 (]: 3 of 4 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:58:38.795183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m19:58:38.795437 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:58:38.799996 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:58:38.800484 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:58:38.802124 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:58:38.803004 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:58:38.803256 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:58:38.803482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:39.861106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.057 seconds
[0m19:58:39.888481 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:58:40.008420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c875fa0>]}
[0m19:58:40.009205 [info ] [Thread-1 (]: 3 of 4 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m19:58:40.009908 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:58:40.010370 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:58:40.010964 [info ] [Thread-1 (]: 4 of 4 START sql table model data.temperature_range ............................ [RUN]
[0m19:58:40.011491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:58:40.011895 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:58:40.017975 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:58:40.018639 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:58:40.020885 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:58:40.021960 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:58:40.022301 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:58:40.022585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:41.234318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.211 seconds
[0m19:58:41.241325 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:58:41.385435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56dddaf2-5e7a-40ae-a16f-f6a13015e34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd91160>]}
[0m19:58:41.387311 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.37s]
[0m19:58:41.388227 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:58:41.390023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:41.390355 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:58:41.390843 [info ] [MainThread]: 
[0m19:58:41.391233 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m19:58:41.392855 [debug] [MainThread]: Command end result
[0m19:58:41.420981 [info ] [MainThread]: 
[0m19:58:41.421323 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:58:41.421536 [info ] [MainThread]: 
[0m19:58:41.421799 [error] [MainThread]:   Database Error in model daily_changes (models/output/daily_changes.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 17 unexpected ';'.
  compiled code at target/run/proj/models/output/daily_changes.sql
[0m19:58:41.421979 [info ] [MainThread]: 
[0m19:58:41.422185 [error] [MainThread]:   Database Error in model pressure_drops (models/output/pressure_drops.sql)
  000904 (42000): SQL compilation error: error line 15 at position 45
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/pressure_drops.sql
[0m19:58:41.422355 [info ] [MainThread]: 
[0m19:58:41.422549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:58:41.424509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9992657, "process_user_time": 1.543574, "process_kernel_time": 0.203885, "process_mem_max_rss": "179814400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:58:41.424975 [debug] [MainThread]: Command `dbt run` failed at 19:58:41.424908 after 6.00 seconds
[0m19:58:41.425282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb483b0>]}
[0m19:58:41.425521 [debug] [MainThread]: Flushing usage events
[0m19:59:20.789820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039703b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9880>]}


============================== 19:59:20.791821 | e1b13e97-7d17-4668-9d9e-946d22ddc4a1 ==============================
[0m19:59:20.791821 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:59:20.792111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:21.127336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cb830>]}
[0m19:59:21.148271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b5370>]}
[0m19:59:21.148651 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:59:21.156980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:59:21.207537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:59:21.207832 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/pressure_drops.sql
[0m19:59:21.207997 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/daily_changes.sql
[0m19:59:21.302706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108416a50>]}
[0m19:59:21.342702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108588e60>]}
[0m19:59:21.342931 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m19:59:21.343088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108055370>]}
[0m19:59:21.343925 [info ] [MainThread]: 
[0m19:59:21.344182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:21.346040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:59:21.351947 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:59:21.352100 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:59:21.352230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:21.877851 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.525 seconds
[0m19:59:21.883545 [debug] [ThreadPool]: On list_weather: Close
[0m19:59:22.025486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:59:22.037093 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:59:22.037494 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:59:22.037779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:22.571061 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.533 seconds
[0m19:59:22.576053 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:59:22.697207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108417da0>]}
[0m19:59:22.697898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:22.698279 [info ] [MainThread]: 
[0m19:59:22.700681 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:59:22.701226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:59:22.701650 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:59:22.709769 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:59:22.710730 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:59:22.711419 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m19:59:22.711872 [info ] [Thread-1 (]: 1 of 4 START sql table model data.daily_changes ................................ [RUN]
[0m19:59:22.712239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.daily_changes)
[0m19:59:22.712513 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m19:59:22.720566 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m19:59:22.721051 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m19:59:22.740267 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m19:59:22.741290 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m19:59:22.741549 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY date) AS prev_temp,
        LAG(humidity) OVER (ORDER BY date) AS prev_humidity
    FROM __dbt__cte__daily_weather
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m19:59:22.741764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:23.210353 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8afef-0004-386a-0002-62e70002d29a
[0m19:59:23.210800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 33
invalid identifier 'DATE'
[0m19:59:23.211180 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m19:59:23.329386 [debug] [Thread-1 (]: Database Error in model daily_changes (models/output/daily_changes.sql)
  000904 (42000): SQL compilation error: error line 16 at position 33
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/daily_changes.sql
[0m19:59:23.331952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039715e0>]}
[0m19:59:23.332982 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model data.daily_changes ....................... [[31mERROR[0m in 0.62s]
[0m19:59:23.333968 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m19:59:23.334731 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m19:59:23.336346 [info ] [Thread-1 (]: 2 of 4 START sql table model data.pressure_drops ............................... [RUN]
[0m19:59:23.336950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.pressure_drops)
[0m19:59:23.337379 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m19:59:23.346795 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m19:59:23.347466 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m19:59:23.351617 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m19:59:23.352945 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m19:59:23.353284 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY datetime) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM __dbt__cte__daily_weather
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m19:59:23.353594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:24.765677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.412 seconds
[0m19:59:24.786698 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m19:59:24.913146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088efda0>]}
[0m19:59:24.915194 [info ] [Thread-1 (]: 2 of 4 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.58s]
[0m19:59:24.916870 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m19:59:24.917861 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:59:24.918661 [info ] [Thread-1 (]: 3 of 4 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:59:24.919339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m19:59:24.919822 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:59:24.928948 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:59:24.929837 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:59:24.932995 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:59:24.934308 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:59:24.934704 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:59:24.935079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:26.085771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m19:59:26.096469 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:59:26.231229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba72c0>]}
[0m19:59:26.232034 [info ] [Thread-1 (]: 3 of 4 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.31s]
[0m19:59:26.232720 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:59:26.233199 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:59:26.233804 [info ] [Thread-1 (]: 4 of 4 START sql table model data.temperature_range ............................ [RUN]
[0m19:59:26.234361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:59:26.234784 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:59:26.241034 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:59:26.241704 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:59:26.243914 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:59:26.244961 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:59:26.245281 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:59:26.245576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:27.418016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.172 seconds
[0m19:59:27.422903 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:59:27.552161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b13e97-7d17-4668-9d9e-946d22ddc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086baed0>]}
[0m19:59:27.553603 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.32s]
[0m19:59:27.554490 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:59:27.556249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:27.556610 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:59:27.557100 [info ] [MainThread]: 
[0m19:59:27.557484 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m19:59:27.558844 [debug] [MainThread]: Command end result
[0m19:59:27.586792 [info ] [MainThread]: 
[0m19:59:27.587112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:59:27.587320 [info ] [MainThread]: 
[0m19:59:27.587581 [error] [MainThread]:   Database Error in model daily_changes (models/output/daily_changes.sql)
  000904 (42000): SQL compilation error: error line 16 at position 33
  invalid identifier 'DATE'
  compiled code at target/run/proj/models/output/daily_changes.sql
[0m19:59:27.587775 [info ] [MainThread]: 
[0m19:59:27.587967 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:59:27.589550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.828847, "process_user_time": 1.549066, "process_kernel_time": 0.20251, "process_mem_max_rss": "178634752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:59:27.589926 [debug] [MainThread]: Command `dbt run` failed at 19:59:27.589869 after 6.83 seconds
[0m19:59:27.590192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081148f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd2fc0>]}
[0m19:59:27.590403 [debug] [MainThread]: Flushing usage events
[0m19:59:45.585274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bd760>]}


============================== 19:59:45.587125 | 39431ad4-0ad2-4899-8470-81262ed32027 ==============================
[0m19:59:45.587125 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:59:45.587420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:45.910287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2769c0>]}
[0m19:59:45.931425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aac980>]}
[0m19:59:45.931802 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:59:45.940107 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:59:45.993197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:59:45.993507 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/daily_changes.sql
[0m19:59:46.087056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0cbc0>]}
[0m19:59:46.126763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa70da0>]}
[0m19:59:46.126975 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m19:59:46.127135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a775e80>]}
[0m19:59:46.127972 [info ] [MainThread]: 
[0m19:59:46.128236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:46.130130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:59:46.136101 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:59:46.136260 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:59:46.136384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:46.763759 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.627 seconds
[0m19:59:46.769065 [debug] [ThreadPool]: On list_weather: Close
[0m19:59:46.907153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:59:46.917786 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:59:46.918171 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:59:46.918448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:47.341471 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.423 seconds
[0m19:59:47.348020 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:59:47.476879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9fdcd0>]}
[0m19:59:47.477486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:47.477790 [info ] [MainThread]: 
[0m19:59:47.479824 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:59:47.480221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:59:47.480538 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:59:47.487857 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:59:47.488756 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:59:47.489464 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m19:59:47.489941 [info ] [Thread-1 (]: 1 of 4 START sql table model data.daily_changes ................................ [RUN]
[0m19:59:47.490271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.daily_changes)
[0m19:59:47.490534 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m19:59:47.498414 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m19:59:47.498877 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m19:59:47.517288 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m19:59:47.518318 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m19:59:47.518561 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM __dbt__cte__daily_weather
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m19:59:47.518774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:48.614853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m19:59:48.645958 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m19:59:48.788533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a566480>]}
[0m19:59:48.789906 [info ] [Thread-1 (]: 1 of 4 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.30s]
[0m19:59:48.790870 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m19:59:48.791501 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m19:59:48.792284 [info ] [Thread-1 (]: 2 of 4 START sql table model data.pressure_drops ............................... [RUN]
[0m19:59:48.792849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.pressure_drops)
[0m19:59:48.793263 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m19:59:48.804956 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m19:59:48.805768 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m19:59:48.808302 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m19:59:48.809673 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m19:59:48.810025 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY datetime) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM __dbt__cte__daily_weather
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m19:59:48.810351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:50.149301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m19:59:50.157814 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m19:59:50.279754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add75c0>]}
[0m19:59:50.281080 [info ] [Thread-1 (]: 2 of 4 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.49s]
[0m19:59:50.281906 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m19:59:50.282477 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:59:50.283129 [info ] [Thread-1 (]: 3 of 4 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:59:50.283653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m19:59:50.284034 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:59:50.291668 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:59:50.292456 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:59:50.295079 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:59:50.296416 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:59:50.296828 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:59:50.297199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:51.246447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m19:59:51.250877 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:59:51.372882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade95b0>]}
[0m19:59:51.374115 [info ] [Thread-1 (]: 3 of 4 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m19:59:51.374749 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:59:51.375159 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:59:51.375685 [info ] [Thread-1 (]: 4 of 4 START sql table model data.temperature_range ............................ [RUN]
[0m19:59:51.376180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:59:51.376538 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:59:51.381845 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:59:51.382446 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:59:51.384613 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:59:51.385640 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:59:51.385935 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH  __dbt__cte__daily_weather as (
WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
), temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM __dbt__cte__daily_weather
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:59:51.386199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:52.403643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.017 seconds
[0m19:59:52.410393 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:59:52.538210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39431ad4-0ad2-4899-8470-81262ed32027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92c950>]}
[0m19:59:52.539066 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.16s]
[0m19:59:52.539744 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:59:52.541016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:52.541314 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:59:52.541637 [info ] [MainThread]: 
[0m19:59:52.541924 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m19:59:52.542853 [debug] [MainThread]: Command end result
[0m19:59:52.567758 [info ] [MainThread]: 
[0m19:59:52.568025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:52.568208 [info ] [MainThread]: 
[0m19:59:52.568408 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:59:52.569797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0123243, "process_user_time": 1.526994, "process_kernel_time": 0.1971, "process_mem_max_rss": "177160192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:59:52.570148 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:52.570094 after 7.01 seconds
[0m19:59:52.570375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106302120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a566480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338380>]}
[0m19:59:52.570585 [debug] [MainThread]: Flushing usage events
[0m20:06:59.346166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106656bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108385700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108385370>]}


============================== 20:06:59.348152 | da1ee613-f20b-4060-8c67-e50b2c6e986a ==============================
[0m20:06:59.348152 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:06:59.348444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:06:59.410115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da1ee613-f20b-4060-8c67-e50b2c6e986a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108407bf0>]}
[0m20:06:59.417305 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09930075, "process_user_time": 0.569388, "process_kernel_time": 0.089526, "process_mem_max_rss": "93569024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:06:59.417542 [debug] [MainThread]: Command `dbt clean` succeeded at 20:06:59.417503 after 0.10 seconds
[0m20:06:59.417703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ae480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083adca0>]}
[0m20:06:59.417926 [debug] [MainThread]: Flushing usage events
[0m20:07:08.472289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036c23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044417c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104441490>]}


============================== 20:07:08.474282 | b6678433-0952-4bce-997c-3e464b954f44 ==============================
[0m20:07:08.474282 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:07:08.474574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:08.534632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6678433-0952-4bce-997c-3e464b954f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103257800>]}
[0m20:07:08.539653 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09615321, "process_user_time": 0.571692, "process_kernel_time": 0.090137, "process_mem_max_rss": "94568448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:07:08.539876 [debug] [MainThread]: Command `dbt clean` succeeded at 20:07:08.539840 after 0.10 seconds
[0m20:07:08.540022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103812780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454d130>]}
[0m20:07:08.540156 [debug] [MainThread]: Flushing usage events
[0m20:07:11.556373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027476b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104295ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042957f0>]}


============================== 20:07:11.558258 | b58a499e-fe9e-483f-ba95-e83de006cece ==============================
[0m20:07:11.558258 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:07:11.558547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:07:11.871409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58a499e-fe9e-483f-ba95-e83de006cece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b14f80>]}
[0m20:07:11.893006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58a499e-fe9e-483f-ba95-e83de006cece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426f9e0>]}
[0m20:07:11.893378 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:07:11.901469 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:07:11.901974 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:07:11.902157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b58a499e-fe9e-483f-ba95-e83de006cece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080924e0>]}
[0m20:07:12.395453 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_weather' (models/input/daily_weather.sql) depends on a source named 'data.daily_weather' which was not found
[0m20:07:12.396492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8678477, "process_user_time": 1.276565, "process_kernel_time": 0.153501, "process_mem_max_rss": "166068224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:07:12.396765 [debug] [MainThread]: Command `dbt run` failed at 20:07:12.396721 after 0.87 seconds
[0m20:07:12.396942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104295850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b4770>]}
[0m20:07:12.397082 [debug] [MainThread]: Flushing usage events
[0m20:08:03.047064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f260f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f513d0>]}


============================== 20:08:03.048945 | 4505bd86-7237-4a8a-82f3-cf6f7350aa8c ==============================
[0m20:08:03.048945 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:08:03.049240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:03.108957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4505bd86-7237-4a8a-82f3-cf6f7350aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399bef0>]}
[0m20:08:03.114070 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09492475, "process_user_time": 0.570716, "process_kernel_time": 0.085195, "process_mem_max_rss": "94502912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:08:03.114306 [debug] [MainThread]: Command `dbt clean` succeeded at 20:08:03.114269 after 0.10 seconds
[0m20:08:03.114454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f26ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104027110>]}
[0m20:08:03.114590 [debug] [MainThread]: Flushing usage events
[0m20:08:05.698226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068804a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c859a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c856d0>]}


============================== 20:08:05.700112 | ab8852d2-bf89-4b09-86ad-5eea9600b07c ==============================
[0m20:08:05.700112 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:08:05.700398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:08:06.010982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e71a0>]}
[0m20:08:06.032555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c43530>]}
[0m20:08:06.032926 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:08:06.041274 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:08:06.041817 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:08:06.041990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c84f80>]}
[0m20:08:06.575903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acbf230>]}
[0m20:08:06.617187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa0290>]}
[0m20:08:06.617408 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:08:06.617578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d21640>]}
[0m20:08:06.618399 [info ] [MainThread]: 
[0m20:08:06.618666 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:06.620605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:08:06.626365 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:08:06.626517 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:08:06.626639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:07.237585 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.611 seconds
[0m20:08:07.241449 [debug] [ThreadPool]: On list_weather: Close
[0m20:08:07.421365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:08:07.435668 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:08:07.436186 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:08:07.436497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:07.972052 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m20:08:07.976140 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:08:08.099927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013620>]}
[0m20:08:08.101215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:08.101717 [info ] [MainThread]: 
[0m20:08:08.105150 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:08:08.106027 [info ] [Thread-1 (]: 1 of 5 START sql view model data.daily_weather ................................. [RUN]
[0m20:08:08.106643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:08:08.107072 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:08:08.116272 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:08:08.117637 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:08:08.136471 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m20:08:08.140761 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m20:08:08.144722 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:08:08.144957 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m20:08:08.145157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:08.704168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m20:08:08.723760 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:08:08.725597 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:08:08.725988 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:08:08.840326 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8aff8-0004-386c-0002-62e7000247a2
[0m20:08:08.840828 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m20:08:08.841297 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:08:08.967539 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:08:08.969551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab8852d2-bf89-4b09-86ad-5eea9600b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a66f0>]}
[0m20:08:08.970389 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.86s]
[0m20:08:08.971112 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:08:08.972757 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:08:08.973283 [info ] [Thread-1 (]: 2 of 5 SKIP relation data.daily_changes ........................................ [[33mSKIP[0m]
[0m20:08:08.973699 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:08:08.974067 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:08:08.974472 [info ] [Thread-1 (]: 3 of 5 SKIP relation data.pressure_drops ....................................... [[33mSKIP[0m]
[0m20:08:08.974853 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:08:08.975196 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:08:08.975626 [info ] [Thread-1 (]: 4 of 5 SKIP relation data.solar_efficiency ..................................... [[33mSKIP[0m]
[0m20:08:08.976097 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:08:08.976483 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:08:08.976855 [info ] [Thread-1 (]: 5 of 5 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m20:08:08.977209 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:08:08.978155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:08.978371 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m20:08:08.978651 [info ] [MainThread]: 
[0m20:08:08.978884 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m20:08:08.979482 [debug] [MainThread]: Command end result
[0m20:08:09.001594 [info ] [MainThread]: 
[0m20:08:09.001848 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:08:09.002018 [info ] [MainThread]: 
[0m20:08:09.002219 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:08:09.002381 [info ] [MainThread]: 
[0m20:08:09.002540 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m20:08:09.003739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3335354, "process_user_time": 1.730785, "process_kernel_time": 0.196512, "process_mem_max_rss": "178405376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:08:09.004026 [debug] [MainThread]: Command `dbt run` failed at 20:08:09.003976 after 3.33 seconds
[0m20:08:09.004231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b139100>]}
[0m20:08:09.004424 [debug] [MainThread]: Flushing usage events
[0m20:08:45.330431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4d520>]}


============================== 20:08:45.332366 | 31968937-eaa2-4800-be92-7b76f351608a ==============================
[0m20:08:45.332366 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:08:45.332656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:45.392435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31968937-eaa2-4800-be92-7b76f351608a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035feb10>]}
[0m20:08:45.398582 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0962, "process_user_time": 0.570997, "process_kernel_time": 0.088752, "process_mem_max_rss": "93274112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:08:45.398829 [debug] [MainThread]: Command `dbt clean` succeeded at 20:08:45.398790 after 0.10 seconds
[0m20:08:45.398989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104814830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d204d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103781e80>]}
[0m20:08:45.399144 [debug] [MainThread]: Flushing usage events
[0m20:08:48.509448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641d910>]}


============================== 20:08:48.511387 | 2c902a23-888f-473f-92cc-63f99ca28ad2 ==============================
[0m20:08:48.511387 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:08:48.511679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m20:08:48.819976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d1f10>]}
[0m20:08:48.841143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfc6b0>]}
[0m20:08:48.841509 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:08:48.849797 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:08:48.850276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:08:48.850463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cfe90>]}
[0m20:08:49.378227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a694bc0>]}
[0m20:08:49.420754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64e330>]}
[0m20:08:49.420990 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:08:49.421157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c902a23-888f-473f-92cc-63f99ca28ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e4cb0>]}
[0m20:08:49.421908 [info ] [MainThread]: 
[0m20:08:49.422069 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:08:49.464575 [info ] [MainThread]: Done.
[0m20:08:49.465587 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.98412716, "process_user_time": 1.387071, "process_kernel_time": 0.160315, "process_mem_max_rss": "165740544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:08:49.465930 [debug] [MainThread]: Command `dbt source freshness` succeeded at 20:08:49.465881 after 0.98 seconds
[0m20:08:49.466106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fed6a0>]}
[0m20:08:49.466272 [debug] [MainThread]: Flushing usage events
[0m20:09:41.896368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103626f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9730>]}


============================== 20:09:41.898534 | 0010b9f7-c53c-4cd7-aa8c-ce880c4c4793 ==============================
[0m20:09:41.898534 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:09:41.898822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:09:42.236395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731d5b0>]}
[0m20:09:42.257409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069011c0>]}
[0m20:09:42.257773 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:09:42.265843 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:09:42.316678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:42.316883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:42.334699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109737fe0>]}
[0m20:09:42.374820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1f260>]}
[0m20:09:42.375038 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:09:42.375198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076af830>]}
[0m20:09:42.376074 [info ] [MainThread]: 
[0m20:09:42.376346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:09:42.378159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:09:42.384522 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:09:42.384678 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:09:42.384800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:42.947162 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.562 seconds
[0m20:09:42.950756 [debug] [ThreadPool]: On list_weather: Close
[0m20:09:43.079059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:09:43.091049 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:09:43.091501 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:09:43.091792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:43.510594 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.418 seconds
[0m20:09:43.517104 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:09:43.632345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac633b0>]}
[0m20:09:43.633476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:43.633992 [info ] [MainThread]: 
[0m20:09:43.637376 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:09:43.638151 [info ] [Thread-1 (]: 1 of 5 START sql view model data.daily_weather ................................. [RUN]
[0m20:09:43.638684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:09:43.639082 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:09:43.648815 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:09:43.650145 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:09:43.670662 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m20:09:43.674882 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m20:09:43.678672 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:09:43.678904 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m20:09:43.679103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:44.191438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m20:09:44.207777 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:09:44.209327 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:09:44.209712 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:09:44.331182 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8aff9-0004-386a-0002-62e70002d2ce
[0m20:09:44.332218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m20:09:44.333024 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:09:44.464546 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:09:44.467103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0010b9f7-c53c-4cd7-aa8c-ce880c4c4793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645d130>]}
[0m20:09:44.468003 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.83s]
[0m20:09:44.468774 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:09:44.470596 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:09:44.471231 [info ] [Thread-1 (]: 2 of 5 SKIP relation data.daily_changes ........................................ [[33mSKIP[0m]
[0m20:09:44.471813 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:09:44.472260 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:09:44.472658 [info ] [Thread-1 (]: 3 of 5 SKIP relation data.pressure_drops ....................................... [[33mSKIP[0m]
[0m20:09:44.473041 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:09:44.473385 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:09:44.473758 [info ] [Thread-1 (]: 4 of 5 SKIP relation data.solar_efficiency ..................................... [[33mSKIP[0m]
[0m20:09:44.474166 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:09:44.474503 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:09:44.474857 [info ] [Thread-1 (]: 5 of 5 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m20:09:44.475209 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:09:44.476207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:44.476465 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m20:09:44.476790 [info ] [MainThread]: 
[0m20:09:44.477072 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m20:09:44.477768 [debug] [MainThread]: Command end result
[0m20:09:44.499294 [info ] [MainThread]: 
[0m20:09:44.499550 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:09:44.499732 [info ] [MainThread]: 
[0m20:09:44.499958 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:09:44.500134 [info ] [MainThread]: 
[0m20:09:44.500310 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m20:09:44.501635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6356175, "process_user_time": 1.225829, "process_kernel_time": 0.192605, "process_mem_max_rss": "173506560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:09:44.501977 [debug] [MainThread]: Command `dbt run` failed at 20:09:44.501926 after 2.64 seconds
[0m20:09:44.502200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a927b00>]}
[0m20:09:44.502396 [debug] [MainThread]: Flushing usage events
[0m20:16:31.977177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088717f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088714f0>]}


============================== 20:16:31.979115 | e28484ac-cfce-4322-9d30-dc907007e537 ==============================
[0m20:16:31.979115 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:16:31.979399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:16:32.039732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e28484ac-cfce-4322-9d30-dc907007e537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890b590>]}
[0m20:16:32.046615 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.098848626, "process_user_time": 0.570907, "process_kernel_time": 0.094103, "process_mem_max_rss": "94502912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:32.046904 [debug] [MainThread]: Command `dbt clean` succeeded at 20:16:32.046861 after 0.10 seconds
[0m20:16:32.047078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087564e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088717c0>]}
[0m20:16:32.047253 [debug] [MainThread]: Flushing usage events
[0m20:16:34.447178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060687d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064918e0>]}


============================== 20:16:34.449231 | 25ae7c48-0607-490b-945c-dfd20e7e7b66 ==============================
[0m20:16:34.449231 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:16:34.449519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:34.785451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d14f20>]}
[0m20:16:34.806408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbfe00>]}
[0m20:16:34.806800 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:16:34.815019 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:16:34.815514 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:16:34.815696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753f650>]}
[0m20:16:35.237531 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:16:35.237799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a385af0>]}
[0m20:16:35.348505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5687a0>]}
[0m20:16:35.388878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a76c500>]}
[0m20:16:35.389099 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:16:35.389255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ff2f0>]}
[0m20:16:35.390078 [info ] [MainThread]: 
[0m20:16:35.390344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:35.392278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:16:35.398002 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:16:35.398157 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:16:35.398276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:35.972854 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.574 seconds
[0m20:16:35.976383 [debug] [ThreadPool]: On list_weather: Close
[0m20:16:36.108417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:16:36.122029 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:16:36.122529 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:16:36.122839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:36.623755 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.501 seconds
[0m20:16:36.627794 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:16:36.792135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42cbf0>]}
[0m20:16:36.793091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:36.793492 [info ] [MainThread]: 
[0m20:16:36.796055 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:16:36.796761 [info ] [Thread-1 (]: 1 of 5 START sql view model data.daily_weather ................................. [RUN]
[0m20:16:36.797303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:16:36.797719 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:16:36.805830 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:16:36.806922 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:16:36.828515 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:16:36.829375 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:16:36.829612 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:16:36.829811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:37.320886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b000-0004-3869-0002-62e700027836
[0m20:16:37.321696 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m20:16:37.322356 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:16:37.457466 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:16:37.460341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ae7c48-0607-490b-945c-dfd20e7e7b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106493c80>]}
[0m20:16:37.461268 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.66s]
[0m20:16:37.462040 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:16:37.463900 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:16:37.464518 [info ] [Thread-1 (]: 2 of 5 SKIP relation data.daily_changes ........................................ [[33mSKIP[0m]
[0m20:16:37.465016 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:16:37.465439 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:16:37.465865 [info ] [Thread-1 (]: 3 of 5 SKIP relation data.pressure_drops ....................................... [[33mSKIP[0m]
[0m20:16:37.466296 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:16:37.466660 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:16:37.467027 [info ] [Thread-1 (]: 4 of 5 SKIP relation data.solar_efficiency ..................................... [[33mSKIP[0m]
[0m20:16:37.467390 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:16:37.467718 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:16:37.468030 [info ] [Thread-1 (]: 5 of 5 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m20:16:37.468423 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:16:37.469466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:37.469727 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m20:16:37.470056 [info ] [MainThread]: 
[0m20:16:37.470329 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m20:16:37.471040 [debug] [MainThread]: Command end result
[0m20:16:37.493004 [info ] [MainThread]: 
[0m20:16:37.493262 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:16:37.493450 [info ] [MainThread]: 
[0m20:16:37.493672 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:16:37.493854 [info ] [MainThread]: 
[0m20:16:37.494032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m20:16:37.495371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0764031, "process_user_time": 1.701201, "process_kernel_time": 0.206321, "process_mem_max_rss": "178962432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:37.495679 [debug] [MainThread]: Command `dbt run` failed at 20:16:37.495630 after 3.08 seconds
[0m20:16:37.495884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5087d0>]}
[0m20:16:37.496077 [debug] [MainThread]: Flushing usage events
[0m20:18:17.293566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f06090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f313a0>]}


============================== 20:18:17.295497 | 7989dc70-d05b-4006-b81a-39fc36d35b6a ==============================
[0m20:18:17.295497 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:17.295784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:17.357314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7989dc70-d05b-4006-b81a-39fc36d35b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fdd30>]}
[0m20:18:17.364209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09928588, "process_user_time": 0.5696, "process_kernel_time": 0.093368, "process_mem_max_rss": "94928896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:17.364447 [debug] [MainThread]: Command `dbt clean` succeeded at 20:18:17.364409 after 0.10 seconds
[0m20:18:17.364606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c38e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471dc70>]}
[0m20:18:17.364745 [debug] [MainThread]: Flushing usage events
[0m20:18:20.015483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103366510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10333a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b18e0>]}


============================== 20:18:20.017343 | 47bba49e-6096-45d5-b427-c3734ba29c89 ==============================
[0m20:18:20.017343 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:20.017639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:20.336244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f5e20>]}
[0m20:18:20.357139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822f1a0>]}
[0m20:18:20.357510 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:18:20.365767 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:20.366251 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:18:20.366427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105653710>]}
[0m20:18:20.786568 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:18:20.786832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108312900>]}
[0m20:18:20.898295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045da0c0>]}
[0m20:18:20.939339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108871fd0>]}
[0m20:18:20.939556 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:18:20.939712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867e120>]}
[0m20:18:20.940512 [info ] [MainThread]: 
[0m20:18:20.940774 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:18:20.942671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:18:20.948424 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:18:20.948578 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:18:20.948694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:21.590458 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.641 seconds
[0m20:18:21.594167 [debug] [ThreadPool]: On list_weather: Close
[0m20:18:21.727203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:18:21.744074 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:18:21.744566 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:18:21.744873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:22.398954 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.654 seconds
[0m20:18:22.404809 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:18:22.543673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939f70>]}
[0m20:18:22.544951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:22.545468 [info ] [MainThread]: 
[0m20:18:22.548992 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:18:22.549781 [info ] [Thread-1 (]: 1 of 5 START sql view model data.daily_weather ................................. [RUN]
[0m20:18:22.550338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:18:22.550742 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:18:22.560487 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:18:22.561841 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:18:22.581649 [debug] [Thread-1 (]: Dropping relation "WEATHER"."DATA"."DAILY_WEATHER" because it is of type table
[0m20:18:22.585970 [debug] [Thread-1 (]: Applying DROP to: "WEATHER"."DATA"."DAILY_WEATHER"
[0m20:18:22.589884 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:18:22.590118 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
drop table if exists "WEATHER"."DATA"."DAILY_WEATHER" cascade
[0m20:18:22.590319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:23.091828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m20:18:23.106487 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:18:23.108029 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:18:23.108330 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.daily_weather
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:18:23.238915 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b002-0004-3863-0002-62e7000238a6
[0m20:18:23.239582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
[0m20:18:23.240161 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:18:23.390629 [debug] [Thread-1 (]: Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:18:23.393338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47bba49e-6096-45d5-b427-c3734ba29c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886c4a0>]}
[0m20:18:23.394320 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model data.daily_weather ........................ [[31mERROR[0m in 0.84s]
[0m20:18:23.395088 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:18:23.397067 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:18:23.397645 [info ] [Thread-1 (]: 2 of 5 SKIP relation data.daily_changes ........................................ [[33mSKIP[0m]
[0m20:18:23.398164 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:18:23.398615 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:18:23.399107 [info ] [Thread-1 (]: 3 of 5 SKIP relation data.pressure_drops ....................................... [[33mSKIP[0m]
[0m20:18:23.399568 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:18:23.399923 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:18:23.400291 [info ] [Thread-1 (]: 4 of 5 SKIP relation data.solar_efficiency ..................................... [[33mSKIP[0m]
[0m20:18:23.400661 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:18:23.400992 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:18:23.401345 [info ] [Thread-1 (]: 5 of 5 SKIP relation data.temperature_range .................................... [[33mSKIP[0m]
[0m20:18:23.401714 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:18:23.402709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:23.402967 [debug] [MainThread]: Connection 'model.proj.daily_weather' was properly closed.
[0m20:18:23.403294 [info ] [MainThread]: 
[0m20:18:23.403579 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m20:18:23.404295 [debug] [MainThread]: Command end result
[0m20:18:23.428116 [info ] [MainThread]: 
[0m20:18:23.428379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:18:23.428579 [info ] [MainThread]: 
[0m20:18:23.428803 [error] [MainThread]:   Database Error in model daily_weather (models/input/daily_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'WEATHER.DATA.DAILY_WEATHER' does not exist or not authorized.
  compiled code at target/run/proj/models/input/daily_weather.sql
[0m20:18:23.428982 [info ] [MainThread]: 
[0m20:18:23.429161 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m20:18:23.430457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.442715, "process_user_time": 1.739335, "process_kernel_time": 0.19818, "process_mem_max_rss": "176291840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:23.430784 [debug] [MainThread]: Command `dbt run` failed at 20:18:23.430728 after 3.44 seconds
[0m20:18:23.430994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088185c0>]}
[0m20:18:23.431183 [debug] [MainThread]: Flushing usage events
[0m20:20:08.906396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104115580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104115250>]}


============================== 20:20:08.908478 | df9c1fbf-ccae-4818-b0b9-37998ae30d45 ==============================
[0m20:20:08.908478 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:20:08.908763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:08.971760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9c1fbf-ccae-4818-b0b9-37998ae30d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101aeebd0>]}
[0m20:20:08.977755 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.101571955, "process_user_time": 0.572127, "process_kernel_time": 0.092433, "process_mem_max_rss": "95502336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:08.978016 [debug] [MainThread]: Command `dbt clean` succeeded at 20:20:08.977977 after 0.10 seconds
[0m20:20:08.978184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104115520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffae70>]}
[0m20:20:08.978335 [debug] [MainThread]: Flushing usage events
[0m20:26:16.674396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028bb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c31490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c31160>]}


============================== 20:26:16.677045 | 1c1e682d-40c1-4e27-8044-2012d28fa376 ==============================
[0m20:26:16.677045 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:26:16.677334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:26:16.762885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1e682d-40c1-4e27-8044-2012d28fa376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035dec30>]}
[0m20:26:16.772705 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1274172, "process_user_time": 0.571936, "process_kernel_time": 0.096913, "process_mem_max_rss": "94076928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:26:16.773000 [debug] [MainThread]: Command `dbt clean` succeeded at 20:26:16.772963 after 0.13 seconds
[0m20:26:16.773146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c31160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c58c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb3b90>]}
[0m20:26:16.773281 [debug] [MainThread]: Flushing usage events
[0m20:26:22.349981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1910>]}


============================== 20:26:22.351863 | baeefc03-caa0-4313-8395-24d21b7dc96c ==============================
[0m20:26:22.351863 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:26:22.352152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:22.870151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a329310>]}
[0m20:26:22.891162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f530>]}
[0m20:26:22.892383 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:26:22.903510 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:26:22.904021 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:26:22.904199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a453080>]}
[0m20:26:23.335026 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:26:23.335299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cf020>]}
[0m20:26:23.447562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d2720>]}
[0m20:26:23.493500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0ff50>]}
[0m20:26:23.493711 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:26:23.493863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a7aa0>]}
[0m20:26:23.494681 [info ] [MainThread]: 
[0m20:26:23.494937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:26:23.496833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:26:23.502530 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:26:23.502691 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:26:23.502808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:24.068910 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.566 seconds
[0m20:26:24.073885 [debug] [ThreadPool]: On list_weather: Close
[0m20:26:24.216432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:26:24.228719 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:26:24.229111 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:26:24.229366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:24.665214 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.436 seconds
[0m20:26:24.669471 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:26:24.799780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad78170>]}
[0m20:26:24.800479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:24.800862 [info ] [MainThread]: 
[0m20:26:24.803606 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:26:24.804153 [info ] [Thread-1 (]: 1 of 5 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m20:26:24.804581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:26:24.804908 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:26:24.812622 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:26:24.813655 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:26:24.834419 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:26:24.835283 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:26:24.835510 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:26:24.835714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:25.984089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.148 seconds
[0m20:26:26.007986 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:26:26.147830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35e000>]}
[0m20:26:26.148569 [info ] [Thread-1 (]: 1 of 5 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.34s]
[0m20:26:26.149115 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:26:26.149976 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:26:26.150443 [info ] [Thread-1 (]: 2 of 5 START sql table model data.daily_changes ................................ [RUN]
[0m20:26:26.150836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.daily_changes)
[0m20:26:26.151090 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m20:26:26.153526 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m20:26:26.154234 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m20:26:26.168858 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m20:26:26.169958 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m20:26:26.170219 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m20:26:26.170443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:27.519780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m20:26:27.529041 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m20:26:27.657377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0113a0>]}
[0m20:26:27.657990 [info ] [Thread-1 (]: 2 of 5 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.51s]
[0m20:26:27.658497 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:26:27.658848 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:26:27.659328 [info ] [Thread-1 (]: 3 of 5 START sql table model data.pressure_drops ............................... [RUN]
[0m20:26:27.659715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.pressure_drops)
[0m20:26:27.660008 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m20:26:27.662542 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m20:26:27.663099 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m20:26:27.666438 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m20:26:27.667526 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m20:26:27.667822 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY datetime) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m20:26:27.668108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:33.563382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.895 seconds
[0m20:26:33.570355 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m20:26:33.723690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c07e4e0>]}
[0m20:26:33.724547 [info ] [Thread-1 (]: 3 of 5 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 6.06s]
[0m20:26:33.725234 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:26:33.725719 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:26:33.726322 [info ] [Thread-1 (]: 4 of 5 START sql table model data.solar_efficiency ............................. [RUN]
[0m20:26:33.726873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m20:26:33.727304 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m20:26:33.730974 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m20:26:33.731690 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m20:26:33.734166 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m20:26:33.735372 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m20:26:33.735746 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m20:26:33.736107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:34.891327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m20:26:34.898216 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m20:26:35.033911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af56390>]}
[0m20:26:35.036073 [info ] [Thread-1 (]: 4 of 5 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.31s]
[0m20:26:35.037092 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:26:35.037426 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:26:35.037765 [info ] [Thread-1 (]: 5 of 5 START sql table model data.temperature_range ............................ [RUN]
[0m20:26:35.038150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m20:26:35.038465 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m20:26:35.040817 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m20:26:35.041352 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m20:26:35.043063 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m20:26:35.043868 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m20:26:35.044121 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m20:26:35.044352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:36.145130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m20:26:36.149726 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m20:26:36.302009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeefc03-caa0-4313-8395-24d21b7dc96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c054620>]}
[0m20:26:36.304348 [info ] [Thread-1 (]: 5 of 5 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.26s]
[0m20:26:36.304991 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:26:36.306029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:36.306276 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m20:26:36.306548 [info ] [MainThread]: 
[0m20:26:36.306775 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m20:26:36.307576 [debug] [MainThread]: Command end result
[0m20:26:36.327451 [info ] [MainThread]: 
[0m20:26:36.327709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:36.327892 [info ] [MainThread]: 
[0m20:26:36.328074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:26:36.329473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.007394, "process_user_time": 1.994634, "process_kernel_time": 0.234314, "process_mem_max_rss": "177258496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:26:36.329760 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:36.329712 after 14.01 seconds
[0m20:26:36.329949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106401700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5b7d0>]}
[0m20:26:36.330134 [debug] [MainThread]: Flushing usage events
[0m20:28:02.990640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d9400>]}


============================== 20:28:02.993281 | 939f25dd-3d07-4a33-8f68-237d693a2e98 ==============================
[0m20:28:02.993281 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:28:02.993573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:03.057059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '939f25dd-3d07-4a33-8f68-237d693a2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108673590>]}
[0m20:28:03.067017 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10791813, "process_user_time": 0.572122, "process_kernel_time": 0.095438, "process_mem_max_rss": "94519296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:28:03.067248 [debug] [MainThread]: Command `dbt clean` succeeded at 20:28:03.067209 after 0.11 seconds
[0m20:28:03.067404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080208f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f808c0>]}
[0m20:28:03.067554 [debug] [MainThread]: Flushing usage events
[0m20:29:12.208108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106666120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6d460>]}


============================== 20:29:12.210656 | 2d4984f9-0d7f-4b96-a827-6ede6979fbcf ==============================
[0m20:29:12.210656 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:12.210961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:12.276042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4984f9-0d7f-4b96-a827-6ede6979fbcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061170b0>]}
[0m20:29:12.287407 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11138317, "process_user_time": 0.573303, "process_kernel_time": 0.091259, "process_mem_max_rss": "95567872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:12.287728 [debug] [MainThread]: Command `dbt clean` succeeded at 20:29:12.287685 after 0.11 seconds
[0m20:29:12.287892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105983f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94c20>]}
[0m20:29:12.288039 [debug] [MainThread]: Flushing usage events
[0m20:29:14.618786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5d910>]}


============================== 20:29:14.620703 | 2d4dcdfc-e2c7-48a2-9bff-6d62ef32f8e2 ==============================
[0m20:29:14.620703 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:14.620979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:29:15.112652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4dcdfc-e2c7-48a2-9bff-6d62ef32f8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34dbb0>]}
[0m20:29:15.133633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d4dcdfc-e2c7-48a2-9bff-6d62ef32f8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c854650>]}
[0m20:29:15.134152 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:29:15.144417 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:29:15.144914 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:29:15.145096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d4dcdfc-e2c7-48a2-9bff-6d62ef32f8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8b830>]}
[0m20:29:15.576077 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:29:15.576404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d4dcdfc-e2c7-48a2-9bff-6d62ef32f8e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca0de80>]}
[0m20:29:15.651220 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_changes' (models/output/daily_changes.sql) depends on a node named 'custom_daily_weather_view' which was not found
[0m20:29:15.652295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0614585, "process_user_time": 1.286392, "process_kernel_time": 0.163045, "process_mem_max_rss": "166232064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:15.652578 [debug] [MainThread]: Command `dbt run` failed at 20:29:15.652534 after 1.06 seconds
[0m20:29:15.652759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb22180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca575f0>]}
[0m20:29:15.652899 [debug] [MainThread]: Flushing usage events
[0m20:29:49.895622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875370>]}


============================== 20:29:49.897586 | 4a1483d5-d030-494b-ab93-19999c2b067f ==============================
[0m20:29:49.897586 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:49.897883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m20:29:49.974945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1483d5-d030-494b-ab93-19999c2b067f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638e750>]}
[0m20:29:49.980155 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.113063544, "process_user_time": 0.567449, "process_kernel_time": 0.08807, "process_mem_max_rss": "94289920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:49.980452 [debug] [MainThread]: Command `dbt clean` succeeded at 20:29:49.980416 after 0.11 seconds
[0m20:29:49.980598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a20e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295910>]}
[0m20:29:49.980732 [debug] [MainThread]: Flushing usage events
[0m20:29:52.176282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f4d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f57c0>]}


============================== 20:29:52.178151 | fb59951d-15e4-4aaf-8104-a05781a14b93 ==============================
[0m20:29:52.178151 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:52.178434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:29:52.496575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb59951d-15e4-4aaf-8104-a05781a14b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084aac00>]}
[0m20:29:52.518197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb59951d-15e4-4aaf-8104-a05781a14b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f7830>]}
[0m20:29:52.518603 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:29:52.526588 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:29:52.527073 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:29:52.527250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb59951d-15e4-4aaf-8104-a05781a14b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6c170>]}
[0m20:29:53.021168 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_changes' (models/output/daily_changes.sql) depends on a node named 'custom_daily_weather_view' which was not found
[0m20:29:53.022244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.87347794, "process_user_time": 1.278369, "process_kernel_time": 0.145464, "process_mem_max_rss": "164233216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:53.022525 [debug] [MainThread]: Command `dbt run` failed at 20:29:53.022480 after 0.87 seconds
[0m20:29:53.022712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855aff0>]}
[0m20:29:53.022860 [debug] [MainThread]: Flushing usage events
[0m20:30:32.769897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ff75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104615940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104615640>]}


============================== 20:30:32.771848 | 86fba1da-2504-4ba2-9718-42c1fb8f5576 ==============================
[0m20:30:32.771848 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:30:32.772128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:30:33.082831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86fba1da-2504-4ba2-9718-42c1fb8f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083089b0>]}
[0m20:30:33.103949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86fba1da-2504-4ba2-9718-42c1fb8f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104648a70>]}
[0m20:30:33.104331 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:30:33.112364 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:30:33.112844 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:30:33.113017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86fba1da-2504-4ba2-9718-42c1fb8f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c92660>]}
[0m20:30:33.628188 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.proj.daily_changes' (models/output/daily_changes.sql) depends on a node named 'custom_daily_weather_view' which was not found
[0m20:30:33.629287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8874969, "process_user_time": 1.285438, "process_kernel_time": 0.157066, "process_mem_max_rss": "164806656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:33.629560 [debug] [MainThread]: Command `dbt run` failed at 20:30:33.629515 after 0.89 seconds
[0m20:30:33.629740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104615940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085372c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c8dd0>]}
[0m20:30:33.629885 [debug] [MainThread]: Flushing usage events
[0m20:32:42.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104685730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104685400>]}


============================== 20:32:42.152948 | 820b4885-9fd1-4673-a202-f448dd8b825d ==============================
[0m20:32:42.152948 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:32:42.153229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:42.224701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '820b4885-9fd1-4673-a202-f448dd8b825d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e719d0>]}
[0m20:32:42.229888 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.108939834, "process_user_time": 0.572455, "process_kernel_time": 0.092456, "process_mem_max_rss": "96370688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:42.230188 [debug] [MainThread]: Command `dbt clean` succeeded at 20:32:42.230151 after 0.11 seconds
[0m20:32:42.230335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ffce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ad20>]}
[0m20:32:42.230470 [debug] [MainThread]: Flushing usage events
[0m20:32:46.390903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108645130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108919b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089198b0>]}


============================== 20:32:46.392840 | 77548e4e-7605-4044-8f5e-b271c5a1a3fe ==============================
[0m20:32:46.392840 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:32:46.393122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:46.722812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc070b0>]}
[0m20:32:46.743940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846c230>]}
[0m20:32:46.744290 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:32:46.752609 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:32:46.753069 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:32:46.753245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b130200>]}
[0m20:32:47.284338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9bc320>]}
[0m20:32:47.327980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbec530>]}
[0m20:32:47.328203 [info ] [MainThread]: Found 5 models, 2 data tests, 2 sources, 459 macros
[0m20:32:47.328362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ce1b0>]}
[0m20:32:47.329176 [info ] [MainThread]: 
[0m20:32:47.329434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:32:47.331320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:32:47.337046 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:32:47.337200 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:32:47.337316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:47.894336 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.557 seconds
[0m20:32:47.897514 [debug] [ThreadPool]: On list_weather: Close
[0m20:32:48.027729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:32:48.040977 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:32:48.041415 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:32:48.041705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:48.534005 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.492 seconds
[0m20:32:48.539269 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:32:48.667509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f2480>]}
[0m20:32:48.668099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:48.668421 [info ] [MainThread]: 
[0m20:32:48.671516 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:32:48.671948 [info ] [Thread-1 (]: 1 of 5 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m20:32:48.672301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:32:48.672573 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:32:48.679162 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:32:48.680139 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:32:48.699242 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:32:48.700065 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:32:48.700276 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:32:48.700458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:49.788490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.087 seconds
[0m20:32:49.814341 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:32:49.942094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ce420>]}
[0m20:32:49.943232 [info ] [Thread-1 (]: 1 of 5 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.27s]
[0m20:32:49.944057 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:32:49.945143 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:32:49.945799 [info ] [Thread-1 (]: 2 of 5 START sql table model data.daily_changes ................................ [RUN]
[0m20:32:49.946319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.daily_changes)
[0m20:32:49.946707 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m20:32:49.950207 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m20:32:49.951130 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m20:32:49.969571 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m20:32:49.970990 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m20:32:49.971294 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m20:32:49.971572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:51.113901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.142 seconds
[0m20:32:51.118931 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m20:32:51.239970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce06ea0>]}
[0m20:32:51.240972 [info ] [Thread-1 (]: 2 of 5 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.29s]
[0m20:32:51.241479 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:32:51.241839 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:32:51.242308 [info ] [Thread-1 (]: 3 of 5 START sql table model data.pressure_drops ............................... [RUN]
[0m20:32:51.242724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.pressure_drops)
[0m20:32:51.243024 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m20:32:51.246875 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m20:32:51.247438 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m20:32:51.249291 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m20:32:51.250361 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m20:32:51.250644 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY datetime) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m20:32:51.250909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:52.343099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m20:32:52.348026 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m20:32:52.471873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f6720>]}
[0m20:32:52.473122 [info ] [Thread-1 (]: 3 of 5 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.23s]
[0m20:32:52.473923 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:32:52.474497 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:32:52.475112 [info ] [Thread-1 (]: 4 of 5 START sql table model data.solar_efficiency ............................. [RUN]
[0m20:32:52.475652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m20:32:52.476053 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m20:32:52.479953 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m20:32:52.480921 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m20:32:52.483723 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m20:32:52.484955 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m20:32:52.485349 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m20:32:52.485693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:53.369026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m20:32:53.375370 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m20:32:53.494637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca42e10>]}
[0m20:32:53.496845 [info ] [Thread-1 (]: 4 of 5 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m20:32:53.497912 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:32:53.498307 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:32:53.498778 [info ] [Thread-1 (]: 5 of 5 START sql table model data.temperature_range ............................ [RUN]
[0m20:32:53.499206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m20:32:53.499509 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m20:32:53.502207 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m20:32:53.502828 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m20:32:53.504941 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m20:32:53.505850 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m20:32:53.506124 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m20:32:53.506374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:54.595279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m20:32:54.600467 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m20:32:54.714719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77548e4e-7605-4044-8f5e-b271c5a1a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce0aa20>]}
[0m20:32:54.716798 [info ] [Thread-1 (]: 5 of 5 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.22s]
[0m20:32:54.718005 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:32:54.719368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:54.719733 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m20:32:54.720157 [info ] [MainThread]: 
[0m20:32:54.720524 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m20:32:54.721848 [debug] [MainThread]: Command end result
[0m20:32:54.746863 [info ] [MainThread]: 
[0m20:32:54.747156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:54.747357 [info ] [MainThread]: 
[0m20:32:54.747567 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:32:54.749417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.388095, "process_user_time": 1.987984, "process_kernel_time": 0.211708, "process_mem_max_rss": "177094656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:54.749786 [debug] [MainThread]: Command `dbt run` succeeded at 20:32:54.749727 after 8.39 seconds
[0m20:32:54.750020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9e5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf9a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc3c560>]}
[0m20:32:54.750239 [debug] [MainThread]: Flushing usage events
[0m20:51:12.901024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074717f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074714f0>]}


============================== 20:51:12.903769 | d14808b2-e450-4c74-81d0-cc2219ac7b22 ==============================
[0m20:51:12.903769 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:51:12.904090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:13.430364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc38d70>]}
[0m20:51:13.451583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b03b0>]}
[0m20:51:13.452131 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:51:13.462140 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:51:13.525206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:51:13.525477 [debug] [MainThread]: Partial parsing: added file: proj://models/output/cumulative_precipitation.sql
[0m20:51:13.525617 [debug] [MainThread]: Partial parsing: added file: proj://models/output/daylight_duration.sql
[0m20:51:13.621869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52da60>]}
[0m20:51:13.666509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6511c0>]}
[0m20:51:13.666728 [info ] [MainThread]: Found 7 models, 2 data tests, 2 sources, 459 macros
[0m20:51:13.666890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c551340>]}
[0m20:51:13.667746 [info ] [MainThread]: 
[0m20:51:13.668000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:13.669922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:51:13.675807 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:51:13.675954 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:51:13.676078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:14.290984 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.615 seconds
[0m20:51:14.294794 [debug] [ThreadPool]: On list_weather: Close
[0m20:51:14.423360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m20:51:14.435466 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m20:51:14.435880 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m20:51:14.436166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:14.873508 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.437 seconds
[0m20:51:14.880306 [debug] [ThreadPool]: On list_weather_data: Close
[0m20:51:15.006307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1b4c80>]}
[0m20:51:15.007526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:15.008034 [info ] [MainThread]: 
[0m20:51:15.012314 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m20:51:15.013238 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m20:51:15.014099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m20:51:15.014676 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m20:51:15.024025 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m20:51:15.025015 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m20:51:15.047811 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m20:51:15.048644 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m20:51:15.048891 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m20:51:15.049104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:16.334999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m20:51:16.365709 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m20:51:16.511326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c046480>]}
[0m20:51:16.512191 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.50s]
[0m20:51:16.512931 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m20:51:16.514055 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m20:51:16.514566 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m20:51:16.514952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m20:51:16.515270 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m20:51:16.518114 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m20:51:16.518835 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m20:51:16.537493 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m20:51:16.538515 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m20:51:16.538781 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m20:51:16.539014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:18.072990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.533 seconds
[0m20:51:18.078087 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m20:51:18.200365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cacd400>]}
[0m20:51:18.201384 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.69s]
[0m20:51:18.202120 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m20:51:18.202617 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m20:51:18.203310 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m20:51:18.203947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m20:51:18.204390 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m20:51:18.208198 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m20:51:18.209784 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m20:51:18.212462 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m20:51:18.213936 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m20:51:18.214284 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m20:51:18.214626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:19.815431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.600 seconds
[0m20:51:19.821031 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m20:51:19.961933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66f170>]}
[0m20:51:19.964131 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.76s]
[0m20:51:19.965358 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m20:51:19.965894 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m20:51:19.966558 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m20:51:19.967136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m20:51:19.967567 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m20:51:19.970830 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m20:51:19.971562 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m20:51:19.974077 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m20:51:19.975154 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m20:51:19.975491 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        sunrise, 
        sunset,
        DATEDIFF('second', sunrise, sunset) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise, 
    sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m20:51:19.975786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:21.967240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.991 seconds
[0m20:51:21.973571 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m20:51:22.123597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac7680>]}
[0m20:51:22.124952 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 2.16s]
[0m20:51:22.125789 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m20:51:22.126298 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m20:51:22.126972 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m20:51:22.127636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m20:51:22.128082 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m20:51:22.131988 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m20:51:22.132782 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m20:51:22.135422 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m20:51:22.136923 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m20:51:22.137307 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        sealevelpressure, 
        LAG(sealevelpressure) OVER (ORDER BY datetime) AS prev_pressure,
        (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (sealevelpressure - LAG(sealevelpressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sealevelpressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m20:51:22.137639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:23.296708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.159 seconds
[0m20:51:23.302404 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m20:51:23.414628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caad250>]}
[0m20:51:23.415962 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.29s]
[0m20:51:23.416831 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m20:51:23.417454 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m20:51:23.418129 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m20:51:23.418710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m20:51:23.419141 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m20:51:23.422671 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m20:51:23.423310 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m20:51:23.427504 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m20:51:23.428658 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m20:51:23.429046 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m20:51:23.429404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:25.445134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.015 seconds
[0m20:51:25.452085 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m20:51:25.582597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf0c890>]}
[0m20:51:25.583973 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 2.16s]
[0m20:51:25.584874 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m20:51:25.585502 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m20:51:25.586255 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m20:51:25.586918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m20:51:25.587433 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m20:51:25.592795 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m20:51:25.593734 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m20:51:25.597188 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m20:51:25.598709 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m20:51:25.599178 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m20:51:25.599591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:26.984122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m20:51:26.988396 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m20:51:27.109196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14808b2-e450-4c74-81d0-cc2219ac7b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b23980>]}
[0m20:51:27.110601 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.52s]
[0m20:51:27.111485 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m20:51:27.113305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:27.113724 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m20:51:27.114238 [info ] [MainThread]: 
[0m20:51:27.114638 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 13.45 seconds (13.45s).
[0m20:51:27.116540 [debug] [MainThread]: Command end result
[0m20:51:27.144499 [info ] [MainThread]: 
[0m20:51:27.144850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:27.145067 [info ] [MainThread]: 
[0m20:51:27.145293 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:51:27.147894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.281869, "process_user_time": 1.792805, "process_kernel_time": 0.276614, "process_mem_max_rss": "178356224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:51:27.148441 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:27.148373 after 14.28 seconds
[0m20:51:27.148728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070dadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf56390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074716d0>]}
[0m20:51:27.148951 [debug] [MainThread]: Flushing usage events
[0m22:17:26.213709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10217f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104459b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044597c0>]}


============================== 22:17:26.216605 | 25a73b70-a56f-4bf5-b802-bea95f89e13b ==============================
[0m22:17:26.216605 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:17:26.216931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'profiles_dir': '/Users/gayatripatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:26.771609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108209370>]}
[0m22:17:26.792780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044373e0>]}
[0m22:17:26.793316 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:17:26.803213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:17:26.868813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m22:17:26.869092 [debug] [MainThread]: Partial parsing: added file: proj://snapshots/snapshot.solar_efficiency.sql
[0m22:17:26.869233 [debug] [MainThread]: Partial parsing: added file: proj://snapshots/snapshot.daylight_duration.sql
[0m22:17:26.869356 [debug] [MainThread]: Partial parsing: added file: proj://snapshots/snapshot.pressure_drops.sql
[0m22:17:26.869472 [debug] [MainThread]: Partial parsing: added file: proj://snapshots/snapshot.temperature_range.sql
[0m22:17:26.869584 [debug] [MainThread]: Partial parsing: added file: proj://snapshots/snapshot.daily_changes.sql
[0m22:17:26.987708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108282240>]}
[0m22:17:27.038485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bdfa0>]}
[0m22:17:27.038716 [info ] [MainThread]: Found 7 models, 2 data tests, 5 snapshots, 2 sources, 459 macros
[0m22:17:27.038883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c41a30>]}
[0m22:17:27.039797 [info ] [MainThread]: 
[0m22:17:27.040057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:27.041872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m22:17:27.047564 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m22:17:27.047713 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m22:17:27.047833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:27.799919 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.752 seconds
[0m22:17:27.805754 [debug] [ThreadPool]: On list_weather: Close
[0m22:17:27.957987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now create_weather_snapshot)
[0m22:17:27.959024 [debug] [ThreadPool]: Creating schema "database: "weather"
schema: "snapshot"
"
[0m22:17:27.967123 [debug] [ThreadPool]: Using snowflake connection "create_weather_snapshot"
[0m22:17:27.967643 [debug] [ThreadPool]: On create_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "create_weather_snapshot"} */
create schema if not exists weather.snapshot
[0m22:17:27.967994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:28.491746 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.523 seconds
[0m22:17:28.495381 [debug] [ThreadPool]: On create_weather_snapshot: Close
[0m22:17:28.675733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_weather_snapshot, now list_weather_snapshot)
[0m22:17:28.684871 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m22:17:28.685157 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m22:17:28.685369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:29.173150 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.488 seconds
[0m22:17:29.176923 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m22:17:29.382469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m22:17:29.385465 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m22:17:29.385836 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m22:17:29.386125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:30.068097 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.682 seconds
[0m22:17:30.074407 [debug] [ThreadPool]: On list_weather_data: Close
[0m22:17:30.241325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081524b0>]}
[0m22:17:30.242051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:30.242429 [info ] [MainThread]: 
[0m22:17:30.245648 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m22:17:30.246178 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m22:17:30.246577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m22:17:30.246908 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m22:17:30.255109 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m22:17:30.301710 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m22:17:30.301943 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.daily_changes
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:30.302127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:31.547608 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.245 seconds
[0m22:17:31.557054 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m22:17:31.557526 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:31.662577 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m22:17:31.664449 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m22:17:31.668711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m22:17:31.669234 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace transient table weather.snapshot.snapshot_daily_changes
         as
        (
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.daily_changes
    ) sbq



        );
[0m22:17:32.802548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.132 seconds
[0m22:17:32.830063 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m22:17:32.978333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810e1b0>]}
[0m22:17:32.979518 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 1[0m in 2.73s]
[0m22:17:32.980303 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m22:17:32.980770 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m22:17:32.981378 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m22:17:32.981901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m22:17:32.982279 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m22:17:32.987287 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m22:17:32.990983 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m22:17:32.991357 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.daylight_duration
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:32.991688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:33.802555 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.810 seconds
[0m22:17:33.806632 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m22:17:33.807739 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:34.025769 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.217 seconds
[0m22:17:34.027784 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m22:17:34.031002 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m22:17:34.031579 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace transient table weather.snapshot.snapshot_daylight_duration
         as
        (
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.daylight_duration
    ) sbq



        );
[0m22:17:35.134435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.102 seconds
[0m22:17:35.138289 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m22:17:35.286899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6210>]}
[0m22:17:35.288016 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 1[0m in 2.30s]
[0m22:17:35.288754 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m22:17:35.289240 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m22:17:35.289878 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m22:17:35.290433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m22:17:35.290858 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m22:17:35.294657 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m22:17:35.298551 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m22:17:35.298971 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.pressure_drops
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:35.299344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:35.840614 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.541 seconds
[0m22:17:35.844915 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m22:17:35.846041 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:35.923160 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m22:17:35.924897 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m22:17:35.927964 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m22:17:35.928590 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace transient table weather.snapshot.snapshot_pressure_drops
         as
        (
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.pressure_drops
    ) sbq



        );
[0m22:17:36.875488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m22:17:36.882454 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m22:17:37.058259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a29c0>]}
[0m22:17:37.059304 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 1[0m in 1.77s]
[0m22:17:37.060021 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m22:17:37.060515 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m22:17:37.061142 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m22:17:37.061713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m22:17:37.062155 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m22:17:37.065937 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m22:17:37.069723 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m22:17:37.070077 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.solar_efficiency
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:37.070396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:37.712497 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.642 seconds
[0m22:17:37.716448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m22:17:37.717542 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:37.869680 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m22:17:37.871656 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m22:17:37.874507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m22:17:37.874951 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace transient table weather.snapshot.snapshot_solar_efficiency
         as
        (
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.solar_efficiency
    ) sbq



        );
[0m22:17:38.817516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.942 seconds
[0m22:17:38.824305 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m22:17:38.980463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f7c50>]}
[0m22:17:38.981516 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 1[0m in 1.92s]
[0m22:17:38.982223 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m22:17:38.982710 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m22:17:38.983336 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m22:17:38.983879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m22:17:38.984296 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m22:17:38.989387 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m22:17:38.993312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m22:17:38.993727 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.temperature_range
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:38.994098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:39.945850 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.951 seconds
[0m22:17:39.949838 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m22:17:39.950939 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m22:17:40.140245 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.188 seconds
[0m22:17:40.142253 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m22:17:40.145214 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m22:17:40.145833 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace transient table weather.snapshot.snapshot_temperature_range
         as
        (
    

    select *,
        md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id,
        datetime as dbt_updated_at,
        datetime as dbt_valid_from,
        
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to

    from (
        

SELECT * FROM weather.data.temperature_range
    ) sbq



        );
[0m22:17:41.277705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.131 seconds
[0m22:17:41.282668 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m22:17:41.429141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25a73b70-a56f-4bf5-b802-bea95f89e13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cc8380>]}
[0m22:17:41.431798 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 1[0m in 2.44s]
[0m22:17:41.432406 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m22:17:41.433466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:41.433709 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m22:17:41.433950 [info ] [MainThread]: 
[0m22:17:41.434175 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 14.39 seconds (14.39s).
[0m22:17:41.435000 [debug] [MainThread]: Command end result
[0m22:17:41.455812 [info ] [MainThread]: 
[0m22:17:41.456067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:41.456238 [info ] [MainThread]: 
[0m22:17:41.456395 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:17:41.458341 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.281537, "process_user_time": 1.957657, "process_kernel_time": 0.317591, "process_mem_max_rss": "177356800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:41.458670 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:17:41.458617 after 15.28 seconds
[0m22:17:41.458887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f588f0>]}
[0m22:17:41.459073 [debug] [MainThread]: Flushing usage events
[0m22:23:30.998676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105231c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65730>]}


============================== 22:23:31.001261 | b36efcbc-cce4-46f2-a273-c621ee8c7e43 ==============================
[0m22:23:31.001261 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:23:31.001548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:31.466960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c9e50>]}
[0m22:23:31.488029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f21d30>]}
[0m22:23:31.488567 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:23:31.498210 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:23:31.566873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:23:31.567216 [debug] [MainThread]: Partial parsing: updated file: proj://models/schema.yml
[0m22:23:31.719395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11b980>]}
[0m22:23:31.774500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4506b0>]}
[0m22:23:31.774727 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m22:23:31.774884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a423ce0>]}
[0m22:23:31.775758 [info ] [MainThread]: 
[0m22:23:31.776013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:31.778028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m22:23:31.784741 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m22:23:31.784894 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m22:23:31.785015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:32.414410 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.629 seconds
[0m22:23:32.420947 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m22:23:32.549376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m22:23:32.555653 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m22:23:32.556141 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m22:23:32.556529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:33.122826 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.566 seconds
[0m22:23:33.127165 [debug] [ThreadPool]: On list_weather_data: Close
[0m22:23:33.283199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b36efcbc-cce4-46f2-a273-c621ee8c7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b5190>]}
[0m22:23:33.283877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:33.284182 [info ] [MainThread]: 
[0m22:23:33.287067 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m22:23:33.287445 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m22:23:33.287800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m22:23:33.288056 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m22:23:33.300764 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m22:23:33.301442 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m22:23:33.313483 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m22:23:33.314137 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m22:23:33.314367 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m22:23:33.314582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:33.914558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m22:23:33.925564 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m22:23:34.051775 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.76s]
[0m22:23:34.053042 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m22:23:34.053762 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m22:23:34.054420 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m22:23:34.055047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m22:23:34.055505 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m22:23:34.065166 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m22:23:34.066126 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m22:23:34.068684 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m22:23:34.069811 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m22:23:34.070205 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m22:23:34.070579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:34.663469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m22:23:34.667913 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m22:23:34.811777 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.76s]
[0m22:23:34.813208 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m22:23:34.815321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:34.815752 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m22:23:34.816217 [info ] [MainThread]: 
[0m22:23:34.816695 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m22:23:34.817815 [debug] [MainThread]: Command end result
[0m22:23:34.849585 [info ] [MainThread]: 
[0m22:23:34.849998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:34.850212 [info ] [MainThread]: 
[0m22:23:34.850425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:23:34.852539 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.8858368, "process_user_time": 1.442916, "process_kernel_time": 0.238631, "process_mem_max_rss": "182796288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:23:34.852940 [debug] [MainThread]: Command `dbt test` succeeded at 22:23:34.852878 after 3.89 seconds
[0m22:23:34.853190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059af560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f658e0>]}
[0m22:23:34.853412 [debug] [MainThread]: Flushing usage events
[0m07:51:42.611356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99952990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99958d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9990f260>]}


============================== 07:51:42.615155 | ffa687e8-19e3-48f2-b313-b2cf23098d38 ==============================
[0m07:51:42.615155 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:51:42.615772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:51:42.634590 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'proj'
[0m07:51:42.635473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.046106458, "process_user_time": 1.058754, "process_kernel_time": 0.113187, "process_mem_max_rss": "156120", "process_out_blocks": "2186", "command_success": false, "process_in_blocks": "0"}
[0m07:51:42.635790 [debug] [MainThread]: Command `dbt run` failed at 07:51:42.635745 after 0.05 seconds
[0m07:51:42.636038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c54320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99958d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99add0a0>]}
[0m07:51:42.636303 [debug] [MainThread]: Flushing usage events
[0m07:56:01.707793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98064e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d8d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ed2a80>]}


============================== 07:56:01.712084 | bcb1df22-c572-4b1e-a6c7-323003a8f9b7 ==============================
[0m07:56:01.712084 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:56:01.712705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:56:02.159032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96be3020>]}
[0m07:56:02.182206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f061e0>]}
[0m07:56:02.182679 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:56:02.230113 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:56:02.285956 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:56:02.286484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b6cbc0>]}
[0m07:56:02.875426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7697e0f0>]}
[0m07:56:02.932490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b5bf80>]}
[0m07:56:02.932806 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m07:56:02.933261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b6ddc0>]}
[0m07:56:02.934371 [info ] [MainThread]: 
[0m07:56:02.934870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:56:02.937018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m07:56:02.943058 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m07:56:02.943318 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m07:56:02.943549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:03.666367 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.723 seconds
[0m07:56:03.670789 [debug] [ThreadPool]: On list_weather: Close
[0m07:56:03.786423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m07:56:03.793340 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m07:56:03.793724 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m07:56:03.794014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:04.229733 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.435 seconds
[0m07:56:04.234485 [debug] [ThreadPool]: On list_weather_data: Close
[0m07:56:04.348795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m07:56:04.352620 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m07:56:04.353091 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m07:56:04.353500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:04.788584 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.435 seconds
[0m07:56:04.792812 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m07:56:04.929566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ce4860>]}
[0m07:56:04.930669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:04.932878 [info ] [MainThread]: 
[0m07:56:04.945694 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m07:56:04.946470 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m07:56:04.947336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m07:56:04.947811 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m07:56:04.954549 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m07:56:04.957723 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m07:56:04.976310 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m07:56:04.977878 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m07:56:04.978191 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m07:56:04.978540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:05.651656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m07:56:05.676122 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m07:56:05.813896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97706060>]}
[0m07:56:05.815025 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 0.86s]
[0m07:56:05.816504 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m07:56:05.817948 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m07:56:05.818819 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m07:56:05.819673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m07:56:05.820207 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m07:56:05.823276 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m07:56:05.825531 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m07:56:05.842641 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m07:56:05.844569 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m07:56:05.844951 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m07:56:05.845309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:06.887407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m07:56:06.892386 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m07:56:07.018747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ae5f40>]}
[0m07:56:07.021138 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.20s]
[0m07:56:07.024525 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m07:56:07.025387 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m07:56:07.026310 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m07:56:07.027866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m07:56:07.028715 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m07:56:07.033350 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m07:56:07.035259 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m07:56:07.038097 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m07:56:07.040568 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m07:56:07.041045 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m07:56:07.041497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:08.216708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.175 seconds
[0m07:56:08.221957 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m07:56:08.338715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7590f890>]}
[0m07:56:08.340581 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.31s]
[0m07:56:08.343826 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m07:56:08.344771 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m07:56:08.345789 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m07:56:08.347015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m07:56:08.347948 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m07:56:08.352669 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m07:56:08.354739 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m07:56:08.357589 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m07:56:08.359596 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m07:56:08.360138 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        sunrise, 
        sunset,
        DATEDIFF('second', sunrise, sunset) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise, 
    sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m07:56:08.360704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:09.442607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.081 seconds
[0m07:56:09.446442 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m07:56:09.590792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75996f60>]}
[0m07:56:09.592854 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.24s]
[0m07:56:09.595535 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m07:56:09.596500 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m07:56:09.597589 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m07:56:09.598807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m07:56:09.599375 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m07:56:09.604956 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m07:56:09.607976 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m07:56:09.613201 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m07:56:09.615216 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m07:56:09.615749 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m07:56:09.616262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:10.573355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.956 seconds
[0m07:56:10.579956 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m07:56:10.687659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff759aabd0>]}
[0m07:56:10.689264 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.09s]
[0m07:56:10.690864 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m07:56:10.691685 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m07:56:10.692486 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m07:56:10.693403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m07:56:10.693935 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m07:56:10.698497 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m07:56:10.700085 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m07:56:10.702967 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m07:56:10.704700 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m07:56:10.705189 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m07:56:10.708542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:11.697998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.989 seconds
[0m07:56:11.703116 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m07:56:11.835105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ca47d0>]}
[0m07:56:11.836523 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m07:56:11.837950 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m07:56:11.838845 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m07:56:11.839724 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m07:56:11.840815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m07:56:11.841348 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m07:56:11.845050 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m07:56:11.846693 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m07:56:11.849286 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m07:56:11.850935 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m07:56:11.851387 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m07:56:11.851797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:13.030054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.178 seconds
[0m07:56:13.034955 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m07:56:13.156718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb1df22-c572-4b1e-a6c7-323003a8f9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7590e690>]}
[0m07:56:13.159004 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.31s]
[0m07:56:13.161346 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m07:56:13.164318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:13.165297 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m07:56:13.166228 [info ] [MainThread]: 
[0m07:56:13.167421 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m07:56:13.169598 [debug] [MainThread]: Command end result
[0m07:56:13.208081 [info ] [MainThread]: 
[0m07:56:13.208593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:13.209013 [info ] [MainThread]: 
[0m07:56:13.209389 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m07:56:13.210646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.542877, "process_user_time": 3.366969, "process_kernel_time": 0.31512, "process_mem_max_rss": "212752", "process_out_blocks": "4403", "process_in_blocks": "0"}
[0m07:56:13.211097 [debug] [MainThread]: Command `dbt run` succeeded at 07:56:13.211037 after 11.54 seconds
[0m07:56:13.211510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98064e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fb24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fb2420>]}
[0m07:56:13.211830 [debug] [MainThread]: Flushing usage events
[0m07:56:15.637927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3be1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d17d40>]}


============================== 07:56:15.641517 | f24030a8-dc60-4dd8-884e-053e3e1bddd4 ==============================
[0m07:56:15.641517 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:56:15.642167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m07:56:16.067612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08800b0>]}
[0m07:56:16.089063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f57b90>]}
[0m07:56:16.089511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:56:16.132570 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:56:16.203093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:16.203413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:16.225521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bba060>]}
[0m07:56:16.288851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846b3710>]}
[0m07:56:16.289192 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m07:56:16.289688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bda1e0>]}
[0m07:56:16.290601 [info ] [MainThread]: 
[0m07:56:16.290992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:56:16.293206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m07:56:16.301123 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m07:56:16.301386 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m07:56:16.301648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:16.797658 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.496 seconds
[0m07:56:16.803075 [debug] [ThreadPool]: On list_weather_data: Close
[0m07:56:16.976670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m07:56:16.983670 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m07:56:16.984445 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m07:56:16.984987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:17.439680 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.455 seconds
[0m07:56:17.441857 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m07:56:17.553435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24030a8-dc60-4dd8-884e-053e3e1bddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d00320>]}
[0m07:56:17.554048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:17.555093 [info ] [MainThread]: 
[0m07:56:17.562680 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m07:56:17.563127 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m07:56:17.563699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m07:56:17.564026 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m07:56:17.573872 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m07:56:17.576466 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m07:56:17.586613 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m07:56:17.587828 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m07:56:17.588097 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m07:56:17.588524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:18.079247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m07:56:18.087111 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m07:56:18.189803 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.63s]
[0m07:56:18.191245 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m07:56:18.191676 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m07:56:18.192103 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m07:56:18.192624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m07:56:18.192900 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m07:56:18.197307 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m07:56:18.198383 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m07:56:18.199688 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m07:56:18.200794 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m07:56:18.201057 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m07:56:18.201339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:18.723902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m07:56:18.730140 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m07:56:18.850664 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.66s]
[0m07:56:18.853785 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m07:56:18.858387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:18.859057 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m07:56:18.859931 [info ] [MainThread]: 
[0m07:56:18.861189 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m07:56:18.862650 [debug] [MainThread]: Command end result
[0m07:56:18.909881 [info ] [MainThread]: 
[0m07:56:18.911543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:18.914078 [info ] [MainThread]: 
[0m07:56:18.915422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:56:18.919643 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.320074, "process_user_time": 2.301667, "process_kernel_time": 0.202146, "process_mem_max_rss": "208528", "process_out_blocks": "1943", "process_in_blocks": "0"}
[0m07:56:18.920240 [debug] [MainThread]: Command `dbt test` succeeded at 07:56:18.920172 after 3.32 seconds
[0m07:56:18.920746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3be1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa296f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a30440>]}
[0m07:56:18.921148 [debug] [MainThread]: Flushing usage events
[0m07:56:21.678880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae591be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae592ba0>]}


============================== 07:56:21.682533 | 25337d40-70cb-4fa4-b41e-abc75446b61d ==============================
[0m07:56:21.682533 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:56:21.683231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:56:22.106667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed91fd0>]}
[0m07:56:22.128555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987efc50>]}
[0m07:56:22.129013 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:56:22.171915 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:56:22.243439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:22.243761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:22.265843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca1bb0>]}
[0m07:56:22.322166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9a22d0>]}
[0m07:56:22.322499 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m07:56:22.322968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e766ae0>]}
[0m07:56:22.323977 [info ] [MainThread]: 
[0m07:56:22.324450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:56:22.326743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m07:56:22.333331 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m07:56:22.333572 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m07:56:22.333790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:22.764840 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.431 seconds
[0m07:56:22.768559 [debug] [ThreadPool]: On list_weather: Close
[0m07:56:22.893333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m07:56:22.906073 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m07:56:22.906749 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m07:56:22.907242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:23.310767 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.403 seconds
[0m07:56:23.312574 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m07:56:23.423150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m07:56:23.428076 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m07:56:23.428849 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m07:56:23.429386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:23.866435 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.437 seconds
[0m07:56:23.871637 [debug] [ThreadPool]: On list_weather_data: Close
[0m07:56:24.004712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4a11c0>]}
[0m07:56:24.006524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:24.008317 [info ] [MainThread]: 
[0m07:56:24.022449 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m07:56:24.023470 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m07:56:24.024601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m07:56:24.025125 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m07:56:24.032994 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m07:56:24.066636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:24.066941 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m07:56:24.067200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:24.473763 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.406 seconds
[0m07:56:24.521970 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:24.522513 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:56:25.503406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m07:56:25.511867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:25.513004 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m07:56:25.662506 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.148 seconds
[0m07:56:25.670439 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:25.671690 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m07:56:25.764370 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m07:56:25.768947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:25.769443 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m07:56:25.849260 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.079 seconds
[0m07:56:25.854510 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:25.855308 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m07:56:25.954395 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m07:56:25.967122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:25.967897 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m07:56:26.089218 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.120 seconds
[0m07:56:26.119677 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:26.120544 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:26.393349 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.272 seconds
[0m07:56:26.397048 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:26.397575 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:26.469352 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m07:56:26.470124 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m07:56:26.473882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:26.474434 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m07:56:26.598746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m07:56:26.599471 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:26.600096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:56:27.263061 [debug] [Thread-1 (]: SQL status: SUCCESS 322 in 0.662 seconds
[0m07:56:27.264982 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m07:56:27.265780 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m07:56:27.671695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m07:56:27.698710 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m07:56:27.808471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfd08c0>]}
[0m07:56:27.810429 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 322[0m in 3.78s]
[0m07:56:27.813343 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m07:56:27.814284 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m07:56:27.815239 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m07:56:27.816181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m07:56:27.816708 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m07:56:27.820996 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m07:56:27.825416 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:27.825841 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m07:56:27.826262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:28.197490 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.371 seconds
[0m07:56:28.210494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:28.211453 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:56:29.102229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m07:56:29.106654 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.107274 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m07:56:29.203858 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.096 seconds
[0m07:56:29.215190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.215954 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m07:56:29.301028 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.084 seconds
[0m07:56:29.308023 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.309020 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m07:56:29.398910 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m07:56:29.406291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.407196 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m07:56:29.538024 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.130 seconds
[0m07:56:29.545224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.546108 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m07:56:29.634491 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m07:56:29.641882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:29.642679 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:30.025513 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.382 seconds
[0m07:56:30.029324 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:30.030791 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:30.108556 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m07:56:30.110613 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m07:56:30.114931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:30.115694 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m07:56:30.253365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m07:56:30.254896 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m07:56:30.255762 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:56:30.409846 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8bc1c-0004-3867-0002-62e700020a6e
[0m07:56:30.410716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001010 (42846): SQL compilation error:
incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
[0m07:56:30.411596 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m07:56:30.536597 [debug] [Thread-1 (]: Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m07:56:30.538026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edb2cf0>]}
[0m07:56:30.539684 [error] [Thread-1 (]: 2 of 5 ERROR snapshotting snapshot.snapshot_daylight_duration .................. [[31mERROR[0m in 2.72s]
[0m07:56:30.542483 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m07:56:30.543493 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m07:56:30.545623 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m07:56:30.546559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m07:56:30.547164 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m07:56:30.551796 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m07:56:30.555714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:30.556192 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m07:56:30.556651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:30.990902 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.434 seconds
[0m07:56:30.996855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:30.997371 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:56:31.972523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m07:56:31.978660 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:31.979373 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m07:56:32.058538 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m07:56:32.065634 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.066378 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m07:56:32.179865 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.113 seconds
[0m07:56:32.186820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.187417 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m07:56:32.300408 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m07:56:32.306699 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.307451 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m07:56:32.395992 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m07:56:32.400199 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.400938 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
alter table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" add column "PRESSURE" FLOAT;
[0m07:56:32.577779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m07:56:32.581079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.581626 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m07:56:32.733891 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.152 seconds
[0m07:56:32.743728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:32.744799 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:33.097254 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.351 seconds
[0m07:56:33.100128 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:33.100924 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:33.178926 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m07:56:33.180779 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m07:56:33.185840 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:33.186502 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m07:56:33.287663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m07:56:33.288991 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:33.289843 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:56:33.893474 [debug] [Thread-1 (]: SQL status: SUCCESS 322 in 0.602 seconds
[0m07:56:33.895101 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m07:56:33.895916 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m07:56:34.222145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m07:56:34.224351 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m07:56:34.351265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdaa840>]}
[0m07:56:34.352868 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 322[0m in 3.80s]
[0m07:56:34.355121 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m07:56:34.356073 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m07:56:34.356960 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m07:56:34.357900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m07:56:34.358436 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m07:56:34.362617 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m07:56:34.366468 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:34.366951 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m07:56:34.367393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:34.766578 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.399 seconds
[0m07:56:34.778216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:34.779105 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:56:35.762402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m07:56:35.769212 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:35.770111 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m07:56:35.860634 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m07:56:35.866020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:35.866781 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m07:56:35.992962 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.125 seconds
[0m07:56:36.001217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.002158 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m07:56:36.100151 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m07:56:36.110846 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.111660 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m07:56:36.197488 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.085 seconds
[0m07:56:36.205215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.206068 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m07:56:36.300565 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m07:56:36.308288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.309214 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:36.684795 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.374 seconds
[0m07:56:36.689444 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.690338 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:36.799618 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m07:56:36.801604 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.805550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.806453 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m07:56:36.911827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m07:56:36.913121 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:36.914146 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:56:37.500778 [debug] [Thread-1 (]: SQL status: SUCCESS 322 in 0.586 seconds
[0m07:56:37.502434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m07:56:37.503409 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m07:56:37.913058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m07:56:37.918061 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m07:56:38.037451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceaa4e0>]}
[0m07:56:38.039903 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 322[0m in 3.68s]
[0m07:56:38.042222 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m07:56:38.043055 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m07:56:38.043852 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m07:56:38.045018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m07:56:38.045828 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m07:56:38.050702 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m07:56:38.055539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:38.056136 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m07:56:38.056687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:38.534307 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.477 seconds
[0m07:56:38.541515 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:38.542063 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:56:39.345574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m07:56:39.350571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.351349 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m07:56:39.452597 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m07:56:39.460093 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.461020 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m07:56:39.566853 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m07:56:39.572509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.573287 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m07:56:39.650315 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.076 seconds
[0m07:56:39.656576 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.657334 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m07:56:39.740278 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m07:56:39.748441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.749263 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m07:56:39.837760 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.088 seconds
[0m07:56:39.846942 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:39.847973 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:40.164068 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.315 seconds
[0m07:56:40.276637 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:40.277260 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:56:40.349907 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m07:56:40.350545 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m07:56:40.352030 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:40.352333 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m07:56:40.467603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m07:56:40.468401 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:40.469102 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:56:41.086275 [debug] [Thread-1 (]: SQL status: SUCCESS 322 in 0.616 seconds
[0m07:56:41.088210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m07:56:41.089101 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m07:56:41.320588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m07:56:41.325930 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m07:56:41.436661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25337d40-70cb-4fa4-b41e-abc75446b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dacc170>]}
[0m07:56:41.439227 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 322[0m in 3.39s]
[0m07:56:41.441478 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m07:56:41.444363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:41.445045 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m07:56:41.445627 [info ] [MainThread]: 
[0m07:56:41.446592 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 19.12 seconds (19.12s).
[0m07:56:41.448505 [debug] [MainThread]: Command end result
[0m07:56:41.480117 [info ] [MainThread]: 
[0m07:56:41.480687 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:56:41.481009 [info ] [MainThread]: 
[0m07:56:41.481512 [error] [MainThread]:   Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m07:56:41.481964 [info ] [MainThread]: 
[0m07:56:41.482330 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m07:56:41.483529 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 19.84285, "process_user_time": 3.4015, "process_kernel_time": 0.236825, "process_mem_max_rss": "208404", "process_out_blocks": "2087", "command_success": false, "process_in_blocks": "0"}
[0m07:56:41.483943 [debug] [MainThread]: Command `dbt snapshot` failed at 07:56:41.483888 after 19.84 seconds
[0m07:56:41.484250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2516a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae800f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce41880>]}
[0m07:56:41.484513 [debug] [MainThread]: Flushing usage events
[0m00:02:14.640984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e394f0>]}


============================== 00:02:14.644107 | e23bbfc4-cdd4-447e-acef-a434abced3a0 ==============================
[0m00:02:14.644107 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:14.644403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:02:14.721370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23bbfc4-cdd4-447e-acef-a434abced3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678c740>]}
[0m00:02:14.763197 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15891546, "process_user_time": 0.577676, "process_kernel_time": 0.113363, "process_mem_max_rss": "94470144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:14.763639 [debug] [MainThread]: Command `dbt clean` succeeded at 00:02:14.763586 after 0.16 seconds
[0m00:02:14.763843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056299d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b572c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e39580>]}
[0m00:02:14.764058 [debug] [MainThread]: Flushing usage events
[0m00:02:20.124440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e38b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9490>]}


============================== 00:02:20.126871 | 7d2c19a5-6081-4477-8a2a-929968dd0ef6 ==============================
[0m00:02:20.126871 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:20.127166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gayatripatil/Documents/dwprojects/sjsu-data226/week8/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:20.187798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2c19a5-6081-4477-8a2a-929968dd0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103952f00>]}
[0m00:02:20.197054 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10446037, "process_user_time": 0.581224, "process_kernel_time": 0.100649, "process_mem_max_rss": "95322112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:20.197349 [debug] [MainThread]: Command `dbt clean` succeeded at 00:02:20.197312 after 0.10 seconds
[0m00:02:20.197498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d0710>]}
[0m00:02:20.197633 [debug] [MainThread]: Flushing usage events
[0m08:02:33.893272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e745c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31094f0>]}


============================== 08:02:33.897929 | c886a9b8-3535-42e7-a29a-d314bba0554d ==============================
[0m08:02:33.897929 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:33.900087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:34.334284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa420df10>]}
[0m08:02:34.356070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48555b0>]}
[0m08:02:34.356556 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:02:34.405349 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:34.406129 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:02:34.406666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830702c0>]}
[0m08:02:35.029808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d07d10>]}
[0m08:02:35.095408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8294b650>]}
[0m08:02:35.095745 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:02:35.096249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dafcb0>]}
[0m08:02:35.097279 [info ] [MainThread]: 
[0m08:02:35.097714 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:35.100216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:02:35.110823 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:02:35.111125 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:02:35.111358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:35.655149 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.543 seconds
[0m08:02:35.660428 [debug] [ThreadPool]: On list_weather: Close
[0m08:02:35.770891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m08:02:35.777989 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:02:35.778347 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:02:35.778665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:36.294072 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.515 seconds
[0m08:02:36.299528 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:02:36.418637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:02:36.425380 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:02:36.426080 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:02:36.426639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:36.966522 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.540 seconds
[0m08:02:36.972013 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:02:37.131958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa436f800>]}
[0m08:02:37.133484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:37.137482 [info ] [MainThread]: 
[0m08:02:37.151298 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m08:02:37.152397 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m08:02:37.153278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m08:02:37.153734 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m08:02:37.160637 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m08:02:37.163636 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m08:02:37.188974 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m08:02:37.191448 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m08:02:37.191791 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m08:02:37.192182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:38.263051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m08:02:38.295728 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m08:02:38.438046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8298ec60>]}
[0m08:02:38.439465 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.28s]
[0m08:02:38.441630 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m08:02:38.442801 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m08:02:38.443324 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m08:02:38.444056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m08:02:38.444439 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m08:02:38.447092 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m08:02:38.448912 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m08:02:38.470997 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m08:02:38.472680 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m08:02:38.473017 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m08:02:38.473323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:39.591838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.118 seconds
[0m08:02:39.597698 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m08:02:39.729512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8216f380>]}
[0m08:02:39.731390 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.28s]
[0m08:02:39.733784 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m08:02:39.734762 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m08:02:39.735943 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m08:02:39.737405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m08:02:39.738125 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m08:02:39.742994 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m08:02:39.744943 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m08:02:39.747828 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m08:02:39.750214 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m08:02:39.750713 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m08:02:39.751149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:40.920304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m08:02:40.923252 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m08:02:41.066992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8216faa0>]}
[0m08:02:41.068986 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.33s]
[0m08:02:41.071128 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m08:02:41.071870 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m08:02:41.072639 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m08:02:41.073964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m08:02:41.074714 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m08:02:41.078899 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m08:02:41.080645 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m08:02:41.083331 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m08:02:41.085296 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m08:02:41.085849 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        sunrise, 
        sunset,
        DATEDIFF('second', sunrise, sunset) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise, 
    sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m08:02:41.086360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:42.585369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.498 seconds
[0m08:02:42.591806 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m08:02:42.707145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d13f50>]}
[0m08:02:42.708667 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.63s]
[0m08:02:42.710536 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m08:02:42.711292 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m08:02:42.712028 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m08:02:42.713060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m08:02:42.713640 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m08:02:42.717652 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m08:02:42.719248 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m08:02:42.721625 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m08:02:42.723549 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m08:02:42.724004 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m08:02:42.724404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:43.895348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m08:02:43.901462 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m08:02:44.015525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821e21e0>]}
[0m08:02:44.017548 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.30s]
[0m08:02:44.020066 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m08:02:44.020981 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m08:02:44.021874 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m08:02:44.023113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m08:02:44.023922 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m08:02:44.029146 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m08:02:44.031063 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m08:02:44.034203 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m08:02:44.036774 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m08:02:44.037262 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m08:02:44.037775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:44.971784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m08:02:44.976747 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m08:02:45.099456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82937c20>]}
[0m08:02:45.101026 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.08s]
[0m08:02:45.103191 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m08:02:45.104052 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m08:02:45.104989 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m08:02:45.106249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m08:02:45.106832 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m08:02:45.112257 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m08:02:45.114393 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m08:02:45.117316 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m08:02:45.119117 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m08:02:45.119562 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m08:02:45.119981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:46.554367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.434 seconds
[0m08:02:46.555870 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m08:02:46.676215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c886a9b8-3535-42e7-a29a-d314bba0554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ecd9d0>]}
[0m08:02:46.677524 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.57s]
[0m08:02:46.679454 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m08:02:46.682985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:46.683751 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m08:02:46.684665 [info ] [MainThread]: 
[0m08:02:46.685583 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 11.59 seconds (11.59s).
[0m08:02:46.687726 [debug] [MainThread]: Command end result
[0m08:02:46.726929 [info ] [MainThread]: 
[0m08:02:46.727475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:46.727839 [info ] [MainThread]: 
[0m08:02:46.728221 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:02:46.729936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.875944, "process_user_time": 3.37835, "process_kernel_time": 0.297086, "process_mem_max_rss": "211668", "process_out_blocks": "2939", "process_in_blocks": "0"}
[0m08:02:46.730513 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:46.730421 after 12.88 seconds
[0m08:02:46.730944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cd30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3563320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41f15b0>]}
[0m08:02:46.731240 [debug] [MainThread]: Flushing usage events
[0m08:02:49.194747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fed2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cb20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8425e240>]}


============================== 08:02:49.198447 | e959c7fb-c5f7-43b2-aea7-1771c4bf422a ==============================
[0m08:02:49.198447 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:49.199488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/proj', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:49.609083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e25f10>]}
[0m08:02:49.630410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fe6f6e0>]}
[0m08:02:49.630853 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:02:49.674747 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:49.745895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:49.746200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:49.768316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff642cf380>]}
[0m08:02:49.829733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f72acf0>]}
[0m08:02:49.830061 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:02:49.830572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fc90890>]}
[0m08:02:49.831487 [info ] [MainThread]: 
[0m08:02:49.831928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:49.834166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m08:02:49.842068 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:02:49.842343 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:02:49.842575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:50.447644 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.605 seconds
[0m08:02:50.451544 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:02:50.574541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:02:50.583522 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:02:50.584168 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:02:50.584725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:51.133068 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.548 seconds
[0m08:02:51.138468 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:02:51.257455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e959c7fb-c5f7-43b2-aea7-1771c4bf422a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fd665a0>]}
[0m08:02:51.259432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:51.260403 [info ] [MainThread]: 
[0m08:02:51.275689 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:02:51.276442 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m08:02:51.277385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m08:02:51.277931 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:02:51.293016 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:02:51.294750 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:02:51.308117 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:02:51.309491 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:02:51.309807 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m08:02:51.310135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:51.983034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m08:02:51.999074 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m08:02:52.173329 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.89s]
[0m08:02:52.175302 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:02:52.176113 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:02:52.176852 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m08:02:52.177819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m08:02:52.178614 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:02:52.186295 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:02:52.188052 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:02:52.190216 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:02:52.191817 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:02:52.192283 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:52.192685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:52.702520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m08:02:52.704645 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m08:02:52.828964 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.65s]
[0m08:02:52.831332 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:02:52.833988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:52.834644 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m08:02:52.835399 [info ] [MainThread]: 
[0m08:02:52.836626 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m08:02:52.838937 [debug] [MainThread]: Command end result
[0m08:02:52.875006 [info ] [MainThread]: 
[0m08:02:52.875570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:52.875902 [info ] [MainThread]: 
[0m08:02:52.876292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:02:52.877104 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.721576, "process_user_time": 2.351237, "process_kernel_time": 0.220491, "process_mem_max_rss": "208552", "process_out_blocks": "1943", "process_in_blocks": "0"}
[0m08:02:52.877493 [debug] [MainThread]: Command `dbt test` succeeded at 08:02:52.877425 after 3.72 seconds
[0m08:02:52.877793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f7132c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80624980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80176d20>]}
[0m08:02:52.878098 [debug] [MainThread]: Flushing usage events
[0m08:02:54.788573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dcb42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdc4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8edbe0>]}


============================== 08:02:54.792481 | 9266d6d5-e479-4305-b843-36b06776096d ==============================
[0m08:02:54.792481 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:54.793063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:02:55.180844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b9b050>]}
[0m08:02:55.202680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9060f0>]}
[0m08:02:55.203137 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:02:55.246987 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:55.313335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:55.313633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:55.335565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80eb46b0>]}
[0m08:02:55.389931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8056ad20>]}
[0m08:02:55.390220 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:02:55.390637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80931a00>]}
[0m08:02:55.391637 [info ] [MainThread]: 
[0m08:02:55.392073 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:55.394170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:02:55.400913 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:02:55.401195 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:02:55.401397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:55.935684 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.534 seconds
[0m08:02:55.940999 [debug] [ThreadPool]: On list_weather: Close
[0m08:02:56.086592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m08:02:56.097236 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:02:56.097735 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:02:56.098194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:56.558740 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.460 seconds
[0m08:02:56.560275 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:02:56.674583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:02:56.677360 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:02:56.677655 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:02:56.677923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:57.224782 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.547 seconds
[0m08:02:57.227074 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:02:57.350235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809310d0>]}
[0m08:02:57.350716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:57.351493 [info ] [MainThread]: 
[0m08:02:57.356667 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m08:02:57.357056 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m08:02:57.357514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m08:02:57.357776 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m08:02:57.361612 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m08:02:57.384589 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:57.384929 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:02:57.385179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:57.989093 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.603 seconds
[0m08:02:58.027866 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:58.028348 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:02:58.843390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m08:02:58.848603 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:58.853146 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:02:58.977579 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m08:02:58.982757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:58.983302 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:02:59.091166 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m08:02:59.095216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.095659 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:02:59.184462 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m08:02:59.187981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.188385 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:02:59.277183 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.088 seconds
[0m08:02:59.286072 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.286643 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:02:59.446105 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.159 seconds
[0m08:02:59.475100 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.475946 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:02:59.723102 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m08:02:59.727036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.727668 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:02:59.877423 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.149 seconds
[0m08:02:59.878839 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.881461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:02:59.881910 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m08:03:00.039572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m08:03:00.040960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:03:00.041859 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:03:00.687290 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.644 seconds
[0m08:03:00.689728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:03:00.690501 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m08:03:00.931888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m08:03:00.963068 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m08:03:01.082451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8040c3b0>]}
[0m08:03:01.083946 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 3.72s]
[0m08:03:01.087014 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m08:03:01.087571 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m08:03:01.088249 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m08:03:01.089003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m08:03:01.089447 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m08:03:01.092686 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m08:03:01.095990 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:01.096347 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:03:01.096667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:01.557401 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.461 seconds
[0m08:03:01.562626 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:01.563140 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:03:02.633919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m08:03:02.641509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:02.642543 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:03:02.727244 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m08:03:02.736647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:02.737799 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:03:02.828066 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.089 seconds
[0m08:03:02.831570 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:02.832012 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:03:02.944657 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.112 seconds
[0m08:03:02.951387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:02.952613 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:03:03.048366 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.095 seconds
[0m08:03:03.056081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.057002 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:03:03.152354 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m08:03:03.162388 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.163452 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:03.656522 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.492 seconds
[0m08:03:03.660078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.660968 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:03.748784 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.087 seconds
[0m08:03:03.750373 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.754313 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.755096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m08:03:03.877060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m08:03:03.878360 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:03:03.879137 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:03:04.063993 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8bc23-0004-386b-0002-62e70002e3ce
[0m08:03:04.065302 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001010 (42846): SQL compilation error:
incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
[0m08:03:04.066244 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m08:03:04.177100 [debug] [Thread-1 (]: Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:03:04.178258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80861f70>]}
[0m08:03:04.179638 [error] [Thread-1 (]: 2 of 5 ERROR snapshotting snapshot.snapshot_daylight_duration .................. [[31mERROR[0m in 3.09s]
[0m08:03:04.181371 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m08:03:04.182164 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m08:03:04.183883 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m08:03:04.184783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m08:03:04.185341 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m08:03:04.189684 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m08:03:04.193713 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:04.194217 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:03:04.194668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:04.623472 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.428 seconds
[0m08:03:04.636552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:04.637547 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:03:05.397769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m08:03:05.402993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:05.403871 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:03:05.528007 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.123 seconds
[0m08:03:05.535234 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:05.536145 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:03:05.635399 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m08:03:05.644641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:05.645442 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:03:05.763188 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m08:03:05.770168 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:05.771056 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:03:05.921831 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.150 seconds
[0m08:03:05.926827 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:05.927503 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:03:06.041087 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.113 seconds
[0m08:03:06.048006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:06.048710 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:06.419026 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.369 seconds
[0m08:03:06.421752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:06.422566 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:06.739649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.316 seconds
[0m08:03:06.742537 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m08:03:06.746671 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:06.747349 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m08:03:06.853857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m08:03:06.855521 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:06.856417 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:03:07.441193 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.584 seconds
[0m08:03:07.441809 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:03:07.442196 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m08:03:07.751480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m08:03:07.756716 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m08:03:07.864261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802e6600>]}
[0m08:03:07.866197 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.68s]
[0m08:03:07.868407 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m08:03:07.869313 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m08:03:07.870225 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m08:03:07.871517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m08:03:07.872272 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m08:03:07.876684 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m08:03:07.881158 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:07.881629 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:03:07.882062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:08.387728 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.505 seconds
[0m08:03:08.400862 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:08.401837 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:03:09.395232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m08:03:09.403502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.404487 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:03:09.537215 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.132 seconds
[0m08:03:09.544049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.544907 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:03:09.640997 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.095 seconds
[0m08:03:09.647133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.647945 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:03:09.737412 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m08:03:09.747800 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.748536 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:03:09.848498 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.099 seconds
[0m08:03:09.854451 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.855231 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:03:09.950952 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:03:09.959457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:09.960462 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:10.296917 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.335 seconds
[0m08:03:10.299212 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:10.299875 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:10.382027 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m08:03:10.384034 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:10.388089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:10.388771 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m08:03:10.485238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m08:03:10.486707 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:10.487579 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:03:11.134671 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.646 seconds
[0m08:03:11.136510 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:03:11.137387 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m08:03:11.539858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m08:03:11.544680 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m08:03:11.653906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801d7b90>]}
[0m08:03:11.655096 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 3.78s]
[0m08:03:11.656748 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m08:03:11.657353 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m08:03:11.657974 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m08:03:11.658740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m08:03:11.659158 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m08:03:11.662620 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m08:03:11.665805 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:11.666205 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:03:11.666576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:12.089808 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.423 seconds
[0m08:03:12.096507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:12.097131 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:03:13.081175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.983 seconds
[0m08:03:13.087556 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.088464 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:03:13.186102 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m08:03:13.193933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.194837 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:03:13.330967 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.135 seconds
[0m08:03:13.337651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.338457 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:03:13.495900 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.157 seconds
[0m08:03:13.500012 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.500523 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:03:13.621070 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.120 seconds
[0m08:03:13.628228 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.628746 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:03:13.804157 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.175 seconds
[0m08:03:13.828580 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:13.829413 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:14.070108 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.240 seconds
[0m08:03:14.170550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:14.170999 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:03:14.321820 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.150 seconds
[0m08:03:14.322809 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m08:03:14.325672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:14.326226 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m08:03:14.466495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m08:03:14.467657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:14.468920 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:03:15.023173 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.553 seconds
[0m08:03:15.024565 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:03:15.025434 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m08:03:15.370191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m08:03:15.375577 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m08:03:15.501424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9266d6d5-e479-4305-b843-36b06776096d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80679340>]}
[0m08:03:15.504049 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.84s]
[0m08:03:15.507626 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m08:03:15.510826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:15.511558 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m08:03:15.512290 [info ] [MainThread]: 
[0m08:03:15.513508 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 20.12 seconds (20.12s).
[0m08:03:15.515347 [debug] [MainThread]: Command end result
[0m08:03:15.551861 [info ] [MainThread]: 
[0m08:03:15.552424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:03:15.552889 [info ] [MainThread]: 
[0m08:03:15.553303 [error] [MainThread]:   Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:03:15.553665 [info ] [MainThread]: 
[0m08:03:15.553996 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:03:15.555198 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 20.805195, "process_user_time": 3.279968, "process_kernel_time": 0.194182, "process_mem_max_rss": "208552", "process_out_blocks": "2086", "command_success": false, "process_in_blocks": "0"}
[0m08:03:15.555588 [debug] [MainThread]: Command `dbt snapshot` failed at 08:03:15.555527 after 20.81 seconds
[0m08:03:15.555909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa100aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da67e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802d2270>]}
[0m08:03:15.556229 [debug] [MainThread]: Flushing usage events
[0m08:16:40.411626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fc4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5970c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60cb890>]}


============================== 08:16:40.415813 | b2450b5f-6607-4d09-ab8f-f855a74cbd8c ==============================
[0m08:16:40.415813 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:16:40.416583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:16:40.839746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89976300>]}
[0m08:16:40.861450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba171d0>]}
[0m08:16:40.861929 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:16:40.905684 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:16:40.977020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:16:40.977418 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/daylight_duration.sql
[0m08:16:41.081258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89327cb0>]}
[0m08:16:41.138769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894b6900>]}
[0m08:16:41.139130 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:16:41.139601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba17890>]}
[0m08:16:41.140542 [info ] [MainThread]: 
[0m08:16:41.140996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:16:41.143460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:16:41.149855 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:16:41.150110 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:16:41.150382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:41.732208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.582 seconds
[0m08:16:41.735114 [debug] [ThreadPool]: On list_weather: Close
[0m08:16:41.864356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m08:16:41.875942 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:16:41.876544 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:16:41.876951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:42.479520 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.602 seconds
[0m08:16:42.484488 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:16:42.666532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:16:42.674009 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:16:42.674955 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:16:42.675775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:43.178226 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.502 seconds
[0m08:16:43.182120 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:16:43.303526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89300830>]}
[0m08:16:43.304766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:16:43.306099 [info ] [MainThread]: 
[0m08:16:43.320901 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m08:16:43.321590 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m08:16:43.322414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m08:16:43.322962 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m08:16:43.329342 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m08:16:43.330598 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m08:16:43.349410 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m08:16:43.350500 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m08:16:43.350812 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m08:16:43.351114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:44.091593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m08:16:44.122563 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m08:16:44.269159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fc5e80>]}
[0m08:16:44.270818 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 0.94s]
[0m08:16:44.273845 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m08:16:44.275890 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m08:16:44.276897 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m08:16:44.278109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m08:16:44.278779 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m08:16:44.282394 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m08:16:44.285154 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m08:16:44.303166 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m08:16:44.304619 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m08:16:44.305017 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m08:16:44.305346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:45.830180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.525 seconds
[0m08:16:45.831880 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m08:16:45.964468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f13dd0>]}
[0m08:16:45.965637 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.69s]
[0m08:16:45.968755 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m08:16:45.969484 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m08:16:45.970387 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m08:16:45.971275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m08:16:45.971753 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m08:16:45.975417 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m08:16:45.977021 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m08:16:45.979337 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m08:16:45.981542 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m08:16:45.982065 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m08:16:45.982638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:47.369173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.385 seconds
[0m08:16:47.376798 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m08:16:47.518375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b50590>]}
[0m08:16:47.519583 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.55s]
[0m08:16:47.521289 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m08:16:47.521777 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m08:16:47.522256 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m08:16:47.522948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m08:16:47.523301 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m08:16:47.526423 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m08:16:47.527605 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m08:16:47.529311 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m08:16:47.530655 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m08:16:47.531008 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(sunrise AS TIME) AS sunrise_time,
        CAST(sunset AS TIME) AS sunset_time,
        DATEDIFF('second', 
                 CAST(sunrise AS TIME), 
                 CAST(sunset AS TIME)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_time AS sunrise, 
    sunset_time AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m08:16:47.531305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:48.699252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m08:16:48.705791 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m08:16:48.826638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bbb8f0>]}
[0m08:16:48.828773 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.30s]
[0m08:16:48.831520 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m08:16:48.832505 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m08:16:48.833552 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m08:16:48.834931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m08:16:48.835709 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m08:16:48.840632 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m08:16:48.843275 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m08:16:48.848094 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m08:16:48.849929 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m08:16:48.850496 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m08:16:48.850942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:50.548365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m08:16:50.553942 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m08:16:50.686949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887c5460>]}
[0m08:16:50.688367 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.85s]
[0m08:16:50.690112 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m08:16:50.691078 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m08:16:50.692067 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m08:16:50.693206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m08:16:50.693873 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m08:16:50.698075 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m08:16:50.699782 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m08:16:50.702301 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m08:16:50.704061 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m08:16:50.704549 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m08:16:50.704973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:51.873133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.168 seconds
[0m08:16:51.878205 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m08:16:52.045013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887c4c20>]}
[0m08:16:52.046209 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.35s]
[0m08:16:52.047576 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m08:16:52.048171 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m08:16:52.048762 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m08:16:52.049742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m08:16:52.050221 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m08:16:52.053384 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m08:16:52.054938 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m08:16:52.057057 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m08:16:52.058618 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m08:16:52.059059 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m08:16:52.059459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:52.996432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m08:16:53.001502 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m08:16:53.132791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2450b5f-6607-4d09-ab8f-f855a74cbd8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894799d0>]}
[0m08:16:53.134641 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.08s]
[0m08:16:53.136767 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m08:16:53.140063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:53.140709 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m08:16:53.141612 [info ] [MainThread]: 
[0m08:16:53.142537 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 12.00 seconds (12.00s).
[0m08:16:53.144424 [debug] [MainThread]: Command end result
[0m08:16:53.184525 [info ] [MainThread]: 
[0m08:16:53.185168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:16:53.185424 [info ] [MainThread]: 
[0m08:16:53.185834 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:16:53.187644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.815362, "process_user_time": 2.850164, "process_kernel_time": 0.28672, "process_mem_max_rss": "209672", "process_out_blocks": "2945", "process_in_blocks": "0"}
[0m08:16:53.188280 [debug] [MainThread]: Command `dbt run` succeeded at 08:16:53.188218 after 12.82 seconds
[0m08:16:53.188735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65b6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65b6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa780db50>]}
[0m08:16:53.189049 [debug] [MainThread]: Flushing usage events
[0m08:16:55.342521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5f5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6910a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7e2fc0>]}


============================== 08:16:55.346193 | d66f503e-fe33-4a2b-950a-c627715486c6 ==============================
[0m08:16:55.346193 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:16:55.346925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'profiles_dir': '/opt/airflow/proj', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:16:55.767387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae5fbf0>]}
[0m08:16:55.789338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b80dfa0>]}
[0m08:16:55.789822 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:16:55.835283 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:16:55.907105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:16:55.907371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:16:55.929430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a473b30>]}
[0m08:16:55.991491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a162c90>]}
[0m08:16:55.991806 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:16:55.992232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a804170>]}
[0m08:16:55.993158 [info ] [MainThread]: 
[0m08:16:55.993559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:16:55.995764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m08:16:56.003503 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:16:56.003725 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:16:56.003934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:56.434691 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.430 seconds
[0m08:16:56.439846 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:16:56.558530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:16:56.566148 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:16:56.566986 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:16:56.567795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:57.051520 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.484 seconds
[0m08:16:57.054095 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:16:57.180925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd66f503e-fe33-4a2b-950a-c627715486c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7baa22a0>]}
[0m08:16:57.181818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:16:57.183223 [info ] [MainThread]: 
[0m08:16:57.194301 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:16:57.194822 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m08:16:57.195474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m08:16:57.195938 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:16:57.208345 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:16:57.210028 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:16:57.222230 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:16:57.223349 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:16:57.223656 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m08:16:57.223951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:57.740804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m08:16:57.759748 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m08:16:57.903803 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.71s]
[0m08:16:57.907338 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:16:57.908332 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:16:57.909164 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m08:16:57.910290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m08:16:57.910880 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:16:57.919026 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:16:57.921595 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:16:57.924096 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:16:57.925789 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:16:57.926281 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m08:16:57.926794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:58.417802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m08:16:58.422320 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m08:16:58.622205 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.71s]
[0m08:16:58.624738 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:16:58.626716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:58.627149 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m08:16:58.627573 [info ] [MainThread]: 
[0m08:16:58.628225 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m08:16:58.629375 [debug] [MainThread]: Command end result
[0m08:16:58.660068 [info ] [MainThread]: 
[0m08:16:58.660567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:16:58.660950 [info ] [MainThread]: 
[0m08:16:58.661345 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:16:58.662300 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.3583045, "process_user_time": 2.347734, "process_kernel_time": 0.199165, "process_mem_max_rss": "208516", "process_out_blocks": "1944", "process_in_blocks": "0"}
[0m08:16:58.662678 [debug] [MainThread]: Command `dbt test` succeeded at 08:16:58.662624 after 3.36 seconds
[0m08:16:58.663066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5f5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a82de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab66840>]}
[0m08:16:58.663351 [debug] [MainThread]: Flushing usage events
[0m08:17:00.965549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987f97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9852c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988df080>]}


============================== 08:17:00.969038 | 7d9c3375-7682-4a77-a53d-06d7eb23b159 ==============================
[0m08:17:00.969038 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:17:00.969689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:17:01.359466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c2b4a0>]}
[0m08:17:01.381383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e5ea20>]}
[0m08:17:01.381903 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:17:01.424732 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:17:01.504463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:17:01.504750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:17:01.527003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c466210>]}
[0m08:17:01.582118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1814f0>]}
[0m08:17:01.582430 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:17:01.582909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c16ae70>]}
[0m08:17:01.583840 [info ] [MainThread]: 
[0m08:17:01.584328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:17:01.586432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:17:01.593282 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:17:01.593538 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:17:01.593763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:02.016641 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.423 seconds
[0m08:17:02.020217 [debug] [ThreadPool]: On list_weather: Close
[0m08:17:02.156076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m08:17:02.170432 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:17:02.171101 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:17:02.171622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:02.701234 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.529 seconds
[0m08:17:02.706003 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:17:03.030622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:17:03.032821 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:17:03.033372 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:17:03.033744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:03.530958 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.497 seconds
[0m08:17:03.533478 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:17:03.660619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c47a540>]}
[0m08:17:03.661890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:17:03.663637 [info ] [MainThread]: 
[0m08:17:03.676091 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m08:17:03.676800 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m08:17:03.677633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m08:17:03.678106 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m08:17:03.685206 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m08:17:03.717685 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:03.717990 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:17:03.718236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:04.104148 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.386 seconds
[0m08:17:04.145595 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:04.146076 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:17:05.291191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.144 seconds
[0m08:17:05.299279 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:05.300101 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:17:05.431013 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m08:17:05.438741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:05.439503 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:17:05.541462 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m08:17:05.552036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:05.552727 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:17:05.759823 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.206 seconds
[0m08:17:05.765550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:05.766263 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:17:05.876195 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m08:17:05.886358 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:05.887003 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:17:05.984366 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.097 seconds
[0m08:17:06.012354 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:06.012985 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:06.157448 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.144 seconds
[0m08:17:06.161047 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:06.161604 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:06.240705 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m08:17:06.242377 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m08:17:06.246095 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:06.246701 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m08:17:06.398512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m08:17:06.400162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:06.401129 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:17:07.206686 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.805 seconds
[0m08:17:07.208309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:17:07.208978 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m08:17:07.448227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m08:17:07.475196 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m08:17:07.581477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7b0950>]}
[0m08:17:07.583137 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 3.90s]
[0m08:17:07.585138 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m08:17:07.585985 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m08:17:07.586747 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m08:17:07.587658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m08:17:07.588292 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m08:17:07.593210 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m08:17:07.598483 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:07.599168 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:17:07.599744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:08.033844 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.434 seconds
[0m08:17:08.044100 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:08.044907 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:17:08.976322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m08:17:08.984103 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:08.985125 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:17:09.160817 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.175 seconds
[0m08:17:09.166984 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:09.167735 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:17:09.264950 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.096 seconds
[0m08:17:09.270967 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:09.271667 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:17:09.364378 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.092 seconds
[0m08:17:09.368444 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:09.369002 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:17:09.449583 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.080 seconds
[0m08:17:09.456890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:09.457761 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:17:09.567256 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.109 seconds
[0m08:17:09.570516 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:09.570959 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:09.996429 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.425 seconds
[0m08:17:09.999329 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:10.000120 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:10.111048 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.110 seconds
[0m08:17:10.112230 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m08:17:10.117670 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:10.118271 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m08:17:10.253669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m08:17:10.254953 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:17:10.255794 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:17:10.409613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8bc31-0004-386a-0002-62e70002d5ea
[0m08:17:10.410516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001010 (42846): SQL compilation error:
incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
[0m08:17:10.411293 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m08:17:10.545554 [debug] [Thread-1 (]: Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:17:10.546509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77f3b680>]}
[0m08:17:10.547720 [error] [Thread-1 (]: 2 of 5 ERROR snapshotting snapshot.snapshot_daylight_duration .................. [[31mERROR[0m in 2.96s]
[0m08:17:10.549141 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m08:17:10.549744 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m08:17:10.551169 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m08:17:10.552007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m08:17:10.552583 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m08:17:10.556289 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m08:17:10.560069 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:10.560527 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:17:10.560963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:11.028442 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.467 seconds
[0m08:17:11.038901 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:11.039706 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:17:11.890470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m08:17:11.893280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:11.893794 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:17:11.989612 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.095 seconds
[0m08:17:11.996294 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:11.997168 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:17:12.093130 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:17:12.102562 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.103346 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:17:12.202326 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m08:17:12.207431 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.208071 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:17:12.307800 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.099 seconds
[0m08:17:12.315742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.316645 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:17:12.416763 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m08:17:12.425347 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.426306 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:12.760325 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.333 seconds
[0m08:17:12.762472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.763349 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:12.846311 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m08:17:12.847619 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.850770 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:12.851417 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m08:17:13.080663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m08:17:13.082186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:13.082979 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:17:13.685137 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.601 seconds
[0m08:17:13.687919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:17:13.688626 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m08:17:14.198557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m08:17:14.205199 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m08:17:14.328595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bba630>]}
[0m08:17:14.330812 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.78s]
[0m08:17:14.334140 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m08:17:14.335079 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m08:17:14.336014 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m08:17:14.337079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m08:17:14.337715 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m08:17:14.342672 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m08:17:14.346966 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:14.347418 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:17:14.347850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:14.917210 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.569 seconds
[0m08:17:14.924643 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:14.925315 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:17:15.662181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m08:17:15.668974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:15.669891 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:17:15.767028 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.096 seconds
[0m08:17:15.772675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:15.773401 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:17:15.925194 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.151 seconds
[0m08:17:15.929129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:15.930187 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:17:16.034675 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.104 seconds
[0m08:17:16.038534 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.038981 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:17:16.116519 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m08:17:16.119608 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.120089 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:17:16.218162 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m08:17:16.221142 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.221441 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:16.602567 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.380 seconds
[0m08:17:16.605627 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.606191 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:16.720926 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.114 seconds
[0m08:17:16.722461 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.726615 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.727353 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m08:17:16.859743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m08:17:16.861067 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:16.861789 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:17:17.678896 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.816 seconds
[0m08:17:17.681195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:17:17.682144 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m08:17:18.086210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m08:17:18.092137 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m08:17:18.212890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775c4320>]}
[0m08:17:18.215275 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 3.87s]
[0m08:17:18.218174 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m08:17:18.219564 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m08:17:18.220928 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m08:17:18.222278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m08:17:18.223282 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m08:17:18.231150 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m08:17:18.235697 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:18.236303 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:17:18.236984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:18.629985 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.392 seconds
[0m08:17:18.642456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:18.643353 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:17:19.619218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m08:17:19.622326 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:19.622915 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:17:19.740527 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m08:17:19.748121 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:19.749023 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:17:19.830079 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.080 seconds
[0m08:17:19.837975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:19.838785 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:17:19.933018 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m08:17:19.940584 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:19.941441 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:17:20.045842 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m08:17:20.056098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.056833 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:17:20.195343 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.138 seconds
[0m08:17:20.200567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.201108 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:20.543210 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.341 seconds
[0m08:17:20.654199 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.654621 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:17:20.760591 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m08:17:20.761234 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.763312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.763756 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m08:17:20.870983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m08:17:20.872714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:20.873705 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:17:21.566043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.691 seconds
[0m08:17:21.567211 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:17:21.567983 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m08:17:21.977404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m08:17:21.982904 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m08:17:22.091404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9c3375-7682-4a77-a53d-06d7eb23b159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987fb8f0>]}
[0m08:17:22.093618 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.87s]
[0m08:17:22.097016 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m08:17:22.100785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:22.101603 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m08:17:22.102353 [info ] [MainThread]: 
[0m08:17:22.103531 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 20.52 seconds (20.52s).
[0m08:17:22.105625 [debug] [MainThread]: Command end result
[0m08:17:22.140788 [info ] [MainThread]: 
[0m08:17:22.141348 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:17:22.141783 [info ] [MainThread]: 
[0m08:17:22.142199 [error] [MainThread]:   Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:17:22.142510 [info ] [MainThread]: 
[0m08:17:22.142793 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:17:22.143938 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 21.216015, "process_user_time": 3.361758, "process_kernel_time": 0.186541, "process_mem_max_rss": "208444", "process_out_blocks": "2087", "command_success": false, "process_in_blocks": "0"}
[0m08:17:22.144305 [debug] [MainThread]: Command `dbt snapshot` failed at 08:17:22.144233 after 21.22 seconds
[0m08:17:22.144628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99450ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ecb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98eca840>]}
[0m08:17:22.144913 [debug] [MainThread]: Flushing usage events
[0m08:20:48.265530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaaed130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4d3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaaec2f0>]}


============================== 08:20:48.269993 | e3d251b4-61c7-42e1-8397-ab1bf1d4c01b ==============================
[0m08:20:48.269993 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:20:48.270758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:20:48.732644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905d3410>]}
[0m08:20:48.754226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919527b0>]}
[0m08:20:48.754692 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:20:48.799339 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:20:48.872183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:48.872580 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/daylight_duration.sql
[0m08:20:48.973797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac55d60>]}
[0m08:20:49.028690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa5e390>]}
[0m08:20:49.028982 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:20:49.029414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b12faa0>]}
[0m08:20:49.030404 [info ] [MainThread]: 
[0m08:20:49.030813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:49.033014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:20:49.039631 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:20:49.039864 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:20:49.040046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:49.543784 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.503 seconds
[0m08:20:49.547718 [debug] [ThreadPool]: On list_weather: Close
[0m08:20:49.671936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m08:20:49.677578 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:20:49.677988 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:20:49.678271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:50.120639 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.442 seconds
[0m08:20:50.122341 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:20:50.231529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:20:50.235219 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:20:50.235791 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:20:50.236223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:50.811273 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.575 seconds
[0m08:20:50.812882 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:20:50.960481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a97bc20>]}
[0m08:20:50.961008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:50.962275 [info ] [MainThread]: 
[0m08:20:50.968058 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m08:20:50.968542 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m08:20:50.969090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m08:20:50.969382 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m08:20:50.974115 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m08:20:50.974933 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m08:20:50.991908 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m08:20:50.996964 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m08:20:50.997532 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m08:20:50.997771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:51.999629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m08:20:52.027563 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m08:20:52.205228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6122d0>]}
[0m08:20:52.207018 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.23s]
[0m08:20:52.210050 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m08:20:52.212686 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m08:20:52.214373 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m08:20:52.216083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m08:20:52.217541 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m08:20:52.222460 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m08:20:52.228945 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m08:20:52.247985 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m08:20:52.249397 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m08:20:52.249779 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m08:20:52.250203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:53.432981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.182 seconds
[0m08:20:53.437486 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m08:20:53.547002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa68e060>]}
[0m08:20:53.548570 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.33s]
[0m08:20:53.550271 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m08:20:53.550763 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m08:20:53.551266 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m08:20:53.551863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m08:20:53.552253 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m08:20:53.555383 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m08:20:53.556304 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m08:20:53.557804 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m08:20:53.559082 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m08:20:53.559375 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m08:20:53.559666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:54.745414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.185 seconds
[0m08:20:54.749687 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m08:20:54.870355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6f1430>]}
[0m08:20:54.871447 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.32s]
[0m08:20:54.872967 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m08:20:54.873667 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m08:20:54.874540 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m08:20:54.875586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m08:20:54.876246 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m08:20:54.879655 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m08:20:54.881242 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m08:20:54.883811 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m08:20:54.885704 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m08:20:54.886209 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        sunrise, 
        sunset,
        DATEDIFF('second', sunrise, sunset) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise, 
    sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m08:20:54.886635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:56.301400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.414 seconds
[0m08:20:56.305404 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m08:20:56.436049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fbea50>]}
[0m08:20:56.437557 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.56s]
[0m08:20:56.439680 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m08:20:56.440595 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m08:20:56.441659 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m08:20:56.442619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m08:20:56.443202 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m08:20:56.447521 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m08:20:56.449289 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m08:20:56.453842 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m08:20:56.455649 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m08:20:56.456049 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m08:20:56.456422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:57.736365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.279 seconds
[0m08:20:57.741392 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m08:20:57.896322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fd9a60>]}
[0m08:20:57.898218 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.45s]
[0m08:20:57.900916 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m08:20:57.901778 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m08:20:57.902595 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m08:20:57.903687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m08:20:57.904390 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m08:20:57.908894 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m08:20:57.912013 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m08:20:57.914848 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m08:20:57.916823 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m08:20:57.917395 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m08:20:57.917935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:59.166563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m08:20:59.169757 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m08:20:59.271967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fda240>]}
[0m08:20:59.272671 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.37s]
[0m08:20:59.273585 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m08:20:59.274068 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m08:20:59.274594 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m08:20:59.275166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m08:20:59.275519 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m08:20:59.277597 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m08:20:59.278789 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m08:20:59.280484 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m08:20:59.281861 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m08:20:59.282274 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m08:20:59.283304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:00.607365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m08:21:00.612651 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m08:21:00.755138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d251b4-61c7-42e1-8397-ab1bf1d4c01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9f3380>]}
[0m08:21:00.757283 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.48s]
[0m08:21:00.759749 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m08:21:00.763830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:00.764645 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m08:21:00.765564 [info ] [MainThread]: 
[0m08:21:00.766843 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m08:21:00.769239 [debug] [MainThread]: Command end result
[0m08:21:00.809888 [info ] [MainThread]: 
[0m08:21:00.810505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:21:00.810880 [info ] [MainThread]: 
[0m08:21:00.811337 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:21:00.813239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.584544, "process_user_time": 2.762028, "process_kernel_time": 0.266838, "process_mem_max_rss": "209660", "process_out_blocks": "2942", "process_in_blocks": "0"}
[0m08:21:00.813837 [debug] [MainThread]: Command `dbt run` succeeded at 08:21:00.813769 after 12.59 seconds
[0m08:21:00.814262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b49fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2e8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3bc410>]}
[0m08:21:00.814757 [debug] [MainThread]: Flushing usage events
[0m08:21:03.633776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f73d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c902fc0>]}


============================== 08:21:03.637510 | 2e446aa7-0e63-43ce-86f1-8a68df3df168 ==============================
[0m08:21:03.637510 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:21:03.638207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:21:04.057262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d9c1a0>]}
[0m08:21:04.078795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f2dd60>]}
[0m08:21:04.079242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:21:04.121375 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:21:04.192321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:21:04.192613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:21:04.214723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808abb30>]}
[0m08:21:04.276681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80206f00>]}
[0m08:21:04.276987 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:21:04.277384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c0f140>]}
[0m08:21:04.278301 [info ] [MainThread]: 
[0m08:21:04.278702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:21:04.280916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m08:21:04.288653 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:21:04.288930 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:21:04.289141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:21:04.772753 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.483 seconds
[0m08:21:04.775794 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:21:04.909959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:21:04.916558 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:21:04.917357 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:21:04.918037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:05.383123 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.465 seconds
[0m08:21:05.389026 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:21:05.534514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e446aa7-0e63-43ce-86f1-8a68df3df168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8072cd10>]}
[0m08:21:05.535388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:21:05.536188 [info ] [MainThread]: 
[0m08:21:05.545044 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:21:05.545478 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m08:21:05.546084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m08:21:05.546440 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:21:05.558163 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:21:05.560018 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:21:05.571030 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:21:05.572206 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:21:05.572500 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m08:21:05.572803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:06.070035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m08:21:06.077117 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m08:21:06.195888 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.65s]
[0m08:21:06.197136 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:21:06.197647 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:21:06.198132 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m08:21:06.198805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m08:21:06.199184 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:21:06.204487 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:21:06.206425 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:21:06.208072 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:21:06.209296 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:21:06.209690 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m08:21:06.210030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:06.745784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m08:21:06.751478 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m08:21:06.920857 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.72s]
[0m08:21:06.923507 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:21:06.926714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:06.927498 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m08:21:06.928208 [info ] [MainThread]: 
[0m08:21:06.929190 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m08:21:06.930840 [debug] [MainThread]: Command end result
[0m08:21:06.969585 [info ] [MainThread]: 
[0m08:21:06.970212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:21:06.970651 [info ] [MainThread]: 
[0m08:21:06.971080 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:21:06.972220 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.377131, "process_user_time": 2.313747, "process_kernel_time": 0.224169, "process_mem_max_rss": "208528", "process_out_blocks": "1943", "process_in_blocks": "0"}
[0m08:21:06.972645 [debug] [MainThread]: Command `dbt test` succeeded at 08:21:06.972563 after 3.38 seconds
[0m08:21:06.972959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a5c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e566ea0>]}
[0m08:21:06.973242 [debug] [MainThread]: Flushing usage events
[0m08:21:09.197503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870fd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853230b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861d7ec0>]}


============================== 08:21:09.201018 | 22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8 ==============================
[0m08:21:09.201018 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:21:09.202113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:21:09.605776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed056a0>]}
[0m08:21:09.627910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853c7290>]}
[0m08:21:09.628435 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:21:09.674365 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:21:09.741684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:21:09.741992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:21:09.764425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff693a38f0>]}
[0m08:21:09.818989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68c21820>]}
[0m08:21:09.819277 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:21:09.819739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68c0c2f0>]}
[0m08:21:09.820766 [info ] [MainThread]: 
[0m08:21:09.821202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:21:09.823294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:21:09.830143 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:21:09.830374 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:21:09.830581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:21:10.252783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.422 seconds
[0m08:21:10.257032 [debug] [ThreadPool]: On list_weather: Close
[0m08:21:10.383083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m08:21:10.397183 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:21:10.397872 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:21:10.398348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:10.877707 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.479 seconds
[0m08:21:10.882292 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:21:11.007478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:21:11.010796 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:21:11.011846 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:21:11.012318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:11.484270 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.472 seconds
[0m08:21:11.488982 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:21:11.610067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68fe8950>]}
[0m08:21:11.610683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:21:11.611319 [info ] [MainThread]: 
[0m08:21:11.619309 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m08:21:11.619986 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m08:21:11.620760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m08:21:11.621098 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m08:21:11.628306 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m08:21:11.655402 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:11.655711 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:21:11.655946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:12.054486 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.398 seconds
[0m08:21:12.086700 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:12.087097 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:21:12.890302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m08:21:12.897195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:12.898064 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:21:13.045746 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.147 seconds
[0m08:21:13.053396 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:13.054185 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:21:13.221502 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.167 seconds
[0m08:21:13.231301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:13.231995 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:21:13.349831 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m08:21:13.353383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:13.353798 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:21:13.501554 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.147 seconds
[0m08:21:13.507427 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:13.507865 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:21:13.645868 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.137 seconds
[0m08:21:13.674874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:13.675466 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:14.016232 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.340 seconds
[0m08:21:14.023123 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:14.024008 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:14.848451 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.823 seconds
[0m08:21:14.851291 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m08:21:14.856641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:14.857465 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m08:21:15.347798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m08:21:15.349058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:15.349958 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:21:15.837994 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.487 seconds
[0m08:21:15.839443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:21:15.840245 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m08:21:16.186250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m08:21:16.202828 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m08:21:16.312277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8587a300>]}
[0m08:21:16.313466 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 4.69s]
[0m08:21:16.314805 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m08:21:16.315471 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m08:21:16.316232 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m08:21:16.317006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m08:21:16.317496 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m08:21:16.320725 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m08:21:16.324432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:16.324815 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:21:16.325162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:17.295478 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.970 seconds
[0m08:21:17.308170 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:17.309117 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:21:18.086897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m08:21:18.094262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.096465 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:21:18.187912 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m08:21:18.194872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.195457 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:21:18.307186 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.111 seconds
[0m08:21:18.311377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.312010 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:21:18.409897 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m08:21:18.417704 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.418506 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:21:18.509260 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.090 seconds
[0m08:21:18.514029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.514500 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:21:18.598030 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m08:21:18.606220 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.607086 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:18.788393 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.180 seconds
[0m08:21:18.790866 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.791648 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:18.880289 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m08:21:18.881784 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.885767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:18.886475 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m08:21:19.002385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m08:21:19.003855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:21:19.004713 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:21:19.149909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8bc35-0004-3987-0002-62e700029716
[0m08:21:19.151632 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001010 (42846): SQL compilation error:
incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
[0m08:21:19.152504 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m08:21:19.270073 [debug] [Thread-1 (]: Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:21:19.271250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff680bbe90>]}
[0m08:21:19.272690 [error] [Thread-1 (]: 2 of 5 ERROR snapshotting snapshot.snapshot_daylight_duration .................. [[31mERROR[0m in 2.95s]
[0m08:21:19.274536 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m08:21:19.275315 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m08:21:19.277075 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m08:21:19.278120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m08:21:19.278708 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m08:21:19.282689 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m08:21:19.286736 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:19.287222 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:21:19.287676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:19.689455 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.402 seconds
[0m08:21:19.694942 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:19.695387 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:21:20.780261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m08:21:20.784883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:20.785630 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:21:20.901646 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.115 seconds
[0m08:21:20.909472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:20.910371 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:21:21.009812 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m08:21:21.019443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:21.020096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:21:21.153756 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.133 seconds
[0m08:21:21.161362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:21.162328 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:21:21.267754 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m08:21:21.275666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:21.276704 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:21:21.400524 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.123 seconds
[0m08:21:21.410441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:21.411332 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:21.901384 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.489 seconds
[0m08:21:21.903492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:21.904087 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:22.207277 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.302 seconds
[0m08:21:22.209425 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m08:21:22.213437 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:22.214218 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m08:21:22.341116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m08:21:22.342644 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:22.343550 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:21:23.031257 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.687 seconds
[0m08:21:23.032528 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:21:23.033280 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m08:21:23.442372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m08:21:23.447994 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m08:21:23.566309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff681240e0>]}
[0m08:21:23.567681 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 4.29s]
[0m08:21:23.569676 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m08:21:23.570159 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m08:21:23.570685 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m08:21:23.571219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m08:21:23.571500 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m08:21:23.574523 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m08:21:23.577017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:23.577278 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:21:23.577533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:23.985991 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.408 seconds
[0m08:21:23.993256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:23.993893 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:21:24.767638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m08:21:24.774363 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:24.775299 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:21:25.587560 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.812 seconds
[0m08:21:25.591421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:25.591931 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:21:25.709298 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.117 seconds
[0m08:21:25.716275 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:25.717114 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:21:25.812864 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:21:25.821704 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:25.822481 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:21:25.905347 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m08:21:25.910731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:25.911382 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:21:26.037419 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.125 seconds
[0m08:21:26.046779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:26.047647 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:26.405748 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.357 seconds
[0m08:21:26.409245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:26.410197 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:26.503970 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m08:21:26.505811 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:26.509109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:26.509974 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m08:21:26.671128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m08:21:26.671944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:26.672617 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:21:27.331533 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.658 seconds
[0m08:21:27.333947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:21:27.334849 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m08:21:27.843696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m08:21:27.849449 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m08:21:27.962321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fef020>]}
[0m08:21:27.965105 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 4.39s]
[0m08:21:27.970113 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m08:21:27.971796 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m08:21:27.973358 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m08:21:27.975940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m08:21:27.976975 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m08:21:27.984476 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m08:21:27.988758 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:27.989239 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:21:27.989704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:28.420014 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.430 seconds
[0m08:21:28.426261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:28.426781 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:21:29.014010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m08:21:29.021562 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.022575 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:21:29.113387 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.089 seconds
[0m08:21:29.121425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.122280 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:21:29.200810 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.078 seconds
[0m08:21:29.204549 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.204998 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:21:29.313174 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m08:21:29.320400 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.321274 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:21:29.448965 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.127 seconds
[0m08:21:29.458724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.459409 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:21:29.558281 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m08:21:29.561872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:29.562295 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:29.890673 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.328 seconds
[0m08:21:30.003083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:30.003594 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:21:30.081807 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m08:21:30.082503 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m08:21:30.084242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:30.084609 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m08:21:30.226531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m08:21:30.227828 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:30.228686 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:21:30.924210 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.695 seconds
[0m08:21:30.925772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:21:30.926631 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m08:21:31.193494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m08:21:31.197122 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m08:21:31.318383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bfbfc5-5633-470e-bbc6-c1f85a1a4bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d4d460>]}
[0m08:21:31.320555 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.34s]
[0m08:21:31.323318 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m08:21:31.326644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:31.327600 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m08:21:31.328340 [info ] [MainThread]: 
[0m08:21:31.329483 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 21.51 seconds (21.51s).
[0m08:21:31.331591 [debug] [MainThread]: Command end result
[0m08:21:31.372140 [info ] [MainThread]: 
[0m08:21:31.372667 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:21:31.373078 [info ] [MainThread]: 
[0m08:21:31.373553 [error] [MainThread]:   Database Error in snapshot snapshot_daylight_duration (snapshots/snapshot.daylight_duration.sql)
  001010 (42846): SQL compilation error:
  incompatible types: [TIME(9)] and [TIMESTAMP_NTZ(9)]
  compiled code at target/run/proj/snapshots/snapshot.daylight_duration.sql
[0m08:21:31.373827 [info ] [MainThread]: 
[0m08:21:31.374133 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:21:31.375540 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 22.21726, "process_user_time": 3.313048, "process_kernel_time": 0.196706, "process_mem_max_rss": "208408", "process_out_blocks": "2086", "command_success": false, "process_in_blocks": "0"}
[0m08:21:31.375876 [debug] [MainThread]: Command `dbt snapshot` failed at 08:21:31.375821 after 22.22 seconds
[0m08:21:31.376182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6816cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6816d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6805ed50>]}
[0m08:21:31.376449 [debug] [MainThread]: Flushing usage events
[0m08:23:38.837530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa591cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa06a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa72a060>]}


============================== 08:23:38.841673 | 3fcafe05-f0f1-443e-9fb8-e500a04bfa7e ==============================
[0m08:23:38.841673 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:23:38.842372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:23:39.280391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadc1fd0>]}
[0m08:23:39.301924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff771d0>]}
[0m08:23:39.302375 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:23:39.346161 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:23:39.418972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:23:39.419415 [debug] [MainThread]: Partial parsing: updated file: proj://models/output/daylight_duration.sql
[0m08:23:39.522129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d883a40>]}
[0m08:23:39.578720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da179e0>]}
[0m08:23:39.579033 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:23:39.579498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc2e060>]}
[0m08:23:39.580431 [info ] [MainThread]: 
[0m08:23:39.580875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:23:39.583093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:23:39.589361 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:23:39.589615 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:23:39.589858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:40.104442 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.514 seconds
[0m08:23:40.108336 [debug] [ThreadPool]: On list_weather: Close
[0m08:23:40.273003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m08:23:40.287156 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:23:40.287832 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:23:40.288318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:40.772583 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.484 seconds
[0m08:23:40.775596 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:23:40.893464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:23:40.900648 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:23:40.901436 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:23:40.902019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:41.425379 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.523 seconds
[0m08:23:41.429937 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:23:41.582552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff25c10>]}
[0m08:23:41.583766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:23:41.585161 [info ] [MainThread]: 
[0m08:23:41.597048 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m08:23:41.597758 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m08:23:41.598517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m08:23:41.599036 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m08:23:41.605551 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m08:23:41.607990 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m08:23:41.626707 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m08:23:41.627746 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m08:23:41.628054 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m08:23:41.628316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:42.394706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m08:23:42.425886 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m08:23:42.539375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df5ca70>]}
[0m08:23:42.541221 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 0.94s]
[0m08:23:42.543313 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m08:23:42.545549 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m08:23:42.546827 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m08:23:42.548143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m08:23:42.548897 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m08:23:42.552832 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m08:23:42.555549 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m08:23:42.574055 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m08:23:42.575572 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m08:23:42.575971 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m08:23:42.576313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:43.732603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.156 seconds
[0m08:23:43.738649 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m08:23:43.863368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3560c0>]}
[0m08:23:43.865485 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.31s]
[0m08:23:43.867348 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m08:23:43.868264 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m08:23:43.869213 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m08:23:43.870394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m08:23:43.871289 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m08:23:43.875010 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m08:23:43.876743 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m08:23:43.879534 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m08:23:43.881713 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m08:23:43.882211 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m08:23:43.882675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:45.175029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m08:23:45.177472 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m08:23:45.316021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d722510>]}
[0m08:23:45.317088 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.45s]
[0m08:23:45.318929 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m08:23:45.319467 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m08:23:45.319999 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m08:23:45.320594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m08:23:45.320982 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m08:23:45.323667 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m08:23:45.325095 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m08:23:45.327096 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m08:23:45.328930 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m08:23:45.329284 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m08:23:45.329701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:46.285916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.956 seconds
[0m08:23:46.291432 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m08:23:46.456197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df5ca70>]}
[0m08:23:46.457442 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.14s]
[0m08:23:46.459161 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m08:23:46.459882 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m08:23:46.460588 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m08:23:46.461549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m08:23:46.462141 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m08:23:46.465033 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m08:23:46.466437 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m08:23:46.470456 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m08:23:46.472100 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m08:23:46.472547 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m08:23:46.472995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:47.512802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.040 seconds
[0m08:23:47.515139 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m08:23:47.631271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfcfaa0>]}
[0m08:23:47.632956 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.17s]
[0m08:23:47.635542 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m08:23:47.636623 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m08:23:47.637580 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m08:23:47.638859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m08:23:47.639532 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m08:23:47.643819 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m08:23:47.645644 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m08:23:47.648582 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m08:23:47.650743 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m08:23:47.651300 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m08:23:47.651888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:48.743290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m08:23:48.746711 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m08:23:48.884800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfcc230>]}
[0m08:23:48.886750 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.25s]
[0m08:23:48.889645 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m08:23:48.890479 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m08:23:48.891322 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m08:23:48.892419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m08:23:48.893238 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m08:23:48.897977 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m08:23:48.900237 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m08:23:48.903046 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m08:23:48.905252 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m08:23:48.905820 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m08:23:48.906296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:50.078386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.171 seconds
[0m08:23:50.084906 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m08:23:50.203347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcafe05-f0f1-443e-9fb8-e500a04bfa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d37c140>]}
[0m08:23:50.205526 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.31s]
[0m08:23:50.207645 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m08:23:50.210412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:50.210907 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m08:23:50.211567 [info ] [MainThread]: 
[0m08:23:50.212447 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m08:23:50.214430 [debug] [MainThread]: Command end result
[0m08:23:50.247454 [info ] [MainThread]: 
[0m08:23:50.248053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:50.248426 [info ] [MainThread]: 
[0m08:23:50.248837 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:23:50.250059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.4516, "process_user_time": 2.791318, "process_kernel_time": 0.287826, "process_mem_max_rss": "209408", "process_out_blocks": "2946", "process_in_blocks": "0"}
[0m08:23:50.250450 [debug] [MainThread]: Command `dbt run` succeeded at 08:23:50.250378 after 11.45 seconds
[0m08:23:50.250796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa591cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad1a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da15460>]}
[0m08:23:50.251101 [debug] [MainThread]: Flushing usage events
[0m08:23:52.934955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec6f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d1d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e18e0f0>]}


============================== 08:23:52.938595 | 0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1 ==============================
[0m08:23:52.938595 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:23:52.939169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:23:53.348993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee76150>]}
[0m08:23:53.370408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6ad430>]}
[0m08:23:53.370880 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:23:53.416114 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:23:53.490149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:53.490498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:53.513487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d227e0>]}
[0m08:23:53.575640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff717fb860>]}
[0m08:23:53.575942 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:23:53.576350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a098e0>]}
[0m08:23:53.577313 [info ] [MainThread]: 
[0m08:23:53.577777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:23:53.579980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m08:23:53.587568 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:23:53.587794 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:23:53.587984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:54.077229 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.489 seconds
[0m08:23:54.082254 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:23:54.213479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:23:54.220461 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:23:54.221232 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:23:54.221798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:54.723682 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.502 seconds
[0m08:23:54.727248 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:23:54.849484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0609a8d6-0efb-4f79-9ac9-ad35ee1f94e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4e5220>]}
[0m08:23:54.850925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:23:54.852575 [info ] [MainThread]: 
[0m08:23:54.866470 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:23:54.867216 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m08:23:54.868199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m08:23:54.868765 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:23:54.883551 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:23:54.885761 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:23:54.899164 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:23:54.900580 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:23:54.900973 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m08:23:54.901330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:55.400600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m08:23:55.415438 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m08:23:55.548437 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.68s]
[0m08:23:55.551481 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:23:55.552615 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:23:55.553479 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m08:23:55.554632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m08:23:55.555219 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:23:55.564058 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:23:55.565863 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:23:55.568444 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:23:55.570340 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:23:55.570848 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m08:23:55.571315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:56.115063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m08:23:56.118834 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m08:23:56.264388 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.71s]
[0m08:23:56.265190 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:23:56.266206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:56.266490 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m08:23:56.266772 [info ] [MainThread]: 
[0m08:23:56.267160 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m08:23:56.267767 [debug] [MainThread]: Command end result
[0m08:23:56.292340 [info ] [MainThread]: 
[0m08:23:56.292865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:56.293332 [info ] [MainThread]: 
[0m08:23:56.293750 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:23:56.294544 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.4001021, "process_user_time": 2.319157, "process_kernel_time": 0.185894, "process_mem_max_rss": "208656", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m08:23:56.295000 [debug] [MainThread]: Command `dbt test` succeeded at 08:23:56.294930 after 3.40 seconds
[0m08:23:56.295340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e85a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e42b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71fc6d50>]}
[0m08:23:56.295683 [debug] [MainThread]: Flushing usage events
[0m08:23:58.793102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3846c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27b5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2015040>]}


============================== 08:23:58.796614 | 439f3221-813f-4e98-80b4-15e29dc57555 ==============================
[0m08:23:58.796614 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:23:58.797478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m08:23:59.190916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94922840>]}
[0m08:23:59.212290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9505bb00>]}
[0m08:23:59.212777 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:23:59.257152 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:23:59.323712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:59.324005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:59.346205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97552960>]}
[0m08:23:59.400561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94543e00>]}
[0m08:23:59.400860 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:23:59.401280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945440e0>]}
[0m08:23:59.402268 [info ] [MainThread]: 
[0m08:23:59.402725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:23:59.404816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:23:59.411404 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:23:59.411631 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:23:59.411838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:59.848357 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.436 seconds
[0m08:23:59.850712 [debug] [ThreadPool]: On list_weather: Close
[0m08:23:59.970395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m08:23:59.981471 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:23:59.981980 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:23:59.982517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:00.488865 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.506 seconds
[0m08:24:00.492837 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:24:00.630522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:24:00.637338 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:24:00.638084 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:24:00.638617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:01.162826 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.524 seconds
[0m08:24:01.167864 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:24:01.298967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94658680>]}
[0m08:24:01.300700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:01.301653 [info ] [MainThread]: 
[0m08:24:01.317324 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m08:24:01.318294 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m08:24:01.319328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m08:24:01.319772 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m08:24:01.327516 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m08:24:01.361760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:01.362092 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:24:01.362400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:01.910960 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.548 seconds
[0m08:24:01.958002 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:01.958555 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:24:02.772836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m08:24:02.779188 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:02.780069 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:24:02.891603 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m08:24:02.895698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:02.896154 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:24:02.977077 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.080 seconds
[0m08:24:02.982326 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:02.982930 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:24:03.087190 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.103 seconds
[0m08:24:03.093272 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.094068 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:24:03.222608 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.128 seconds
[0m08:24:03.234640 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.235371 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:24:03.341776 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.105 seconds
[0m08:24:03.372098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.372810 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:03.800616 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.426 seconds
[0m08:24:03.809120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.810019 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:03.933435 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m08:24:03.935217 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.939392 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:03.940350 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m08:24:04.078511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m08:24:04.079239 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:04.079781 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:24:04.618874 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.538 seconds
[0m08:24:04.621181 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:24:04.621878 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m08:24:05.027789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m08:24:05.058071 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m08:24:05.177027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b88c50>]}
[0m08:24:05.178806 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 3.86s]
[0m08:24:05.181267 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m08:24:05.182070 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m08:24:05.182961 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m08:24:05.183805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m08:24:05.184329 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m08:24:05.188306 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m08:24:05.192359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:05.192813 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:24:05.193372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:05.741293 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.548 seconds
[0m08:24:05.753203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:05.754132 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:24:06.881278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.126 seconds
[0m08:24:06.887509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:06.888386 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:24:07.007172 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.118 seconds
[0m08:24:07.012857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.013407 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:24:07.100941 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.087 seconds
[0m08:24:07.103184 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.103536 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:24:07.238557 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.134 seconds
[0m08:24:07.243433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.244082 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:24:07.348282 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.103 seconds
[0m08:24:07.354728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.356211 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:24:07.452583 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:24:07.458786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.459417 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:07.673962 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.213 seconds
[0m08:24:07.677006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.678076 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:07.769363 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m08:24:07.770683 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.773124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.774065 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m08:24:07.957807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m08:24:07.958739 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:07.959293 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:24:08.507799 [debug] [Thread-1 (]: SQL status: SUCCESS 322 in 0.548 seconds
[0m08:24:08.508489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:24:08.508886 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m08:24:08.918451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m08:24:08.924048 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m08:24:09.039631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942f4800>]}
[0m08:24:09.041953 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 322[0m in 3.85s]
[0m08:24:09.044540 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m08:24:09.045602 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m08:24:09.046539 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m08:24:09.047890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m08:24:09.048758 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m08:24:09.053937 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m08:24:09.058675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:09.059288 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:24:09.059798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:09.484503 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.424 seconds
[0m08:24:09.497332 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:09.498316 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:24:10.146873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m08:24:10.155281 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.156284 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:24:10.262218 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m08:24:10.268442 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.269272 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:24:10.351421 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m08:24:10.365503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.366427 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:24:10.467375 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m08:24:10.475213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.476108 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:24:10.566856 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m08:24:10.572659 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.573391 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:24:10.667297 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m08:24:10.677801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.678872 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:10.926711 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.247 seconds
[0m08:24:10.928045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:10.928566 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:11.006044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m08:24:11.007523 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m08:24:11.010814 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:11.011499 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m08:24:11.128504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m08:24:11.129253 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:11.131217 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:24:11.684968 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.553 seconds
[0m08:24:11.686537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:24:11.687371 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m08:24:12.090113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m08:24:12.093317 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m08:24:12.206986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940fc650>]}
[0m08:24:12.208872 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.16s]
[0m08:24:12.210612 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m08:24:12.211390 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m08:24:12.212291 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m08:24:12.213395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m08:24:12.214028 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m08:24:12.218344 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m08:24:12.222564 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:12.223014 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:24:12.223442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:12.691191 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.467 seconds
[0m08:24:12.712521 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:12.713517 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:24:13.723393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m08:24:13.728800 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:13.729637 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:24:13.844274 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.114 seconds
[0m08:24:13.851455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:13.852458 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:24:13.963037 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.110 seconds
[0m08:24:13.968127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:13.968798 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:24:14.064440 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:24:14.074813 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.075626 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:24:14.164396 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.088 seconds
[0m08:24:14.168053 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.168547 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:24:14.262593 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m08:24:14.271624 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.272765 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:14.654159 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.380 seconds
[0m08:24:14.657258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.658094 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:14.754830 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.096 seconds
[0m08:24:14.756479 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.761205 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.762065 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m08:24:14.877044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m08:24:14.878678 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:14.879571 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:24:15.471842 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.591 seconds
[0m08:24:15.473387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:24:15.474036 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m08:24:15.779888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m08:24:15.785213 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m08:24:15.899583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940e45f0>]}
[0m08:24:15.902287 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 3.69s]
[0m08:24:15.905105 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m08:24:15.906017 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m08:24:15.907255 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m08:24:15.908521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m08:24:15.909315 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m08:24:15.913888 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m08:24:15.918393 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:15.918945 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:24:15.919448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:16.332307 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.412 seconds
[0m08:24:16.343842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:16.344850 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:24:17.108626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m08:24:17.110364 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.110642 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:24:17.193077 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m08:24:17.196323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.196781 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:24:17.314850 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m08:24:17.322859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.323907 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:24:17.485170 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.161 seconds
[0m08:24:17.491190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.491752 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:24:17.619563 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.127 seconds
[0m08:24:17.624646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.625087 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:24:17.715161 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.089 seconds
[0m08:24:17.723889 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:17.724826 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:18.028008 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.302 seconds
[0m08:24:18.122950 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:18.123422 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:24:18.248642 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.125 seconds
[0m08:24:18.250992 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m08:24:18.254499 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:18.255090 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m08:24:18.454555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m08:24:18.455461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:18.456298 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:24:19.055516 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.598 seconds
[0m08:24:19.057283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:24:19.058186 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m08:24:19.462449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m08:24:19.466523 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m08:24:19.578382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f3221-813f-4e98-80b4-15e29dc57555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94686ba0>]}
[0m08:24:19.580845 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.67s]
[0m08:24:19.583422 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m08:24:19.587529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:19.588729 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m08:24:19.589608 [info ] [MainThread]: 
[0m08:24:19.590922 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 20.19 seconds (20.19s).
[0m08:24:19.592852 [debug] [MainThread]: Command end result
[0m08:24:19.633034 [info ] [MainThread]: 
[0m08:24:19.633739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:24:19.634210 [info ] [MainThread]: 
[0m08:24:19.634579 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:24:19.635837 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 20.883862, "process_user_time": 3.380094, "process_kernel_time": 0.174746, "process_mem_max_rss": "207632", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m08:24:19.636217 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:24:19.636158 after 20.88 seconds
[0m08:24:19.636516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3846c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94340c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d20ef0>]}
[0m08:24:19.636842 [debug] [MainThread]: Flushing usage events
[0m08:26:15.370830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865547d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88be12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8616cbf0>]}


============================== 08:26:15.375555 | 1d816386-5e23-4941-af32-389da8319cd8 ==============================
[0m08:26:15.375555 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:26:15.376010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:26:15.884447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d0b6e0>]}
[0m08:26:15.906193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bf41970>]}
[0m08:26:15.906628 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:26:15.952272 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:26:16.021888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:26:16.022197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:26:16.044003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69c76150>]}
[0m08:26:16.099585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69c758e0>]}
[0m08:26:16.099869 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:26:16.100112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69f69f10>]}
[0m08:26:16.101089 [info ] [MainThread]: 
[0m08:26:16.101444 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:26:16.104006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:26:16.110773 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:26:16.110995 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:26:16.111187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:16.556839 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.445 seconds
[0m08:26:16.560939 [debug] [ThreadPool]: On list_weather: Close
[0m08:26:16.700443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m08:26:16.715416 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:26:16.716074 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:26:16.716551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:17.173882 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.457 seconds
[0m08:26:17.176094 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:26:17.277399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m08:26:17.280431 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:26:17.280822 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:26:17.281171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:17.784387 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.503 seconds
[0m08:26:17.788781 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:26:17.899273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873c1670>]}
[0m08:26:17.900993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:17.901683 [info ] [MainThread]: 
[0m08:26:17.917008 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m08:26:17.917878 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m08:26:17.918537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m08:26:17.919035 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m08:26:17.926080 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m08:26:17.928151 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m08:26:17.947232 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m08:26:17.948442 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m08:26:17.948724 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m08:26:17.948989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:18.657962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m08:26:18.681749 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m08:26:18.797044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86556210>]}
[0m08:26:18.797915 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 0.88s]
[0m08:26:18.798564 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m08:26:18.799391 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m08:26:18.799749 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m08:26:18.801124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m08:26:18.801436 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m08:26:18.803223 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m08:26:18.804117 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m08:26:18.814196 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m08:26:18.815123 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m08:26:18.815345 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m08:26:18.815546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:19.887784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.072 seconds
[0m08:26:19.891164 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m08:26:20.011665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d23a70>]}
[0m08:26:20.013328 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.21s]
[0m08:26:20.015239 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m08:26:20.016278 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m08:26:20.017184 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m08:26:20.018032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m08:26:20.018685 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m08:26:20.022775 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m08:26:20.024504 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m08:26:20.026866 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m08:26:20.028948 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m08:26:20.029418 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m08:26:20.029962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:21.326825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.295 seconds
[0m08:26:21.333036 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m08:26:21.454014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d70a10>]}
[0m08:26:21.455001 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.44s]
[0m08:26:21.455739 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m08:26:21.456326 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m08:26:21.456952 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m08:26:21.457445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m08:26:21.457837 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m08:26:21.460742 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m08:26:21.461863 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m08:26:21.463754 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m08:26:21.465361 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m08:26:21.465697 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m08:26:21.466012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:22.757175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.291 seconds
[0m08:26:22.762013 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m08:26:22.884119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d70d10>]}
[0m08:26:22.886179 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.43s]
[0m08:26:22.887589 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m08:26:22.888715 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m08:26:22.890251 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m08:26:22.891350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m08:26:22.892101 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m08:26:22.896312 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m08:26:22.898103 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m08:26:22.900858 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m08:26:22.902889 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m08:26:22.903420 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m08:26:22.903859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:23.883632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m08:26:23.889072 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m08:26:24.016490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69731e20>]}
[0m08:26:24.018701 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.12s]
[0m08:26:24.020401 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m08:26:24.021347 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m08:26:24.022225 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m08:26:24.022989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m08:26:24.023558 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m08:26:24.028334 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m08:26:24.030475 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m08:26:24.033326 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m08:26:24.035406 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m08:26:24.036054 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m08:26:24.036641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:25.005888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m08:26:25.009663 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m08:26:25.124423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d8e960>]}
[0m08:26:25.126725 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m08:26:25.128388 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m08:26:25.129644 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m08:26:25.130676 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m08:26:25.131640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m08:26:25.132200 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m08:26:25.137032 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m08:26:25.139347 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m08:26:25.142382 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m08:26:25.144451 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m08:26:25.145021 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m08:26:25.145524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:26.134565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m08:26:26.138185 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m08:26:26.258468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d816386-5e23-4941-af32-389da8319cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68da7710>]}
[0m08:26:26.259654 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.13s]
[0m08:26:26.260647 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m08:26:26.263505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:26.264204 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m08:26:26.265052 [info ] [MainThread]: 
[0m08:26:26.265783 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m08:26:26.267673 [debug] [MainThread]: Command end result
[0m08:26:26.303196 [info ] [MainThread]: 
[0m08:26:26.303583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:26:26.303856 [info ] [MainThread]: 
[0m08:26:26.304191 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:26:26.305537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.9747305, "process_user_time": 2.716851, "process_kernel_time": 0.413324, "process_mem_max_rss": "206868", "process_out_blocks": "1999", "process_in_blocks": "0"}
[0m08:26:26.306099 [debug] [MainThread]: Command `dbt run` succeeded at 08:26:26.306020 after 10.98 seconds
[0m08:26:26.306489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88be12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69f69d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a431490>]}
[0m08:26:26.306766 [debug] [MainThread]: Flushing usage events
[0m08:26:28.506309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fef05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce9c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c29ff20>]}


============================== 08:26:28.513479 | 333f45b4-e636-4424-940c-4da7e4aae340 ==============================
[0m08:26:28.513479 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:26:28.514779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:26:29.017123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9daffbc0>]}
[0m08:26:29.038633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d306030>]}
[0m08:26:29.039117 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:26:29.088551 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:26:29.160696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:26:29.161108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:26:29.184333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d705460>]}
[0m08:26:29.246312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc3de80>]}
[0m08:26:29.246618 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:26:29.247291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961f1970>]}
[0m08:26:29.248229 [info ] [MainThread]: 
[0m08:26:29.248627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:26:29.250862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m08:26:29.258778 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:26:29.259003 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:26:29.259195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:29.761315 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.502 seconds
[0m08:26:29.763322 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:26:29.884904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:26:29.887336 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:26:29.887605 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:26:29.887900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:30.345711 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.458 seconds
[0m08:26:30.349033 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:26:30.470475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '333f45b4-e636-4424-940c-4da7e4aae340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80294740>]}
[0m08:26:30.472096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:30.473946 [info ] [MainThread]: 
[0m08:26:30.489074 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:26:30.489666 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m08:26:30.490446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m08:26:30.490917 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:26:30.505000 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:26:30.506326 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:26:30.519034 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:26:30.520088 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m08:26:30.520405 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m08:26:30.520708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:31.087099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m08:26:31.095015 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m08:26:31.212230 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.72s]
[0m08:26:31.214042 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m08:26:31.214586 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:26:31.215214 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m08:26:31.215912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m08:26:31.216346 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:26:31.222178 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:26:31.223454 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:26:31.225174 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:26:31.226406 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m08:26:31.226818 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m08:26:31.227276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:31.760168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m08:26:31.764186 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m08:26:31.895390 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.68s]
[0m08:26:31.897655 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m08:26:31.900569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:31.901247 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m08:26:31.902040 [info ] [MainThread]: 
[0m08:26:31.903196 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m08:26:31.904979 [debug] [MainThread]: Command end result
[0m08:26:31.942946 [info ] [MainThread]: 
[0m08:26:31.943630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:26:31.944139 [info ] [MainThread]: 
[0m08:26:31.944581 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:26:31.946090 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.496909, "process_user_time": 2.29835, "process_kernel_time": 0.204654, "process_mem_max_rss": "208536", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m08:26:31.946526 [debug] [MainThread]: Command `dbt test` succeeded at 08:26:31.946461 after 3.50 seconds
[0m08:26:31.946875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fef05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80abeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfe1670>]}
[0m08:26:31.947210 [debug] [MainThread]: Flushing usage events
[0m08:26:34.452386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ada840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92bb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ad89b0>]}


============================== 08:26:34.455946 | 12330e73-a50a-4e17-9d67-b7f460795ef0 ==============================
[0m08:26:34.455946 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:26:34.456367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:26:34.881802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fd8290>]}
[0m08:26:34.903647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7353770>]}
[0m08:26:34.904201 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:26:34.951223 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:26:35.019169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:26:35.019469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:26:35.041595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c16e150>]}
[0m08:26:35.098580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e722d0>]}
[0m08:26:35.098946 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m08:26:35.099264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e809b0>]}
[0m08:26:35.100383 [info ] [MainThread]: 
[0m08:26:35.100750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:26:35.103030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m08:26:35.109677 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m08:26:35.109935 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m08:26:35.110197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:35.508646 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.398 seconds
[0m08:26:35.512684 [debug] [ThreadPool]: On list_weather: Close
[0m08:26:35.634908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m08:26:35.647158 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m08:26:35.647748 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m08:26:35.648243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:36.059881 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.411 seconds
[0m08:26:36.063687 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m08:26:36.177398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m08:26:36.183959 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m08:26:36.184633 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m08:26:36.185153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:36.599961 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.414 seconds
[0m08:26:36.604207 [debug] [ThreadPool]: On list_weather_data: Close
[0m08:26:36.722666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97326bd0>]}
[0m08:26:36.724517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:36.725349 [info ] [MainThread]: 
[0m08:26:36.741189 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m08:26:36.742351 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m08:26:36.743078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m08:26:36.743573 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m08:26:36.751772 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m08:26:36.785680 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:36.785984 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:26:36.786267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:37.216865 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.431 seconds
[0m08:26:37.242219 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:37.242584 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:26:38.016862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m08:26:38.023788 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.024736 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:26:38.135171 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m08:26:38.140443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.141054 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:26:38.262412 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.121 seconds
[0m08:26:38.272891 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.273808 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:26:38.347146 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.073 seconds
[0m08:26:38.351175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.351630 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m08:26:38.429927 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m08:26:38.436533 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.436945 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m08:26:38.535193 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m08:26:38.549044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.549404 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:38.781569 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.232 seconds
[0m08:26:38.785544 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.786016 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:38.862251 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m08:26:38.863411 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.867248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.867861 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m08:26:38.974996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m08:26:38.976116 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:38.976905 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:26:39.547783 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.570 seconds
[0m08:26:39.549205 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m08:26:39.550029 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m08:26:39.852808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m08:26:39.868058 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m08:26:39.977788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ada390>]}
[0m08:26:39.979126 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 3.23s]
[0m08:26:39.980584 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m08:26:39.981384 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m08:26:39.982202 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m08:26:39.982825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m08:26:39.983317 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m08:26:39.986902 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m08:26:39.990885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:39.991311 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:26:39.991637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:40.687315 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.695 seconds
[0m08:26:40.699708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:40.700581 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:26:41.496940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m08:26:41.502885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:41.504179 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:26:41.593714 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m08:26:41.600033 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:41.600625 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:26:41.716071 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m08:26:41.722668 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:41.723584 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:26:41.848765 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.124 seconds
[0m08:26:41.856433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:41.857275 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m08:26:41.987461 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.129 seconds
[0m08:26:41.995714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:41.996748 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m08:26:42.086758 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m08:26:42.095493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:42.096288 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:42.415658 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.318 seconds
[0m08:26:42.418140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:42.418904 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:42.504932 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m08:26:42.506681 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m08:26:42.511016 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:42.511662 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m08:26:42.608831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m08:26:42.609547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:42.610103 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:26:43.143535 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.533 seconds
[0m08:26:43.144653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m08:26:43.145393 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m08:26:43.540387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m08:26:43.542581 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m08:26:43.649265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972a79b0>]}
[0m08:26:43.650327 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 0[0m in 3.67s]
[0m08:26:43.651282 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m08:26:43.652446 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m08:26:43.653062 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m08:26:43.653608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m08:26:43.654174 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m08:26:43.657551 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m08:26:43.660713 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:43.661114 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:26:43.661517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:44.116876 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.455 seconds
[0m08:26:44.126120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:44.126878 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:26:44.774619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m08:26:44.778584 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:44.779262 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:26:44.887657 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m08:26:44.894902 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:44.895752 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:26:45.013172 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.116 seconds
[0m08:26:45.020447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:45.021136 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:26:45.115690 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m08:26:45.123042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:45.123947 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m08:26:45.245124 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.120 seconds
[0m08:26:45.252929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:45.254025 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m08:26:45.472736 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.218 seconds
[0m08:26:45.483291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:45.484228 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:45.896032 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.411 seconds
[0m08:26:45.897821 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:45.898411 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:46.010182 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m08:26:46.011803 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m08:26:46.016850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:46.017741 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m08:26:46.127431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m08:26:46.128716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:46.129719 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:26:46.617043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.486 seconds
[0m08:26:46.619273 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m08:26:46.620446 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m08:26:46.870061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m08:26:46.875621 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m08:26:47.005432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972dc410>]}
[0m08:26:47.007662 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.35s]
[0m08:26:47.009244 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m08:26:47.010277 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m08:26:47.011229 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m08:26:47.012159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m08:26:47.012824 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m08:26:47.018823 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m08:26:47.023905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:47.024484 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:26:47.024991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:47.403888 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.378 seconds
[0m08:26:47.416031 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:47.417169 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:26:48.047267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m08:26:48.053052 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.053922 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:26:48.137728 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m08:26:48.145153 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.146078 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:26:48.224223 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m08:26:48.231872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.232610 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:26:48.354961 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m08:26:48.365917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.366774 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m08:26:48.445759 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.078 seconds
[0m08:26:48.450335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.450986 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m08:26:48.546669 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m08:26:48.553251 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.554015 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:48.746051 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.191 seconds
[0m08:26:48.747205 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.747583 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:48.849223 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m08:26:48.850081 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.852920 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.853358 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m08:26:48.980455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m08:26:48.981689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:48.982655 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:26:49.583332 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.600 seconds
[0m08:26:49.585489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m08:26:49.586421 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m08:26:49.815178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m08:26:49.817364 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m08:26:49.918935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972e9a30>]}
[0m08:26:49.920266 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 2.91s]
[0m08:26:49.921527 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m08:26:49.923118 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m08:26:49.923994 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m08:26:49.924715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m08:26:49.925253 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m08:26:49.929235 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m08:26:49.933573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:49.934169 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:26:49.934606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:50.424550 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.489 seconds
[0m08:26:50.432696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:50.433355 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m08:26:51.221759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m08:26:51.228203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.229083 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:26:51.326714 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m08:26:51.334735 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.335545 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:26:51.425819 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m08:26:51.433256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.434254 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:26:51.519981 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m08:26:51.524209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.524726 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m08:26:51.642728 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m08:26:51.653155 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.653926 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m08:26:51.734198 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.079 seconds
[0m08:26:51.743355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:51.744309 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:52.041509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.296 seconds
[0m08:26:52.129543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:52.129959 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:26:52.235532 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m08:26:52.236196 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m08:26:52.238197 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:52.238655 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m08:26:52.370098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m08:26:52.371482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:52.372305 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:26:53.068256 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.694 seconds
[0m08:26:53.069896 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m08:26:53.070668 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m08:26:53.473089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m08:26:53.475630 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m08:26:53.585755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12330e73-a50a-4e17-9d67-b7f460795ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb928b8c0>]}
[0m08:26:53.587458 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.66s]
[0m08:26:53.588459 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m08:26:53.590395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:53.590894 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m08:26:53.591345 [info ] [MainThread]: 
[0m08:26:53.591774 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 18.49 seconds (18.49s).
[0m08:26:53.593090 [debug] [MainThread]: Command end result
[0m08:26:53.626055 [info ] [MainThread]: 
[0m08:26:53.626591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:26:53.626896 [info ] [MainThread]: 
[0m08:26:53.627198 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:26:53.628829 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 19.214125, "process_user_time": 3.281259, "process_kernel_time": 0.282902, "process_mem_max_rss": "207752", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m08:26:53.629264 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:26:53.629190 after 19.21 seconds
[0m08:26:53.629579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972acc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972ada30>]}
[0m08:26:53.629876 [debug] [MainThread]: Flushing usage events
[0m19:16:37.245725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998bfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d64b0>]}


============================== 19:16:37.250755 | f6d02084-5fc1-421d-bd92-9cddf4d52818 ==============================
[0m19:16:37.250755 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:37.251154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:16:37.759450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc187d0>]}
[0m19:16:37.786557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1564b0>]}
[0m19:16:37.787387 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:37.845120 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:37.932878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:37.933169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:37.955610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d76c3b0>]}
[0m19:16:38.011204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d46e7e0>]}
[0m19:16:38.011495 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:16:38.011740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d74adb0>]}
[0m19:16:38.012705 [info ] [MainThread]: 
[0m19:16:38.013086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:38.015574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:16:38.022602 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:16:38.022833 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:16:38.023046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:38.548159 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.525 seconds
[0m19:16:38.551777 [debug] [ThreadPool]: On list_weather: Close
[0m19:16:38.683752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:16:38.696295 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:16:38.696879 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:16:38.697361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:39.263670 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.566 seconds
[0m19:16:39.271037 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:16:39.422308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m19:16:39.428033 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:16:39.428575 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:16:39.429034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:40.124104 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.695 seconds
[0m19:16:40.128432 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:16:40.263312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7f9e50>]}
[0m19:16:40.264340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:40.265222 [info ] [MainThread]: 
[0m19:16:40.278033 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:16:40.278762 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m19:16:40.279350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m19:16:40.279779 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:16:40.286410 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:16:40.288232 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:16:40.307881 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:16:40.309360 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:16:40.309722 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:16:40.310012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:41.435287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.124 seconds
[0m19:16:41.468367 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:16:41.597139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0d6db0>]}
[0m19:16:41.598728 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.32s]
[0m19:16:41.600097 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:16:41.602066 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m19:16:41.602892 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m19:16:41.603736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m19:16:41.604341 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m19:16:41.607922 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m19:16:41.612722 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m19:16:41.638197 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m19:16:41.640405 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m19:16:41.640768 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m19:16:41.641141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:42.968030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.326 seconds
[0m19:16:42.974412 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m19:16:43.110931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c940a10>]}
[0m19:16:43.113217 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.51s]
[0m19:16:43.114863 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m19:16:43.115879 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m19:16:43.116746 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m19:16:43.117463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m19:16:43.118200 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m19:16:43.123199 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m19:16:43.125685 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m19:16:43.128461 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m19:16:43.130958 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m19:16:43.131577 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m19:16:43.132052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:44.792090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m19:16:44.795818 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m19:16:44.949421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c864590>]}
[0m19:16:44.950412 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.83s]
[0m19:16:44.951112 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m19:16:44.951705 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m19:16:44.952311 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m19:16:44.952846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m19:16:44.953296 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m19:16:44.956367 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m19:16:44.957865 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m19:16:44.961285 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m19:16:44.963380 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m19:16:44.963835 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m19:16:44.964239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:46.486999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.522 seconds
[0m19:16:46.494544 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m19:16:46.613856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c879f40>]}
[0m19:16:46.616187 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.66s]
[0m19:16:46.617766 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m19:16:46.618952 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m19:16:46.620102 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m19:16:46.620826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m19:16:46.621386 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m19:16:46.627676 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m19:16:46.629832 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m19:16:46.632820 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m19:16:46.635211 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m19:16:46.635790 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m19:16:46.636255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:48.295297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.658 seconds
[0m19:16:48.301133 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m19:16:48.426466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c889880>]}
[0m19:16:48.428617 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.80s]
[0m19:16:48.430595 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m19:16:48.431817 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:16:48.432889 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:16:48.433793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m19:16:48.434529 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:16:48.438845 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:16:48.440519 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:16:48.443098 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:16:48.444992 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:16:48.445504 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:16:48.445937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:49.934073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.487 seconds
[0m19:16:49.941168 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:16:50.086276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c980d10>]}
[0m19:16:50.088416 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.65s]
[0m19:16:50.090050 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:16:50.091411 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:16:50.092380 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m19:16:50.093258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:16:50.093869 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:16:50.098491 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:16:50.100425 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:16:50.103261 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:16:50.105208 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:16:50.105635 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:16:50.106048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:51.366074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.259 seconds
[0m19:16:51.371594 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:16:51.519484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d02084-5fc1-421d-bd92-9cddf4d52818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4b2d20>]}
[0m19:16:51.521645 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.43s]
[0m19:16:51.523236 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:16:51.527527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:51.528181 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:16:51.529299 [info ] [MainThread]: 
[0m19:16:51.530299 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 13.52 seconds (13.52s).
[0m19:16:51.532650 [debug] [MainThread]: Command end result
[0m19:16:51.576250 [info ] [MainThread]: 
[0m19:16:51.576769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:51.577120 [info ] [MainThread]: 
[0m19:16:51.577457 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:16:51.579615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.358632, "process_user_time": 3.056393, "process_kernel_time": 0.277853, "process_mem_max_rss": "206840", "process_in_blocks": "11104", "process_out_blocks": "4183"}
[0m19:16:51.580176 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:51.580124 after 14.36 seconds
[0m19:16:51.580571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997d73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d51f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df505c0>]}
[0m19:16:51.580825 [debug] [MainThread]: Flushing usage events
[0m19:16:53.846145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ded820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9609bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fbde50>]}


============================== 19:16:53.849720 | 21195ef2-d372-4432-9212-e32ea22433a1 ==============================
[0m19:16:53.849720 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:53.850445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:54.261472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e23b30>]}
[0m19:16:54.283039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7953dd60>]}
[0m19:16:54.283479 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:54.325917 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:54.395578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:54.395876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:54.417602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79467740>]}
[0m19:16:54.477223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f4aed0>]}
[0m19:16:54.477520 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:16:54.477954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79472600>]}
[0m19:16:54.478848 [info ] [MainThread]: 
[0m19:16:54.479281 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:54.481452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m19:16:54.489370 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:16:54.489610 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:16:54.489862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:55.083392 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.593 seconds
[0m19:16:55.086177 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:16:55.214915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m19:16:55.216928 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:16:55.217192 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:16:55.217396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:55.764659 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.547 seconds
[0m19:16:55.767841 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:16:55.933145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21195ef2-d372-4432-9212-e32ea22433a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791b53a0>]}
[0m19:16:55.934467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:55.935586 [info ] [MainThread]: 
[0m19:16:55.948548 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:16:55.949232 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m19:16:55.949885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m19:16:55.950424 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:16:55.964694 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:16:55.967078 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:16:55.979547 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:16:55.980759 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:16:55.981126 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m19:16:55.981443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:56.892581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m19:16:56.904289 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m19:16:57.052596 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 1.10s]
[0m19:16:57.055037 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:16:57.056862 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:16:57.058289 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m19:16:57.059314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m19:16:57.060110 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:16:57.076364 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:16:57.078615 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:16:57.081507 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:16:57.083334 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:16:57.083866 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m19:16:57.084307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:57.658893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m19:16:57.664280 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m19:16:57.790779 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.73s]
[0m19:16:57.793229 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:16:57.804309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:57.805050 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m19:16:57.805846 [info ] [MainThread]: 
[0m19:16:57.806492 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m19:16:57.807835 [debug] [MainThread]: Command end result
[0m19:16:57.855643 [info ] [MainThread]: 
[0m19:16:57.856544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:57.856921 [info ] [MainThread]: 
[0m19:16:57.857406 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:16:57.859092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.051061, "process_user_time": 2.304938, "process_kernel_time": 0.141057, "process_mem_max_rss": "208428", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m19:16:57.859653 [debug] [MainThread]: Command `dbt test` succeeded at 19:16:57.859571 after 4.05 seconds
[0m19:16:57.860109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95924c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967c4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9588af30>]}
[0m19:16:57.860421 [debug] [MainThread]: Flushing usage events
[0m19:17:00.210230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb1ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebbe2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edf6ff0>]}


============================== 19:17:00.214232 | 93208d62-6ed5-419b-95ab-7cad158c8870 ==============================
[0m19:17:00.214232 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:17:00.214726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:00.621941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c27950>]}
[0m19:17:00.643819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef6f080>]}
[0m19:17:00.644257 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:17:00.687851 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:17:00.764537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:00.764965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:00.789574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e8f9b50>]}
[0m19:17:00.848035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e622f00>]}
[0m19:17:00.848365 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:17:00.848693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e606660>]}
[0m19:17:00.849804 [info ] [MainThread]: 
[0m19:17:00.850150 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:00.852363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:17:00.859045 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:17:00.859274 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:17:00.859465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:01.347423 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.488 seconds
[0m19:17:01.351789 [debug] [ThreadPool]: On list_weather: Close
[0m19:17:01.533197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m19:17:01.548563 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:17:01.549185 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:17:01.549722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:02.053831 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.504 seconds
[0m19:17:02.058467 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:17:02.195883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m19:17:02.199957 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:17:02.200459 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:17:02.200876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:02.719585 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.518 seconds
[0m19:17:02.723673 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:17:02.853016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e606750>]}
[0m19:17:02.853774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:02.854263 [info ] [MainThread]: 
[0m19:17:02.863507 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m19:17:02.864029 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m19:17:02.864492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m19:17:02.864868 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m19:17:02.870346 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m19:17:02.899612 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:02.899887 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:17:02.900108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:03.432777 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.532 seconds
[0m19:17:03.480711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:03.481263 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:17:04.948720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.466 seconds
[0m19:17:04.954258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:04.954935 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:17:05.063021 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.107 seconds
[0m19:17:05.066836 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.067344 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:17:05.176935 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m19:17:05.186202 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.186923 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:17:05.300652 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.113 seconds
[0m19:17:05.305343 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.305891 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:17:05.417810 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.111 seconds
[0m19:17:05.427765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.428486 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:17:05.554363 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m19:17:05.581746 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.582359 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:05.914885 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.331 seconds
[0m19:17:05.920944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:05.921556 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:06.054694 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.132 seconds
[0m19:17:06.057667 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m19:17:06.061831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:06.062415 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m19:17:06.228525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m19:17:06.229621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:06.231079 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:17:06.931279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m19:17:06.932820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:17:06.933798 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m19:17:07.337985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m19:17:07.363916 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m19:17:07.486483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f212480>]}
[0m19:17:07.490083 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 1[0m in 4.62s]
[0m19:17:07.491795 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m19:17:07.492739 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m19:17:07.493957 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m19:17:07.494694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m19:17:07.495225 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m19:17:07.499971 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m19:17:07.503815 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:07.504236 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:17:07.504712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:07.939551 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.434 seconds
[0m19:17:07.952999 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:07.953971 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:17:09.775510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.820 seconds
[0m19:17:09.781192 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:09.781686 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:17:09.902343 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.120 seconds
[0m19:17:09.914566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:09.915527 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:17:10.022144 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.106 seconds
[0m19:17:10.027348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.027914 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:17:10.136147 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.108 seconds
[0m19:17:10.139239 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.139646 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:17:10.266222 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.126 seconds
[0m19:17:10.271083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.271729 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:17:10.402856 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.130 seconds
[0m19:17:10.412278 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.413300 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:10.816703 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.403 seconds
[0m19:17:10.818122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.818552 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:10.948480 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m19:17:10.949956 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.954078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:10.954851 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m19:17:11.092088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m19:17:11.092981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:11.093657 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:17:11.743972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m19:17:11.745687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:17:11.746449 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m19:17:12.172760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m19:17:12.178515 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m19:17:12.409049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5dacfe90>]}
[0m19:17:12.411441 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 1[0m in 4.91s]
[0m19:17:12.412939 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m19:17:12.415986 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m19:17:12.418001 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m19:17:12.419027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m19:17:12.419719 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m19:17:12.425618 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m19:17:12.430332 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:12.430869 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:17:12.431308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:12.930664 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.499 seconds
[0m19:17:12.938755 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:12.939344 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:17:14.165781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.225 seconds
[0m19:17:14.178204 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.178659 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:17:14.308076 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.129 seconds
[0m19:17:14.313207 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.313952 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:17:14.392793 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m19:17:14.399316 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.399902 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:17:14.521609 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.121 seconds
[0m19:17:14.530449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.532034 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:17:14.631123 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m19:17:14.639766 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.640905 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:17:14.755698 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m19:17:14.765905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:14.767239 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:15.124324 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.355 seconds
[0m19:17:15.127243 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:15.127938 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:15.235261 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m19:17:15.236506 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m19:17:15.239192 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:15.239683 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m19:17:15.347082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m19:17:15.348248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:15.349092 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:17:16.146650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m19:17:16.148921 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:17:16.150086 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m19:17:16.659596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m19:17:16.665654 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m19:17:16.772508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5da3c7d0>]}
[0m19:17:16.774668 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 1[0m in 4.35s]
[0m19:17:16.776466 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m19:17:16.778207 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m19:17:16.779141 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m19:17:16.780002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m19:17:16.780560 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m19:17:16.785728 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m19:17:16.789609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:16.790058 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:17:16.790475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:17.258000 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.467 seconds
[0m19:17:17.270107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:17.271451 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:17:18.412490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.140 seconds
[0m19:17:18.417871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.418535 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:17:18.537737 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.118 seconds
[0m19:17:18.549229 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.550432 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:17:18.632133 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.081 seconds
[0m19:17:18.638426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.639324 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:17:18.728886 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m19:17:18.738667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.739517 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:17:18.882497 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.142 seconds
[0m19:17:18.885398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.885764 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:17:18.983093 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m19:17:18.986017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:18.986337 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:19.525464 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.538 seconds
[0m19:17:19.529527 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:19.530435 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:19.627939 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.097 seconds
[0m19:17:19.629373 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:19.634403 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:19.635207 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m19:17:19.788751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m19:17:19.790288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:19.791085 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:17:20.756363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.963 seconds
[0m19:17:20.758925 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:17:20.759644 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m19:17:21.111490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m19:17:21.115699 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m19:17:21.226956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5daf7740>]}
[0m19:17:21.228273 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 1[0m in 4.45s]
[0m19:17:21.229519 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m19:17:21.230312 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m19:17:21.231256 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m19:17:21.231991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m19:17:21.232542 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m19:17:21.236415 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m19:17:21.239822 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:21.240273 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:17:21.240693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:21.755172 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.514 seconds
[0m19:17:21.769482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:21.770648 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:17:22.933574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m19:17:22.937351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:22.937897 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:17:23.052007 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.113 seconds
[0m19:17:23.059489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:23.060245 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:17:23.212913 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.152 seconds
[0m19:17:23.217538 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:23.218107 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:17:23.335431 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m19:17:23.342438 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:23.343358 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:17:23.457579 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.113 seconds
[0m19:17:23.466457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:23.467255 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:17:23.596916 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.129 seconds
[0m19:17:23.605008 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:23.605886 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:23.932506 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.326 seconds
[0m19:17:24.032397 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:24.032806 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:17:24.108725 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m19:17:24.109247 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m19:17:24.112085 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:24.112469 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m19:17:24.321534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m19:17:24.322708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:24.323501 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:17:25.258554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.934 seconds
[0m19:17:25.259337 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:17:25.259887 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m19:17:25.762493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m19:17:25.765637 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m19:17:25.883159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93208d62-6ed5-419b-95ab-7cad158c8870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e7481a0>]}
[0m19:17:25.883876 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 1[0m in 4.65s]
[0m19:17:25.884479 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m19:17:25.886108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:25.886460 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m19:17:25.886750 [info ] [MainThread]: 
[0m19:17:25.887108 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 25.04 seconds (25.04s).
[0m19:17:25.888014 [debug] [MainThread]: Command end result
[0m19:17:25.911219 [info ] [MainThread]: 
[0m19:17:25.911867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:25.912359 [info ] [MainThread]: 
[0m19:17:25.912650 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:17:25.913650 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 25.745346, "process_user_time": 3.399788, "process_kernel_time": 0.273511, "process_mem_max_rss": "207620", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m19:17:25.913941 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:17:25.913888 after 25.75 seconds
[0m19:17:25.914229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4b2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed7af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb1b200>]}
[0m19:17:25.914592 [debug] [MainThread]: Flushing usage events
[0m19:23:11.082729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911f1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe29bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe2b230>]}


============================== 19:23:11.087236 | 5208e5ca-18cc-4abd-824a-8c5dfa0c69b2 ==============================
[0m19:23:11.087236 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:11.087685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:11.561265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5df920>]}
[0m19:23:11.583092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f7d71d0>]}
[0m19:23:11.583563 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:11.628393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:11.704638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:11.704952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:11.727847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7da090>]}
[0m19:23:11.794622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f2bff50>]}
[0m19:23:11.795045 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:23:11.795348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5147a0>]}
[0m19:23:11.796406 [info ] [MainThread]: 
[0m19:23:11.796825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:11.799310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:23:11.807280 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:23:11.807530 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:23:11.807776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:12.363592 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.555 seconds
[0m19:23:12.367658 [debug] [ThreadPool]: On list_weather: Close
[0m19:23:12.532137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m19:23:12.544184 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:23:12.544845 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:23:12.545421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:13.091905 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.546 seconds
[0m19:23:13.095596 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:23:13.225490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m19:23:13.231405 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:23:13.232467 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:23:13.233292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:13.785935 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.553 seconds
[0m19:23:13.789615 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:23:13.937796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5dd070>]}
[0m19:23:13.939884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:13.940776 [info ] [MainThread]: 
[0m19:23:13.955696 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m19:23:13.956642 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m19:23:13.957467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m19:23:13.958153 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m19:23:13.967830 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m19:23:13.970030 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m19:23:13.995358 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m19:23:13.997199 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m19:23:13.997611 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m19:23:13.998001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:14.952711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m19:23:14.972196 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m19:23:15.103370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f844c80>]}
[0m19:23:15.104152 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.15s]
[0m19:23:15.105138 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m19:23:15.106147 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m19:23:15.106596 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m19:23:15.107046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m19:23:15.107361 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m19:23:15.109259 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m19:23:15.111286 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m19:23:15.123581 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m19:23:15.124798 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m19:23:15.125091 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m19:23:15.125359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:16.386595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m19:23:16.389165 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m19:23:16.500865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e608e30>]}
[0m19:23:16.501741 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.39s]
[0m19:23:16.502343 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m19:23:16.502782 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m19:23:16.503185 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m19:23:16.503529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m19:23:16.503814 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m19:23:16.505915 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m19:23:16.506712 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m19:23:16.508246 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m19:23:16.509341 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m19:23:16.509585 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m19:23:16.509838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:18.031558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m19:23:18.041803 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m19:23:18.172477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e674920>]}
[0m19:23:18.174693 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.67s]
[0m19:23:18.176437 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m19:23:18.178647 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m19:23:18.179939 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m19:23:18.180990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m19:23:18.181634 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m19:23:18.188487 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m19:23:18.190370 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m19:23:18.193177 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m19:23:18.195234 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m19:23:18.195613 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m19:23:18.196079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:19.569346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.373 seconds
[0m19:23:19.572282 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m19:23:19.691502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e676630>]}
[0m19:23:19.693375 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.51s]
[0m19:23:19.695112 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m19:23:19.696020 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m19:23:19.696903 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m19:23:19.697625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m19:23:19.698940 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m19:23:19.703812 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m19:23:19.706705 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m19:23:19.709801 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m19:23:19.712980 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m19:23:19.713467 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m19:23:19.713900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:21.106127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m19:23:21.111133 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m19:23:21.256699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f0b8230>]}
[0m19:23:21.258152 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.56s]
[0m19:23:21.259309 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m19:23:21.260244 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m19:23:21.261131 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m19:23:21.261939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m19:23:21.262556 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m19:23:21.266477 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m19:23:21.268230 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m19:23:21.270916 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m19:23:21.272917 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m19:23:21.273373 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m19:23:21.273879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:22.738061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.464 seconds
[0m19:23:22.743221 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m19:23:22.889188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93236fc0>]}
[0m19:23:22.891354 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.63s]
[0m19:23:22.892830 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m19:23:22.893797 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m19:23:22.894776 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m19:23:22.895613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m19:23:22.896845 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m19:23:22.901557 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m19:23:22.904211 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m19:23:22.907268 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m19:23:22.909244 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m19:23:22.909753 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m19:23:22.910228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:24.174050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.263 seconds
[0m19:23:24.178553 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m19:23:24.305458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5208e5ca-18cc-4abd-824a-8c5dfa0c69b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6a81d0>]}
[0m19:23:24.306472 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m19:23:24.307328 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m19:23:24.310453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:24.311054 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m19:23:24.311847 [info ] [MainThread]: 
[0m19:23:24.312482 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m19:23:24.314099 [debug] [MainThread]: Command end result
[0m19:23:24.349549 [info ] [MainThread]: 
[0m19:23:24.349919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:24.350179 [info ] [MainThread]: 
[0m19:23:24.350464 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:23:24.352157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.318614, "process_user_time": 2.879758, "process_kernel_time": 0.260055, "process_mem_max_rss": "206740", "process_out_blocks": "1999", "process_in_blocks": "0"}
[0m19:23:24.352668 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:24.352597 after 13.32 seconds
[0m19:23:24.353094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fca1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f40cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f92cc20>]}
[0m19:23:24.353369 [debug] [MainThread]: Flushing usage events
[0m19:23:26.683265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98195be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a811160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983c37a0>]}


============================== 19:23:26.686831 | 58f4f827-4b9c-43ba-adbb-575b8e0371c4 ==============================
[0m19:23:26.686831 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:26.687493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:27.180356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b7e120>]}
[0m19:23:27.202864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98992060>]}
[0m19:23:27.203357 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:27.250566 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:27.321402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:27.321711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:27.343399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77789580>]}
[0m19:23:27.411204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff772873b0>]}
[0m19:23:27.411533 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:23:27.412051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774a9f40>]}
[0m19:23:27.413066 [info ] [MainThread]: 
[0m19:23:27.413506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:27.415852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m19:23:27.423714 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:23:27.423976 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:23:27.424229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:28.015081 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.590 seconds
[0m19:23:28.020993 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:23:28.161457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m19:23:28.168388 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:23:28.169138 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:23:28.169712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:28.652335 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.483 seconds
[0m19:23:28.655393 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:23:28.783273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f4f827-4b9c-43ba-adbb-575b8e0371c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77874e00>]}
[0m19:23:28.784557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:28.786890 [info ] [MainThread]: 
[0m19:23:28.799634 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:23:28.800298 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m19:23:28.801129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m19:23:28.801574 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:23:28.815562 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:23:28.817180 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:23:28.829509 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:23:28.830605 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m19:23:28.830926 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m19:23:28.831224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:29.357560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m19:23:29.366148 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m19:23:29.504026 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.70s]
[0m19:23:29.506146 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m19:23:29.506656 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:23:29.507134 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m19:23:29.507747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m19:23:29.508104 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:23:29.513160 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:23:29.514239 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:23:29.515814 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:23:29.516897 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m19:23:29.517200 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m19:23:29.517478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:30.113287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m19:23:30.117919 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m19:23:30.254608 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.75s]
[0m19:23:30.257193 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m19:23:30.260429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:30.261237 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m19:23:30.261920 [info ] [MainThread]: 
[0m19:23:30.263336 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m19:23:30.265380 [debug] [MainThread]: Command end result
[0m19:23:30.306851 [info ] [MainThread]: 
[0m19:23:30.307624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:30.308094 [info ] [MainThread]: 
[0m19:23:30.308511 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:23:30.309907 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.665045, "process_user_time": 2.392414, "process_kernel_time": 0.228732, "process_mem_max_rss": "208524", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m19:23:30.310512 [debug] [MainThread]: Command `dbt test` succeeded at 19:23:30.310413 after 3.67 seconds
[0m19:23:30.310980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98195be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983c0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db77a70>]}
[0m19:23:30.311295 [debug] [MainThread]: Flushing usage events
[0m19:23:32.735068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a0d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7630320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76300b0>]}


============================== 19:23:32.738768 | 0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b ==============================
[0m19:23:32.738768 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:32.739229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:33.157674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9147e00>]}
[0m19:23:33.179154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b76cc0>]}
[0m19:23:33.179610 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:33.223400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:33.293705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:33.294004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:33.316268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87923ce0>]}
[0m19:23:33.371592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877a3290>]}
[0m19:23:33.371899 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m19:23:33.372143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c7e060>]}
[0m19:23:33.373134 [info ] [MainThread]: 
[0m19:23:33.373507 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:33.375683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m19:23:33.382420 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m19:23:33.382655 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m19:23:33.382859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:34.013916 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m19:23:34.015570 [debug] [ThreadPool]: On list_weather: Close
[0m19:23:34.172652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m19:23:34.178021 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m19:23:34.178343 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m19:23:34.178637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:34.679404 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.500 seconds
[0m19:23:34.685049 [debug] [ThreadPool]: On list_weather_data: Close
[0m19:23:34.827947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m19:23:34.834278 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m19:23:34.835069 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m19:23:34.835499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:35.364801 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.529 seconds
[0m19:23:35.369501 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m19:23:35.575017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87870aa0>]}
[0m19:23:35.576264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:35.576785 [info ] [MainThread]: 
[0m19:23:35.587976 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m19:23:35.588652 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m19:23:35.589146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m19:23:35.589960 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m19:23:35.598002 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m19:23:35.622469 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:35.622756 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:23:35.622996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:36.035727 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.412 seconds
[0m19:23:36.085132 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:36.085640 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:23:37.280626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.194 seconds
[0m19:23:37.289079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:37.290262 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:23:37.414138 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.123 seconds
[0m19:23:37.422107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:37.422853 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:23:37.622074 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.199 seconds
[0m19:23:37.629645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:37.630406 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:23:37.725662 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m19:23:37.730684 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:37.731310 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m19:23:37.859486 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.127 seconds
[0m19:23:37.874001 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:37.874788 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m19:23:38.004290 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.129 seconds
[0m19:23:38.031774 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:38.032332 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:38.301471 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.268 seconds
[0m19:23:38.308388 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:38.309134 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:38.421638 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.112 seconds
[0m19:23:38.423000 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m19:23:38.426421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:38.427166 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m19:23:38.710997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m19:23:38.711681 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:38.712052 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:23:39.430760 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.718 seconds
[0m19:23:39.432956 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m19:23:39.434411 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m19:23:39.840452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m19:23:39.869289 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m19:23:40.013117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ad88f0>]}
[0m19:23:40.014898 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 14[0m in 4.42s]
[0m19:23:40.016095 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m19:23:40.016937 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m19:23:40.018092 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m19:23:40.018754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m19:23:40.019214 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m19:23:40.023327 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m19:23:40.026982 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:40.027410 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:23:40.027852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:40.596335 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.568 seconds
[0m19:23:40.609106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:40.610015 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:23:41.783775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m19:23:41.787206 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:41.787687 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:23:41.882674 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m19:23:41.887792 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:41.888272 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:23:42.194335 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.305 seconds
[0m19:23:42.201436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:42.202439 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:23:42.505419 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.302 seconds
[0m19:23:42.510723 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:42.511668 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m19:23:42.610168 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.098 seconds
[0m19:23:42.618113 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:42.619600 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m19:23:42.767203 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.147 seconds
[0m19:23:42.774342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:42.775063 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:43.219654 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.443 seconds
[0m19:23:43.222451 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:43.223306 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:43.373440 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.149 seconds
[0m19:23:43.375320 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m19:23:43.379303 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:43.379907 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m19:23:43.531733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m19:23:43.533168 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:43.533881 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:23:44.346958 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.812 seconds
[0m19:23:44.348373 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m19:23:44.349155 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m19:23:44.855046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m19:23:44.857067 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m19:23:44.964125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869b8860>]}
[0m19:23:44.965351 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 14[0m in 4.94s]
[0m19:23:44.966770 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m19:23:44.967569 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m19:23:44.968293 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m19:23:44.968897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m19:23:44.969413 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m19:23:44.973269 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m19:23:44.976797 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:44.977197 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:23:44.977576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:45.615090 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.637 seconds
[0m19:23:45.621513 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:45.622098 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:23:46.756094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m19:23:46.760612 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:46.761287 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:23:46.905962 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.144 seconds
[0m19:23:46.910255 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:46.910812 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:23:47.029824 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.118 seconds
[0m19:23:47.039175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.039921 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:23:47.180338 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.140 seconds
[0m19:23:47.187411 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.188194 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m19:23:47.282272 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m19:23:47.290133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.290937 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m19:23:47.405580 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m19:23:47.415001 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.415911 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:47.720928 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.304 seconds
[0m19:23:47.722339 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.722828 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:47.803500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m19:23:47.804535 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.807616 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.808255 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m19:23:47.968313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m19:23:47.969503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:47.970033 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:23:48.848960 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.878 seconds
[0m19:23:48.849914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m19:23:48.850562 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m19:23:49.263142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m19:23:49.269231 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m19:23:49.422729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869e0440>]}
[0m19:23:49.425138 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 14[0m in 4.45s]
[0m19:23:49.426875 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m19:23:49.428155 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m19:23:49.429401 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m19:23:49.430513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m19:23:49.431266 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m19:23:49.437415 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m19:23:49.442203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:49.442754 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:23:49.443261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:50.000643 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.557 seconds
[0m19:23:50.013058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:50.013998 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:23:51.186495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m19:23:51.194617 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.195808 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:23:51.284300 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m19:23:51.291102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.291967 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:23:51.391426 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.099 seconds
[0m19:23:51.396512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.397285 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:23:51.560056 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.162 seconds
[0m19:23:51.571570 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.572391 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m19:23:51.669602 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.096 seconds
[0m19:23:51.677335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.678373 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m19:23:51.810190 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.131 seconds
[0m19:23:51.814651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:51.815100 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:52.093367 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.277 seconds
[0m19:23:52.096550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:52.097315 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:52.180001 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m19:23:52.182797 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:52.188152 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:52.189031 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m19:23:52.377018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m19:23:52.378367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:52.379334 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:23:53.154956 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.774 seconds
[0m19:23:53.156796 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m19:23:53.157608 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m19:23:53.615796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m19:23:53.620374 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m19:23:53.751298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869d7290>]}
[0m19:23:53.753508 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 14[0m in 4.32s]
[0m19:23:53.754837 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m19:23:53.755946 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m19:23:53.757058 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m19:23:53.757916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m19:23:53.758628 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m19:23:53.763454 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m19:23:53.768003 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:53.768537 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:23:53.768958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:54.457244 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.688 seconds
[0m19:23:54.462929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:54.463803 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:23:55.498419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.034 seconds
[0m19:23:55.504221 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:55.504816 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:23:55.615050 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.110 seconds
[0m19:23:55.620412 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:55.621145 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:23:55.798253 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.176 seconds
[0m19:23:55.805792 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:55.806622 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:23:55.997275 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.190 seconds
[0m19:23:56.004505 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.005296 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m19:23:56.129025 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.123 seconds
[0m19:23:56.139119 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.139915 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m19:23:56.275679 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.135 seconds
[0m19:23:56.282575 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.283216 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:56.503232 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.219 seconds
[0m19:23:56.578547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.579096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:56.702295 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.123 seconds
[0m19:23:56.702844 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.704720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.705077 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m19:23:56.985591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m19:23:56.986711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:56.987389 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:23:57.871070 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.882 seconds
[0m19:23:57.872166 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m19:23:57.872660 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m19:23:58.274228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m19:23:58.281609 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m19:23:58.560958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1b93cf-8d3b-45ce-88b1-e7d9ef3c535b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874333b0>]}
[0m19:23:58.563660 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 14[0m in 4.80s]
[0m19:23:58.565345 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m19:23:58.577656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:58.578417 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m19:23:58.579969 [info ] [MainThread]: 
[0m19:23:58.580751 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 25.21 seconds (25.21s).
[0m19:23:58.582403 [debug] [MainThread]: Command end result
[0m19:23:58.615982 [info ] [MainThread]: 
[0m19:23:58.616394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:58.616672 [info ] [MainThread]: 
[0m19:23:58.616962 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:23:58.618157 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 25.922297, "process_user_time": 3.368052, "process_kernel_time": 0.274881, "process_mem_max_rss": "207640", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m19:23:58.618581 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:23:58.618502 after 25.92 seconds
[0m19:23:58.618871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4a3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7e0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0c6a80>]}
[0m19:23:58.619127 [debug] [MainThread]: Flushing usage events
[0m18:45:08.946007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9501f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c2ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c2dbe0>]}


============================== 18:45:08.950343 | 7662bd7a-7a53-4d83-866e-abb6de793a74 ==============================
[0m18:45:08.950343 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:45:08.950755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:09.562346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73af9ca0>]}
[0m18:45:09.597820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73ca8620>]}
[0m18:45:09.598512 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:45:09.661027 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:45:09.825749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:09.826158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:09.863090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3a6510>]}
[0m18:45:09.995918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff736daba0>]}
[0m18:45:09.996712 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m18:45:09.997057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d07230>]}
[0m18:45:09.999257 [info ] [MainThread]: 
[0m18:45:09.999865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:10.002942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m18:45:10.010872 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m18:45:10.011129 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m18:45:10.011375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:10.500455 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.489 seconds
[0m18:45:10.505114 [debug] [ThreadPool]: On list_weather: Close
[0m18:45:10.635463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m18:45:10.643521 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m18:45:10.643945 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m18:45:10.644334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:11.251524 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.607 seconds
[0m18:45:11.254525 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m18:45:11.382075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m18:45:11.384516 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m18:45:11.384809 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m18:45:11.385065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:11.870885 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.485 seconds
[0m18:45:11.882068 [debug] [ThreadPool]: On list_weather_data: Close
[0m18:45:12.009166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dd4ce0>]}
[0m18:45:12.011756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:12.012701 [info ] [MainThread]: 
[0m18:45:12.054009 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m18:45:12.058001 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m18:45:12.060511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m18:45:12.061012 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m18:45:12.074247 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m18:45:12.076428 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m18:45:12.104291 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m18:45:12.112921 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m18:45:12.114096 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.data.daily_weather
)

SELECT * FROM weather_data
  );
[0m18:45:12.114983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:13.230564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m18:45:13.282686 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m18:45:13.431324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940d6e70>]}
[0m18:45:13.433285 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.37s]
[0m18:45:13.435269 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m18:45:13.440300 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m18:45:13.440889 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m18:45:13.441525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m18:45:13.441956 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m18:45:13.446897 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m18:45:13.449575 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m18:45:13.465753 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m18:45:13.467417 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m18:45:13.467759 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m18:45:13.468043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:14.758702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.290 seconds
[0m18:45:14.763993 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m18:45:14.889753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72960830>]}
[0m18:45:14.891220 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.45s]
[0m18:45:14.892050 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m18:45:14.892616 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m18:45:14.893302 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m18:45:14.893858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m18:45:14.894264 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m18:45:14.897213 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m18:45:14.898697 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m18:45:14.900244 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m18:45:14.901735 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m18:45:14.902012 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m18:45:14.902349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:16.500097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m18:45:16.515745 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m18:45:16.628813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72871f40>]}
[0m18:45:16.631016 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.73s]
[0m18:45:16.633812 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m18:45:16.637020 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m18:45:16.640638 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m18:45:16.641530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m18:45:16.642170 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m18:45:16.648420 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m18:45:16.650319 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m18:45:16.656581 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m18:45:16.658435 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m18:45:16.658836 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m18:45:16.659232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:17.930827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m18:45:17.933382 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m18:45:18.050454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72870e30>]}
[0m18:45:18.051563 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m18:45:18.052940 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m18:45:18.053796 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m18:45:18.054636 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m18:45:18.055493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m18:45:18.056147 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m18:45:18.059787 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m18:45:18.061543 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m18:45:18.063971 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m18:45:18.065826 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m18:45:18.066258 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m18:45:18.066762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:19.466815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m18:45:19.471873 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m18:45:19.604351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72870470>]}
[0m18:45:19.605394 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.55s]
[0m18:45:19.606026 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m18:45:19.606506 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m18:45:19.607089 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m18:45:19.607578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m18:45:19.607982 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m18:45:19.610407 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m18:45:19.611731 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m18:45:19.613522 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m18:45:19.614701 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m18:45:19.615013 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m18:45:19.615299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:20.903851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.287 seconds
[0m18:45:20.914468 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m18:45:21.039923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7284cce0>]}
[0m18:45:21.041160 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.43s]
[0m18:45:21.042201 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m18:45:21.042913 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m18:45:21.044055 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m18:45:21.044827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m18:45:21.045147 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m18:45:21.053365 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m18:45:21.054548 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m18:45:21.056462 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m18:45:21.057631 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m18:45:21.057960 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m18:45:21.058214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:22.132406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.074 seconds
[0m18:45:22.137299 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m18:45:22.254803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7662bd7a-7a53-4d83-866e-abb6de793a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72872de0>]}
[0m18:45:22.256348 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m18:45:22.258050 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m18:45:22.262980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:22.264194 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m18:45:22.266595 [info ] [MainThread]: 
[0m18:45:22.267218 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 12.27 seconds (12.27s).
[0m18:45:22.268559 [debug] [MainThread]: Command end result
[0m18:45:22.302891 [info ] [MainThread]: 
[0m18:45:22.303242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:22.303488 [info ] [MainThread]: 
[0m18:45:22.303770 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:45:22.305650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.385031, "process_user_time": 3.30531, "process_kernel_time": 0.275106, "process_mem_max_rss": "206676", "process_in_blocks": "11104", "process_out_blocks": "4183"}
[0m18:45:22.306187 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:22.306125 after 13.39 seconds
[0m18:45:22.306562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937d3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73643a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73643b90>]}
[0m18:45:22.306802 [debug] [MainThread]: Flushing usage events
[0m18:45:25.436736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99439ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99439cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99684bf0>]}


============================== 18:45:25.440851 | 1bd155b9-2f6b-461c-86ce-bb2d5037c1d3 ==============================
[0m18:45:25.440851 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:45:25.442558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:45:25.900775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbdaf60>]}
[0m18:45:25.923310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce591c0>]}
[0m18:45:25.923833 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:45:25.968493 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:45:26.037953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:26.038232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:26.060575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b29d30>]}
[0m18:45:26.133929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c566d50>]}
[0m18:45:26.134237 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m18:45:26.134682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98766db0>]}
[0m18:45:26.135617 [info ] [MainThread]: 
[0m18:45:26.136127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:26.138406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m18:45:26.146755 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m18:45:26.147006 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m18:45:26.147230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:26.627556 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.480 seconds
[0m18:45:26.632333 [debug] [ThreadPool]: On list_weather_data: Close
[0m18:45:26.810423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m18:45:26.815706 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m18:45:26.816320 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m18:45:26.816768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:27.330064 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m18:45:27.338516 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m18:45:27.462198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd155b9-2f6b-461c-86ce-bb2d5037c1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2a53d0>]}
[0m18:45:27.462854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:27.463960 [info ] [MainThread]: 
[0m18:45:27.471095 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m18:45:27.471605 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m18:45:27.472421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m18:45:27.472885 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m18:45:27.489430 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m18:45:27.492449 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m18:45:27.505866 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m18:45:27.507387 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m18:45:27.507721 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m18:45:27.508009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:28.089047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m18:45:28.106302 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m18:45:28.224984 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.75s]
[0m18:45:28.225831 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m18:45:28.226199 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m18:45:28.226637 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m18:45:28.227430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m18:45:28.227891 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m18:45:28.232904 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m18:45:28.234549 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m18:45:28.237037 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m18:45:28.238313 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m18:45:28.238577 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:28.238835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:28.744845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m18:45:28.750562 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m18:45:28.894855 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.67s]
[0m18:45:28.898561 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m18:45:28.900729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:28.901170 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m18:45:28.901606 [info ] [MainThread]: 
[0m18:45:28.902107 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m18:45:28.903182 [debug] [MainThread]: Command end result
[0m18:45:28.934516 [info ] [MainThread]: 
[0m18:45:28.934914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:28.935212 [info ] [MainThread]: 
[0m18:45:28.935530 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:45:28.937277 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5422115, "process_user_time": 2.386313, "process_kernel_time": 0.265812, "process_mem_max_rss": "208536", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m18:45:28.937838 [debug] [MainThread]: Command `dbt test` succeeded at 18:45:28.937735 after 3.54 seconds
[0m18:45:28.938259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9953e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995ce3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f4fad0>]}
[0m18:45:28.938717 [debug] [MainThread]: Flushing usage events
[0m18:45:30.888528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b62780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a77b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b61160>]}


============================== 18:45:30.892418 | 3283f12c-e144-4128-b43e-a1d9c523c4a8 ==============================
[0m18:45:30.892418 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:45:30.892870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m18:45:31.326426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f276060>]}
[0m18:45:31.349991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dbed6a0>]}
[0m18:45:31.350431 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:45:31.395335 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:45:31.463863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:31.464148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:31.487305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d92dee0>]}
[0m18:45:31.546915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d62e060>]}
[0m18:45:31.547230 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m18:45:31.547492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f276090>]}
[0m18:45:31.548562 [info ] [MainThread]: 
[0m18:45:31.548927 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:31.551000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m18:45:31.560362 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m18:45:31.560627 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m18:45:31.560873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:32.053654 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.492 seconds
[0m18:45:32.057866 [debug] [ThreadPool]: On list_weather: Close
[0m18:45:32.196929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m18:45:32.208929 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m18:45:32.209721 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m18:45:32.210260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:32.739028 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.528 seconds
[0m18:45:32.745300 [debug] [ThreadPool]: On list_weather_data: Close
[0m18:45:32.888171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m18:45:32.894389 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m18:45:32.894997 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m18:45:32.895483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:33.404841 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.509 seconds
[0m18:45:33.408682 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m18:45:33.534575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1254f0>]}
[0m18:45:33.535448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:33.536062 [info ] [MainThread]: 
[0m18:45:33.547102 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m18:45:33.547707 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m18:45:33.548235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m18:45:33.548866 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m18:45:33.559173 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m18:45:33.605427 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:33.606014 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m18:45:33.606331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:34.079970 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.473 seconds
[0m18:45:34.124126 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:34.124643 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:45:35.347358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.222 seconds
[0m18:45:35.354760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:35.355873 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m18:45:35.559439 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.203 seconds
[0m18:45:35.570073 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:35.571343 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m18:45:35.721734 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.149 seconds
[0m18:45:35.727499 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:35.728105 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m18:45:35.828443 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.100 seconds
[0m18:45:35.832698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:35.833239 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m18:45:35.953611 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.120 seconds
[0m18:45:35.965058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:35.965640 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m18:45:36.079157 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.113 seconds
[0m18:45:36.098856 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:36.099345 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:36.570115 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.470 seconds
[0m18:45:36.576593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:36.577529 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:36.670180 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m18:45:36.672251 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m18:45:36.676719 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:36.677474 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m18:45:36.863040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m18:45:36.863780 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:36.864326 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:37.486786 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.622 seconds
[0m18:45:37.487374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m18:45:37.487747 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m18:45:37.896933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m18:45:37.914963 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m18:45:38.051264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2ba570>]}
[0m18:45:38.053198 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 3[0m in 4.50s]
[0m18:45:38.054751 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m18:45:38.055747 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m18:45:38.056802 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m18:45:38.057613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m18:45:38.058367 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m18:45:38.063134 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m18:45:38.067681 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:38.068167 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m18:45:38.068597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:38.538210 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.469 seconds
[0m18:45:38.549151 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:38.550049 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:45:39.696350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.145 seconds
[0m18:45:39.703764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:39.705088 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m18:45:39.826288 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.120 seconds
[0m18:45:39.832683 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:39.833269 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m18:45:39.923730 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.090 seconds
[0m18:45:39.926176 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:39.926507 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m18:45:40.048854 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m18:45:40.051460 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.051795 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m18:45:40.152023 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.100 seconds
[0m18:45:40.158463 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.159297 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m18:45:40.331297 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.171 seconds
[0m18:45:40.340106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.341010 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:40.625628 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.284 seconds
[0m18:45:40.626847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.627215 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:40.735250 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m18:45:40.736738 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.740241 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.740843 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m18:45:40.875162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m18:45:40.876153 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:40.876962 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:41.487825 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.610 seconds
[0m18:45:41.489760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m18:45:41.490762 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m18:45:41.997395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m18:45:42.004972 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m18:45:42.131034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cb6e630>]}
[0m18:45:42.133160 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 3[0m in 4.07s]
[0m18:45:42.135198 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m18:45:42.136769 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m18:45:42.138936 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m18:45:42.140082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m18:45:42.140981 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m18:45:42.155557 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m18:45:42.161350 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:42.164878 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m18:45:42.165569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:42.621310 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.456 seconds
[0m18:45:42.627005 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:42.627406 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:45:43.875251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.247 seconds
[0m18:45:43.889275 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:43.890264 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m18:45:44.007923 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m18:45:44.012361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.012907 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m18:45:44.137216 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.124 seconds
[0m18:45:44.146696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.147634 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m18:45:44.271931 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.123 seconds
[0m18:45:44.279375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.280243 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m18:45:44.403058 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m18:45:44.412050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.413186 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m18:45:44.544163 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.130 seconds
[0m18:45:44.554515 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.555454 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:44.962079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.406 seconds
[0m18:45:44.963736 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:44.964255 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:45.093155 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.128 seconds
[0m18:45:45.095712 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m18:45:45.100722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:45.101486 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m18:45:45.233497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m18:45:45.234952 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:45.235836 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:45.865463 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.628 seconds
[0m18:45:45.867056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m18:45:45.867961 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m18:45:46.299504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m18:45:46.311831 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m18:45:46.445597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c9019a0>]}
[0m18:45:46.448651 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 3[0m in 4.30s]
[0m18:45:46.451944 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m18:45:46.456714 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m18:45:46.458360 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m18:45:46.459198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m18:45:46.459909 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m18:45:46.467188 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m18:45:46.472455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:46.472858 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m18:45:46.473202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:47.012859 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.539 seconds
[0m18:45:47.021364 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:47.022046 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:45:48.449487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m18:45:48.453074 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.453551 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m18:45:48.535826 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m18:45:48.538370 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.538741 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m18:45:48.641425 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.102 seconds
[0m18:45:48.647863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.648778 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m18:45:48.739015 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m18:45:48.750049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.751167 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m18:45:48.829174 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m18:45:48.835458 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.836254 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m18:45:48.958870 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m18:45:48.968127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:48.969114 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:49.216062 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m18:45:49.219557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:49.220402 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:49.319583 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m18:45:49.321650 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:49.326509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:49.327270 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m18:45:49.449974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m18:45:49.451171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:49.452053 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:50.087599 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.635 seconds
[0m18:45:50.088271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m18:45:50.088633 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m18:45:50.413745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m18:45:50.418948 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m18:45:50.543079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c91fc80>]}
[0m18:45:50.545954 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 3[0m in 4.08s]
[0m18:45:50.547521 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m18:45:50.548467 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m18:45:50.549519 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m18:45:50.550490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m18:45:50.551357 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m18:45:50.556459 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m18:45:50.560891 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:50.561444 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m18:45:50.561933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:51.032577 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.470 seconds
[0m18:45:51.041734 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:51.042591 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:45:52.344397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.301 seconds
[0m18:45:52.351929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.353008 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m18:45:52.430161 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.076 seconds
[0m18:45:52.436881 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.437821 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m18:45:52.546268 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m18:45:52.549255 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.549630 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m18:45:52.634851 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m18:45:52.642124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.643351 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m18:45:52.759059 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.115 seconds
[0m18:45:52.767038 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.767649 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m18:45:52.874640 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.106 seconds
[0m18:45:52.884046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:52.885145 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:53.214773 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.328 seconds
[0m18:45:53.326447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:53.326859 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:45:53.418351 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.091 seconds
[0m18:45:53.419023 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m18:45:53.420922 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:53.421293 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m18:45:53.618898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m18:45:53.620238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:53.621096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:45:54.490350 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.868 seconds
[0m18:45:54.492430 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m18:45:54.493207 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m18:45:54.899742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m18:45:54.905984 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m18:45:55.017208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3283f12c-e144-4128-b43e-a1d9c523c4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a77d70>]}
[0m18:45:55.018756 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 3[0m in 4.47s]
[0m18:45:55.020106 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m18:45:55.023624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:55.024270 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m18:45:55.025858 [info ] [MainThread]: 
[0m18:45:55.026440 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 23.48 seconds (23.48s).
[0m18:45:55.028122 [debug] [MainThread]: Command end result
[0m18:45:55.066239 [info ] [MainThread]: 
[0m18:45:55.066652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:55.066900 [info ] [MainThread]: 
[0m18:45:55.067200 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:45:55.068498 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 24.21835, "process_user_time": 3.510894, "process_kernel_time": 0.27824, "process_mem_max_rss": "207496", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m18:45:55.068858 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:45:55.068805 after 24.22 seconds
[0m18:45:55.069143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a89e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ca13770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ca7d820>]}
[0m18:45:55.069402 [debug] [MainThread]: Flushing usage events
[0m01:21:59.815216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd34d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb7cbf0>]}


============================== 01:21:59.819345 | c954cc47-d7b6-44c3-94b4-3b1f852a9dca ==============================
[0m01:21:59.819345 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:21:59.819711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:00.358896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e358740>]}
[0m01:22:00.382699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c404680>]}
[0m01:22:00.383494 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:00.427739 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:22:00.501515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:22:00.502153 [debug] [MainThread]: Partial parsing: updated file: proj://models/sources.yml
[0m01:22:00.773952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8058b560>]}
[0m01:22:00.827705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8087cfb0>]}
[0m01:22:00.828031 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:22:00.828523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800ccb30>]}
[0m01:22:00.829523 [info ] [MainThread]: 
[0m01:22:00.830045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:22:00.832311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m01:22:00.838406 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m01:22:00.838632 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m01:22:00.838817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:01.354393 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.515 seconds
[0m01:22:01.356087 [debug] [ThreadPool]: On list_weather: Close
[0m01:22:01.480059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m01:22:01.486946 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:22:01.487288 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:22:01.487554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:01.961727 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.474 seconds
[0m01:22:01.966150 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:22:02.109051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m01:22:02.115118 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:22:02.115777 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:22:02.116446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:02.632917 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.516 seconds
[0m01:22:02.635528 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:22:02.764622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c509fa0>]}
[0m01:22:02.766542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:02.774245 [info ] [MainThread]: 
[0m01:22:02.791806 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m01:22:02.792564 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m01:22:02.793645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m01:22:02.794024 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m01:22:02.801145 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m01:22:02.803554 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m01:22:02.822491 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m01:22:02.823673 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m01:22:02.823959 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.source.daily_weather
)

SELECT * FROM weather_data
  );
[0m01:22:02.824242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:03.730695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m01:22:03.751323 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m01:22:03.861542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80db9970>]}
[0m01:22:03.862677 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.07s]
[0m01:22:03.864010 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m01:22:03.865869 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m01:22:03.866617 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m01:22:03.867292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m01:22:03.867825 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m01:22:03.872978 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m01:22:03.875976 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m01:22:03.951376 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m01:22:03.953039 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m01:22:03.953284 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m01:22:03.953495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.368314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.415 seconds
[0m01:22:05.370305 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m01:22:05.496199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83720740>]}
[0m01:22:05.497043 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.63s]
[0m01:22:05.498160 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m01:22:05.498729 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m01:22:05.499263 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m01:22:05.499943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m01:22:05.500291 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m01:22:05.502896 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m01:22:05.504138 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m01:22:05.506060 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m01:22:05.507639 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m01:22:05.507940 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m01:22:05.508197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:06.655802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.147 seconds
[0m01:22:06.660012 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m01:22:06.800715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8055c200>]}
[0m01:22:06.802530 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.30s]
[0m01:22:06.803726 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m01:22:06.804652 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m01:22:06.805516 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m01:22:06.807073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m01:22:06.808023 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m01:22:06.812530 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m01:22:06.815099 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m01:22:06.817941 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m01:22:06.820264 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m01:22:06.820671 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m01:22:06.821088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:08.136331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m01:22:08.139923 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m01:22:08.289630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8001a360>]}
[0m01:22:08.290293 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.48s]
[0m01:22:08.291256 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m01:22:08.291707 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m01:22:08.292193 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m01:22:08.292755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m01:22:08.293079 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m01:22:08.295341 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m01:22:08.296225 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m01:22:08.297886 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m01:22:08.299249 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m01:22:08.299523 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m01:22:08.299745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:09.570025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m01:22:09.574647 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m01:22:09.708736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82350860>]}
[0m01:22:09.710533 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.42s]
[0m01:22:09.712608 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m01:22:09.713313 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m01:22:09.714199 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m01:22:09.715484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m01:22:09.716144 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m01:22:09.722871 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m01:22:09.725437 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m01:22:09.728130 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m01:22:09.729688 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m01:22:09.730158 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m01:22:09.730579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:11.007080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m01:22:11.012268 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m01:22:11.134144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80539220>]}
[0m01:22:11.135961 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.42s]
[0m01:22:11.138693 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m01:22:11.139927 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m01:22:11.140992 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m01:22:11.142124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m01:22:11.142687 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m01:22:11.147355 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m01:22:11.149262 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m01:22:11.152019 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m01:22:11.153765 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m01:22:11.154299 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m01:22:11.154720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:12.338025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.183 seconds
[0m01:22:12.342921 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m01:22:12.459320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c954cc47-d7b6-44c3-94b4-3b1f852a9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901e86b0>]}
[0m01:22:12.461187 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.32s]
[0m01:22:12.463584 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m01:22:12.470235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:12.471001 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m01:22:12.471950 [info ] [MainThread]: 
[0m01:22:12.472690 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m01:22:12.475051 [debug] [MainThread]: Command end result
[0m01:22:12.514146 [info ] [MainThread]: 
[0m01:22:12.514692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:12.515177 [info ] [MainThread]: 
[0m01:22:12.515609 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m01:22:12.516929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.723227, "process_user_time": 3.17305, "process_kernel_time": 0.38, "process_mem_max_rss": "214716", "process_in_blocks": "11104", "process_out_blocks": "5127"}
[0m01:22:12.517287 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:12.517217 after 12.72 seconds
[0m01:22:12.517527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf99dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8010fec0>]}
[0m01:22:12.517754 [debug] [MainThread]: Flushing usage events
[0m01:22:14.686282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2c32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e16aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3225a0>]}


============================== 01:22:14.690163 | 7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7 ==============================
[0m01:22:14.690163 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:14.690763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:22:15.187550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e4d0800>]}
[0m01:22:15.211352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f932d50>]}
[0m01:22:15.212045 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:15.264302 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:22:15.354218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:15.354551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:15.377413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e0e4c50>]}
[0m01:22:15.443050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5dbd6db0>]}
[0m01:22:15.443438 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:22:15.443945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e0f9f10>]}
[0m01:22:15.444853 [info ] [MainThread]: 
[0m01:22:15.445295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:22:15.447609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m01:22:15.456134 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:22:15.456400 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:22:15.456649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:15.974336 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.517 seconds
[0m01:22:15.978880 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:22:16.121031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m01:22:16.128731 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:22:16.129470 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:22:16.130054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:16.590483 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.460 seconds
[0m01:22:16.594227 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:22:16.733631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bbcb1ec-dd6d-4f40-bf16-1263ebf4fcf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e1c8da0>]}
[0m01:22:16.734562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:16.735143 [info ] [MainThread]: 
[0m01:22:16.745678 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:22:16.746129 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m01:22:16.746717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m01:22:16.747075 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:22:16.758662 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:22:16.760345 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:22:16.772537 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:22:16.774207 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:22:16.774550 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m01:22:16.774861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:17.455909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m01:22:17.476729 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m01:22:17.610985 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.86s]
[0m01:22:17.613693 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:22:17.614819 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:22:17.615906 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m01:22:17.617592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m01:22:17.618542 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:22:17.630685 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:22:17.632799 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:22:17.635767 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:22:17.637970 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:22:17.638484 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m01:22:17.638967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:18.327911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m01:22:18.332193 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m01:22:18.479137 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.86s]
[0m01:22:18.483541 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:22:18.487053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:18.487618 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m01:22:18.488245 [info ] [MainThread]: 
[0m01:22:18.489325 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m01:22:18.492331 [debug] [MainThread]: Command end result
[0m01:22:18.542582 [info ] [MainThread]: 
[0m01:22:18.543364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:18.543808 [info ] [MainThread]: 
[0m01:22:18.544237 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:22:18.545899 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9004354, "process_user_time": 2.467217, "process_kernel_time": 0.270617, "process_mem_max_rss": "208672", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m01:22:18.546826 [debug] [MainThread]: Command `dbt test` succeeded at 01:22:18.546687 after 3.90 seconds
[0m01:22:18.548418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a0aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a0aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82829a90>]}
[0m01:22:18.548902 [debug] [MainThread]: Flushing usage events
[0m01:22:20.810467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13cbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1735fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1737620>]}


============================== 01:22:20.814753 | a3943b81-748a-4325-b633-a57bb6a34669 ==============================
[0m01:22:20.814753 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:20.815656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/proj', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:21.282089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8515dbe0>]}
[0m01:22:21.306481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0773080>]}
[0m01:22:21.307050 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:21.352322 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:22:21.600054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:21.600443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:21.624011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f07f50>]}
[0m01:22:21.686498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b7c350>]}
[0m01:22:21.687121 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:22:21.688232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1006240>]}
[0m01:22:21.689936 [info ] [MainThread]: 
[0m01:22:21.690661 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:22:21.693522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m01:22:21.701914 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m01:22:21.702158 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m01:22:21.702348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:22.145421 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.443 seconds
[0m01:22:22.149430 [debug] [ThreadPool]: On list_weather: Close
[0m01:22:22.291673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m01:22:22.305107 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:22:22.305764 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:22:22.306172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:22.755807 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.449 seconds
[0m01:22:22.758469 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:22:22.880024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m01:22:22.885513 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:22:22.886106 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:22:22.886577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:23.387325 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.500 seconds
[0m01:22:23.393063 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:22:23.554744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b51a00>]}
[0m01:22:23.558049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:23.559321 [info ] [MainThread]: 
[0m01:22:23.576728 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m01:22:23.577875 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m01:22:23.579194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m01:22:23.579753 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m01:22:23.588188 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m01:22:23.621081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:23.621461 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:22:23.621748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:24.078421 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.456 seconds
[0m01:22:24.123727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:24.124281 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:22:25.239153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.114 seconds
[0m01:22:25.245631 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.246675 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:22:25.347716 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.100 seconds
[0m01:22:25.349960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.350258 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:22:25.452483 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m01:22:25.457106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.457608 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:22:25.544004 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m01:22:25.550648 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.551346 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:22:25.637306 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m01:22:25.648552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.649297 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:22:25.739817 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.090 seconds
[0m01:22:25.765497 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:25.766078 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:26.265010 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.498 seconds
[0m01:22:26.272811 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:26.273610 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:26.384940 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.110 seconds
[0m01:22:26.386899 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m01:22:26.393862 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:26.394671 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m01:22:26.520196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m01:22:26.521305 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:26.521846 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:22:27.219096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m01:22:27.220653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:22:27.221406 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m01:22:27.622674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m01:22:27.649627 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m01:22:27.763411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff5f500>]}
[0m01:22:27.765614 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 1[0m in 4.18s]
[0m01:22:27.768477 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m01:22:27.769517 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m01:22:27.770700 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m01:22:27.771806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m01:22:27.772439 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m01:22:27.776727 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m01:22:27.781432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:27.781883 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:22:27.782297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:28.218133 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.435 seconds
[0m01:22:28.229118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:28.230023 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:22:29.216141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.985 seconds
[0m01:22:29.223035 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.223981 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:22:29.328737 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.104 seconds
[0m01:22:29.337528 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.338344 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:22:29.429962 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.091 seconds
[0m01:22:29.436862 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.437619 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:22:29.530289 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.092 seconds
[0m01:22:29.537757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.538564 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:22:29.652547 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.113 seconds
[0m01:22:29.659919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.660890 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:22:29.759097 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m01:22:29.766708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:29.767396 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:30.149852 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.382 seconds
[0m01:22:30.151319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:30.151618 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:30.246742 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.095 seconds
[0m01:22:30.247522 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m01:22:30.249214 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:30.249474 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m01:22:30.372230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m01:22:30.372939 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:30.373385 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:22:30.995520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:22:30.997546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:22:30.998328 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m01:22:31.337467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m01:22:31.345117 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m01:22:31.491456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff260c0>]}
[0m01:22:31.493721 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 1[0m in 3.72s]
[0m01:22:31.498200 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m01:22:31.498855 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m01:22:31.499691 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m01:22:31.502715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m01:22:31.503163 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m01:22:31.510294 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m01:22:31.513636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:31.514007 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:22:31.514357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:31.961882 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.447 seconds
[0m01:22:31.975803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:31.977142 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:22:33.020264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m01:22:33.027248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.028174 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:22:33.129029 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m01:22:33.136537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.137243 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:22:33.230882 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m01:22:33.242766 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.243901 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:22:33.358597 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m01:22:33.363785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.364338 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:22:33.473671 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.109 seconds
[0m01:22:33.481434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.482423 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:22:33.580323 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m01:22:33.587853 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.588994 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:33.910835 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.321 seconds
[0m01:22:33.913045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:33.913853 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:34.033312 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.118 seconds
[0m01:22:34.035054 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m01:22:34.039346 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:34.040038 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m01:22:34.175544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m01:22:34.176781 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:34.177609 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:22:34.862832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m01:22:34.864461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:22:34.865183 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m01:22:35.273268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m01:22:35.277156 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m01:22:35.395228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8400a390>]}
[0m01:22:35.396065 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 1[0m in 3.89s]
[0m01:22:35.398937 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m01:22:35.399393 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m01:22:35.399902 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m01:22:35.400475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m01:22:35.400777 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m01:22:35.403078 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m01:22:35.405493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:35.405836 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:22:35.406101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:35.881086 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.475 seconds
[0m01:22:35.892818 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:35.893844 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:22:36.929322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.034 seconds
[0m01:22:36.936247 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:36.937529 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:22:37.080891 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.142 seconds
[0m01:22:37.085865 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:37.086496 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:22:37.189057 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.102 seconds
[0m01:22:37.196743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:37.197723 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:22:37.335450 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.137 seconds
[0m01:22:37.345615 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:37.346461 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:22:37.470986 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.123 seconds
[0m01:22:37.480823 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:37.481850 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:22:37.599743 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.117 seconds
[0m01:22:37.607497 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:37.608597 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:38.139502 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.530 seconds
[0m01:22:38.142271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:38.142930 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:38.255111 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m01:22:38.257684 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:38.261979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:38.262733 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m01:22:38.408031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m01:22:38.408828 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:38.409178 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:22:39.165729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m01:22:39.167975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:22:39.168866 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m01:22:39.572048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m01:22:39.578720 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m01:22:39.702513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffabb60>]}
[0m01:22:39.704342 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 1[0m in 4.30s]
[0m01:22:39.707038 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m01:22:39.707781 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m01:22:39.708701 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m01:22:39.709698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m01:22:39.710501 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m01:22:39.717043 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m01:22:39.721859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:39.722546 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:22:39.723095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:40.135118 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.412 seconds
[0m01:22:40.148638 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:40.149626 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:22:41.173247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m01:22:41.178780 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.179523 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:22:41.297083 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m01:22:41.303110 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.304162 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:22:41.391122 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.086 seconds
[0m01:22:41.397118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.397852 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:22:41.532321 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.134 seconds
[0m01:22:41.539880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.540594 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:22:41.659215 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.117 seconds
[0m01:22:41.672042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.673038 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:22:41.757657 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.083 seconds
[0m01:22:41.769567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:41.770998 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:42.005717 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m01:22:42.099289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:42.099764 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:22:42.193751 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m01:22:42.194384 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m01:22:42.196315 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:42.196710 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m01:22:42.370607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m01:22:42.371568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:42.372287 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:22:43.067257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m01:22:43.068487 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:22:43.069142 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m01:22:43.567232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m01:22:43.572442 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m01:22:43.682298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3943b81-748a-4325-b633-a57bb6a34669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54c4050>]}
[0m01:22:43.683414 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 1[0m in 3.97s]
[0m01:22:43.685482 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m01:22:43.689494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:43.690058 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m01:22:43.691290 [info ] [MainThread]: 
[0m01:22:43.692412 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 22.00 seconds (22.00s).
[0m01:22:43.694965 [debug] [MainThread]: Command end result
[0m01:22:43.722099 [info ] [MainThread]: 
[0m01:22:43.722723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:43.723184 [info ] [MainThread]: 
[0m01:22:43.723642 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:22:43.724770 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 22.966955, "process_user_time": 3.629571, "process_kernel_time": 0.313396, "process_mem_max_rss": "207388", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m01:22:43.725155 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:22:43.725093 after 22.97 seconds
[0m01:22:43.725457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e7f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855f5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b239b0>]}
[0m01:22:43.725710 [debug] [MainThread]: Flushing usage events
[0m01:34:49.353924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86df7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c0d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bfe270>]}


============================== 01:34:49.358083 | 87d50706-5d65-407c-8d3a-1cdf0e65c847 ==============================
[0m01:34:49.358083 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:34:49.358529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:34:49.771845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b517cb0>]}
[0m01:34:49.793930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd47ad0>]}
[0m01:34:49.794396 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:34:49.838229 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:34:49.910516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:34:49.910792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:34:49.932868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66e89760>]}
[0m01:34:49.989367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff666bc350>]}
[0m01:34:49.990142 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:34:49.990692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff671124b0>]}
[0m01:34:49.992288 [info ] [MainThread]: 
[0m01:34:49.992734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:34:49.995512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m01:34:50.003397 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m01:34:50.003688 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m01:34:50.003904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:50.587522 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.583 seconds
[0m01:34:50.591740 [debug] [ThreadPool]: On list_weather: Close
[0m01:34:50.742372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m01:34:50.755989 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:34:50.756695 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:34:50.757168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:51.232275 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.475 seconds
[0m01:34:51.234795 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:34:51.347244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m01:34:51.355090 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:34:51.355888 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:34:51.356399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:51.889332 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.532 seconds
[0m01:34:51.894382 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:34:52.028146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b5f980>]}
[0m01:34:52.029948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:34:52.030751 [info ] [MainThread]: 
[0m01:34:52.045937 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m01:34:52.046991 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m01:34:52.047817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m01:34:52.048360 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m01:34:52.055765 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m01:34:52.057441 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m01:34:52.077475 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m01:34:52.078624 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m01:34:52.078941 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.source.daily_weather
)

SELECT * FROM weather_data
  );
[0m01:34:52.079240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:52.965664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.886 seconds
[0m01:34:52.991740 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m01:34:53.174824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66cd89b0>]}
[0m01:34:53.176744 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.12s]
[0m01:34:53.178275 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m01:34:53.180253 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m01:34:53.180976 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m01:34:53.181779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m01:34:53.182569 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m01:34:53.186363 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m01:34:53.188878 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m01:34:53.208381 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m01:34:53.210008 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m01:34:53.210466 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m01:34:53.210893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:54.502788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.291 seconds
[0m01:34:54.507691 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m01:34:54.627297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66495bb0>]}
[0m01:34:54.629294 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.44s]
[0m01:34:54.630505 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m01:34:54.631326 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m01:34:54.632214 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m01:34:54.632980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m01:34:54.633631 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m01:34:54.637300 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m01:34:54.639144 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m01:34:54.641949 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m01:34:54.644081 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m01:34:54.644592 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m01:34:54.645137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:56.038683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.393 seconds
[0m01:34:56.044107 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m01:34:56.172884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65b789e0>]}
[0m01:34:56.174912 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.54s]
[0m01:34:56.178839 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m01:34:56.179996 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m01:34:56.180867 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m01:34:56.181657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m01:34:56.182516 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m01:34:56.187257 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m01:34:56.189233 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m01:34:56.192323 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m01:34:56.194639 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m01:34:56.195142 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m01:34:56.195637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:57.471497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m01:34:57.476703 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m01:34:57.608314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65b14cb0>]}
[0m01:34:57.610783 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.43s]
[0m01:34:57.612140 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m01:34:57.613077 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m01:34:57.613947 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m01:34:57.614793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m01:34:57.615347 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m01:34:57.620497 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m01:34:57.622755 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m01:34:57.626070 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m01:34:57.628319 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m01:34:57.628903 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m01:34:57.629481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:58.673795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m01:34:58.679421 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m01:34:58.832074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66497260>]}
[0m01:34:58.834106 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m01:34:58.836118 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m01:34:58.837168 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m01:34:58.838080 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m01:34:58.838898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m01:34:58.839492 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m01:34:58.843618 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m01:34:58.845209 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m01:34:58.847917 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m01:34:58.849685 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m01:34:58.850109 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m01:34:58.850539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:00.033210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.182 seconds
[0m01:35:00.037570 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m01:35:00.156834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a746e10>]}
[0m01:35:00.158235 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.32s]
[0m01:35:00.159890 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m01:35:00.160735 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m01:35:00.161529 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m01:35:00.162384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m01:35:00.163015 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m01:35:00.167020 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m01:35:00.168591 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m01:35:00.170956 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m01:35:00.172578 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m01:35:00.173089 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m01:35:00.173509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:01.359775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m01:35:01.362997 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m01:35:01.470877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d50706-5d65-407c-8d3a-1cdf0e65c847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65bb7f80>]}
[0m01:35:01.472020 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.31s]
[0m01:35:01.472844 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m01:35:01.474905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:01.475237 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m01:35:01.475721 [info ] [MainThread]: 
[0m01:35:01.476045 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 11.48 seconds (11.48s).
[0m01:35:01.477154 [debug] [MainThread]: Command end result
[0m01:35:01.501632 [info ] [MainThread]: 
[0m01:35:01.501952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:35:01.502184 [info ] [MainThread]: 
[0m01:35:01.502411 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m01:35:01.503828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.189962, "process_user_time": 2.812894, "process_kernel_time": 0.233939, "process_mem_max_rss": "206852", "process_out_blocks": "1999", "process_in_blocks": "0"}
[0m01:35:01.504230 [debug] [MainThread]: Command `dbt run` succeeded at 01:35:01.504159 after 12.19 seconds
[0m01:35:01.504502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66d99f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e6b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86830f80>]}
[0m01:35:01.504713 [debug] [MainThread]: Flushing usage events
[0m01:35:04.283099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eda71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edd9610>]}


============================== 01:35:04.286945 | 461fe186-fa68-4ac4-a9eb-609ee47d8b00 ==============================
[0m01:35:04.286945 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:35:04.287664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m01:35:04.709798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e66a960>]}
[0m01:35:04.731057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e5ab320>]}
[0m01:35:04.731510 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:35:04.774699 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:35:04.843785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:35:04.844054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:35:04.866293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aba0890>]}
[0m01:35:04.927252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e256300>]}
[0m01:35:04.927553 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:35:04.927839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5dfb8fb0>]}
[0m01:35:04.928805 [info ] [MainThread]: 
[0m01:35:04.929171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:35:04.931355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m01:35:04.940262 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:35:04.940617 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:35:04.940915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:05.441913 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.501 seconds
[0m01:35:05.446504 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:35:05.585228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m01:35:05.589442 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:35:05.590420 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:35:05.591096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:06.064901 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.474 seconds
[0m01:35:06.068714 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:35:06.190416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461fe186-fa68-4ac4-a9eb-609ee47d8b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5df7ecc0>]}
[0m01:35:06.191928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:35:06.192918 [info ] [MainThread]: 
[0m01:35:06.207862 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:35:06.208552 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m01:35:06.209240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m01:35:06.209818 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:35:06.224626 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:35:06.226742 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:35:06.239878 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:35:06.241029 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m01:35:06.241321 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m01:35:06.241587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:06.770131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m01:35:06.786703 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m01:35:06.900026 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.69s]
[0m01:35:06.903080 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m01:35:06.904333 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:35:06.906992 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m01:35:06.908249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m01:35:06.909283 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:35:06.918270 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:35:06.920745 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:35:06.923023 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:35:06.924747 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m01:35:06.925266 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m01:35:06.925914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:07.475552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m01:35:07.478712 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m01:35:07.598907 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.69s]
[0m01:35:07.600726 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m01:35:07.603015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:07.603600 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m01:35:07.604182 [info ] [MainThread]: 
[0m01:35:07.604886 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m01:35:07.606237 [debug] [MainThread]: Command end result
[0m01:35:07.648993 [info ] [MainThread]: 
[0m01:35:07.649692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:35:07.650502 [info ] [MainThread]: 
[0m01:35:07.651072 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:35:07.651901 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.4070313, "process_user_time": 2.320868, "process_kernel_time": 0.202254, "process_mem_max_rss": "208508", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m01:35:07.652316 [debug] [MainThread]: Command `dbt test` succeeded at 01:35:07.652218 after 3.41 seconds
[0m01:35:07.652671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b6aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edd9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eddbbf0>]}
[0m01:35:07.652954 [debug] [MainThread]: Flushing usage events
[0m01:35:09.501653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb2b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb9b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb297c0>]}


============================== 01:35:09.505148 | ff1d8199-5eee-4365-b6a8-884679171345 ==============================
[0m01:35:09.505148 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:35:09.505794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/proj', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m01:35:09.888374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e40350>]}
[0m01:35:09.909789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704b6930>]}
[0m01:35:09.910226 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:35:09.954375 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:35:10.043170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:35:10.044292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:35:10.070120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b62a3f0>]}
[0m01:35:10.126739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b62a330>]}
[0m01:35:10.127044 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m01:35:10.127512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b33dfa0>]}
[0m01:35:10.128576 [info ] [MainThread]: 
[0m01:35:10.129043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:35:10.131331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m01:35:10.138173 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m01:35:10.138394 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m01:35:10.138585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:10.603598 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.465 seconds
[0m01:35:10.607839 [debug] [ThreadPool]: On list_weather: Close
[0m01:35:10.724707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m01:35:10.734417 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m01:35:10.734896 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m01:35:10.735288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:11.142563 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.407 seconds
[0m01:35:11.147960 [debug] [ThreadPool]: On list_weather_data: Close
[0m01:35:11.280970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m01:35:11.286977 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m01:35:11.287748 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m01:35:11.288316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:11.734134 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.446 seconds
[0m01:35:11.738829 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m01:35:11.866480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a90d730>]}
[0m01:35:11.868277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:35:11.869727 [info ] [MainThread]: 
[0m01:35:11.884197 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m01:35:11.884952 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m01:35:11.885899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m01:35:11.886429 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m01:35:11.893939 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m01:35:11.927703 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:11.928020 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:35:11.928273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:12.423156 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.495 seconds
[0m01:35:12.465157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:12.465649 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:35:13.344368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.878 seconds
[0m01:35:13.351587 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.352671 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:35:13.457874 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m01:35:13.466246 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.467392 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:35:13.564278 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m01:35:13.571473 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.572096 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:35:13.660964 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m01:35:13.665330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.665830 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m01:35:13.753293 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m01:35:13.765973 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.766794 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m01:35:13.913844 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.146 seconds
[0m01:35:13.944468 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:13.945152 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:14.470410 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.524 seconds
[0m01:35:14.477342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:14.478205 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:14.588476 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.110 seconds
[0m01:35:14.589557 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m01:35:14.593133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:14.593657 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m01:35:14.729118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m01:35:14.730461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:14.731136 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:35:15.593679 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.862 seconds
[0m01:35:15.594837 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m01:35:15.595386 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m01:35:16.004665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m01:35:16.028506 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m01:35:16.149856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b958c20>]}
[0m01:35:16.150954 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 4.26s]
[0m01:35:16.152627 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m01:35:16.153250 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m01:35:16.153872 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m01:35:16.154487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m01:35:16.154879 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m01:35:16.157527 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m01:35:16.160943 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:16.161345 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:35:16.161689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:16.625807 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.464 seconds
[0m01:35:16.638452 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:16.639455 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:35:17.648434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.008 seconds
[0m01:35:17.653317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:17.653945 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:35:17.744354 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m01:35:17.755117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:17.755995 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:35:17.864141 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.107 seconds
[0m01:35:17.871465 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:17.872299 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:35:17.963646 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m01:35:17.968004 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:17.968553 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m01:35:18.057803 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.088 seconds
[0m01:35:18.064885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.065738 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m01:35:18.152793 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.086 seconds
[0m01:35:18.155710 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.156071 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:18.667423 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.511 seconds
[0m01:35:18.669445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.670044 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:18.753169 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m01:35:18.754891 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.758650 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.759381 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m01:35:18.887216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m01:35:18.888469 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:18.889267 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:35:19.437518 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.547 seconds
[0m01:35:19.439885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m01:35:19.441097 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m01:35:19.804686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m01:35:19.812027 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m01:35:19.963258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a79ba70>]}
[0m01:35:19.965509 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 0[0m in 3.81s]
[0m01:35:19.967223 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m01:35:19.970084 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m01:35:19.971389 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m01:35:19.972872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m01:35:19.973481 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m01:35:19.977694 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m01:35:19.981639 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:19.982190 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:35:19.982685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:20.427956 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.445 seconds
[0m01:35:20.448891 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:20.449384 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:35:21.446447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m01:35:21.453020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:21.453801 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:35:21.613306 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.159 seconds
[0m01:35:21.620175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:21.620890 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:35:21.799847 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.181 seconds
[0m01:35:21.804508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:21.804820 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:35:21.935301 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.130 seconds
[0m01:35:21.937966 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:21.938284 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m01:35:22.138603 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.200 seconds
[0m01:35:22.146243 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:22.146961 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m01:35:22.262426 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.115 seconds
[0m01:35:22.271682 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:22.272329 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:22.660913 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.387 seconds
[0m01:35:22.663804 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:22.664122 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:22.805219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.141 seconds
[0m01:35:22.806848 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m01:35:22.813056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:22.818313 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m01:35:23.180476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m01:35:23.181772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:23.182503 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:35:23.919979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.736 seconds
[0m01:35:23.920715 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m01:35:23.921037 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m01:35:24.258927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m01:35:24.271826 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m01:35:24.392114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d13dd0>]}
[0m01:35:24.395450 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 4.42s]
[0m01:35:24.400907 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m01:35:24.402218 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m01:35:24.403665 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m01:35:24.404637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m01:35:24.405323 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m01:35:24.415718 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m01:35:24.420216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:24.420721 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:35:24.421102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:24.929818 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.508 seconds
[0m01:35:24.939470 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:24.940067 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:35:26.007658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.065 seconds
[0m01:35:26.015329 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.016295 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:35:26.330934 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.314 seconds
[0m01:35:26.339360 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.340428 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:35:26.492122 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.151 seconds
[0m01:35:26.495948 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.496427 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:35:26.603620 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.107 seconds
[0m01:35:26.610331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.610752 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m01:35:26.861175 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.250 seconds
[0m01:35:26.869958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.871216 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m01:35:26.975399 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.103 seconds
[0m01:35:26.984200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:26.985072 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:27.409479 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.423 seconds
[0m01:35:27.415029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:27.416437 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:27.509829 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m01:35:27.512743 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:27.516795 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:27.517729 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m01:35:27.650345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m01:35:27.651293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:27.652069 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:35:28.200485 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.548 seconds
[0m01:35:28.201043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m01:35:28.201348 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m01:35:28.791249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m01:35:28.800014 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m01:35:29.092833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7c8290>]}
[0m01:35:29.095696 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 4.69s]
[0m01:35:29.099652 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m01:35:29.102821 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m01:35:29.104838 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m01:35:29.109322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m01:35:29.111531 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m01:35:29.123539 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m01:35:29.131400 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:29.131889 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:35:29.132215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:29.564945 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.432 seconds
[0m01:35:29.575338 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:29.576035 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:35:31.164810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m01:35:31.171217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.171837 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:35:31.284670 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m01:35:31.292976 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.293749 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:35:31.492742 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.198 seconds
[0m01:35:31.495871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.496219 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:35:31.636817 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.140 seconds
[0m01:35:31.640411 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.640799 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m01:35:31.723691 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m01:35:31.730384 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.730822 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m01:35:31.836349 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m01:35:31.846141 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:31.847104 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:32.191720 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.344 seconds
[0m01:35:32.286951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:32.287456 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:35:32.474452 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.186 seconds
[0m01:35:32.476412 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m01:35:32.480330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:32.480855 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m01:35:32.611717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m01:35:32.612878 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:32.613610 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:35:33.214010 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.599 seconds
[0m01:35:33.215029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m01:35:33.215451 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m01:35:33.616415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m01:35:33.620585 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m01:35:33.736035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1d8199-5eee-4365-b6a8-884679171345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b458ad0>]}
[0m01:35:33.738028 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 4.63s]
[0m01:35:33.742923 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m01:35:33.746535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:33.747347 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m01:35:33.748131 [info ] [MainThread]: 
[0m01:35:33.748938 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 23.62 seconds (23.62s).
[0m01:35:33.750999 [debug] [MainThread]: Command end result
[0m01:35:33.787128 [info ] [MainThread]: 
[0m01:35:33.787857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:35:33.788250 [info ] [MainThread]: 
[0m01:35:33.788679 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:35:33.790267 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 24.328262, "process_user_time": 3.419604, "process_kernel_time": 0.203944, "process_mem_max_rss": "207380", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m01:35:33.790619 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:35:33.790566 after 24.33 seconds
[0m01:35:33.790893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c174c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf535f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4ce720>]}
[0m01:35:33.791138 [debug] [MainThread]: Flushing usage events
[0m03:14:59.252827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07c29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa000cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c04bf0>]}


============================== 03:14:59.258385 | 3ee1a5c9-2504-4e19-a154-307f9f436a05 ==============================
[0m03:14:59.258385 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:14:59.258899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:14:59.860787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fac44d0>]}
[0m03:14:59.908810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855a1340>]}
[0m03:14:59.909642 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:15:00.034775 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:15:00.130660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:15:00.130974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:15:00.156296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8457f980>]}
[0m03:15:00.243391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9d86e0>]}
[0m03:15:00.243944 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:15:00.245098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c29a30>]}
[0m03:15:00.246941 [info ] [MainThread]: 
[0m03:15:00.247880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:15:00.251406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m03:15:00.262166 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m03:15:00.262548 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m03:15:00.262829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:00.879882 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m03:15:00.881926 [debug] [ThreadPool]: On list_weather: Close
[0m03:15:01.033251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m03:15:01.042889 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:15:01.043466 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:15:01.043941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:01.582912 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.539 seconds
[0m03:15:01.586980 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:15:01.745988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m03:15:01.751423 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:15:01.752142 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:15:01.752900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:02.271471 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.518 seconds
[0m03:15:02.275200 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:15:02.429457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14314f0>]}
[0m03:15:02.430834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:02.431796 [info ] [MainThread]: 
[0m03:15:02.447706 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m03:15:02.448615 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m03:15:02.449615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now model.proj.daily_weather)
[0m03:15:02.450100 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m03:15:02.457393 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m03:15:02.458830 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m03:15:02.479695 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m03:15:02.480800 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m03:15:02.481088 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.source.daily_weather
)

SELECT * FROM weather_data
  );
[0m03:15:02.481458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:03.409416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m03:15:03.437929 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m03:15:03.545019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fedc9b0>]}
[0m03:15:03.546105 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.09s]
[0m03:15:03.548066 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m03:15:03.550095 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m03:15:03.550766 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m03:15:03.551579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m03:15:03.551989 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m03:15:03.555348 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m03:15:03.557729 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m03:15:03.579766 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m03:15:03.581436 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m03:15:03.581856 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m03:15:03.582678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:05.120610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.537 seconds
[0m03:15:05.134723 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m03:15:05.249021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed14740>]}
[0m03:15:05.251046 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.70s]
[0m03:15:05.255931 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m03:15:05.256780 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m03:15:05.258108 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m03:15:05.260151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m03:15:05.260762 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m03:15:05.267240 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m03:15:05.268901 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m03:15:05.271398 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m03:15:05.273093 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m03:15:05.273495 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m03:15:05.273916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:06.621771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.347 seconds
[0m03:15:06.626826 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m03:15:06.746732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed7c350>]}
[0m03:15:06.748889 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.49s]
[0m03:15:06.750251 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m03:15:06.751432 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m03:15:06.752603 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m03:15:06.753829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m03:15:06.754403 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m03:15:06.759128 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m03:15:06.760754 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m03:15:06.763171 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m03:15:06.765354 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m03:15:06.765821 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m03:15:06.766252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:08.197534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.431 seconds
[0m03:15:08.201807 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m03:15:08.322974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed7c2c0>]}
[0m03:15:08.324232 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.57s]
[0m03:15:08.327150 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m03:15:08.328004 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m03:15:08.328795 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m03:15:08.329635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m03:15:08.330136 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m03:15:08.333987 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m03:15:08.335364 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m03:15:08.337567 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m03:15:08.339293 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m03:15:08.339743 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m03:15:08.340125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:09.606711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m03:15:09.611432 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m03:15:09.755202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f68dc10>]}
[0m03:15:09.757216 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.42s]
[0m03:15:09.758868 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m03:15:09.759750 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m03:15:09.760973 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m03:15:09.762678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m03:15:09.763464 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m03:15:09.773179 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m03:15:09.774985 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m03:15:09.777362 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m03:15:09.778973 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m03:15:09.779401 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m03:15:09.779763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:10.818783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.039 seconds
[0m03:15:10.822546 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m03:15:10.926879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6e6690>]}
[0m03:15:10.928177 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.16s]
[0m03:15:10.930096 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m03:15:10.930841 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m03:15:10.931557 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m03:15:10.932457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m03:15:10.932937 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m03:15:10.936460 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m03:15:10.938035 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m03:15:10.940117 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m03:15:10.941746 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m03:15:10.942041 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m03:15:10.942405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:12.157375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.214 seconds
[0m03:15:12.160922 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m03:15:12.291102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ee1a5c9-2504-4e19-a154-307f9f436a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edb6f00>]}
[0m03:15:12.292114 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m03:15:12.293143 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m03:15:12.296112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:12.296670 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m03:15:12.297330 [info ] [MainThread]: 
[0m03:15:12.298020 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 12.05 seconds (12.05s).
[0m03:15:12.299672 [debug] [MainThread]: Command end result
[0m03:15:12.333359 [info ] [MainThread]: 
[0m03:15:12.333975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:12.334360 [info ] [MainThread]: 
[0m03:15:12.334884 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m03:15:12.337933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.132944, "process_user_time": 3.135854, "process_kernel_time": 0.581205, "process_mem_max_rss": "206828", "process_out_blocks": "1999", "process_in_blocks": "0"}
[0m03:15:12.339368 [debug] [MainThread]: Command `dbt run` succeeded at 03:15:12.339124 after 13.13 seconds
[0m03:15:12.340157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0756000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd83d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0112990>]}
[0m03:15:12.340392 [debug] [MainThread]: Flushing usage events
[0m03:15:15.494245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce3baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c687380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c94cbf0>]}


============================== 03:15:15.498792 | 9a52fd17-64d7-4d08-a3d4-5c2695c591ad ==============================
[0m03:15:15.498792 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:15:15.502672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'send_anonymous_usage_stats': 'True'}
[0m03:15:16.052646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60585fa0>]}
[0m03:15:16.081444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d639e20>]}
[0m03:15:16.082331 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:15:16.149793 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:15:16.238791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:15:16.239228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:15:16.265295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6046a000>]}
[0m03:15:16.348113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bf683b0>]}
[0m03:15:16.348884 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:15:16.349652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60491490>]}
[0m03:15:16.352185 [info ] [MainThread]: 
[0m03:15:16.355445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:15:16.362755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m03:15:16.379656 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:15:16.381689 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:15:16.382564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:16.915265 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.533 seconds
[0m03:15:16.920009 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:15:17.034111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m03:15:17.039891 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:15:17.040680 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:15:17.041400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:17.480532 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.439 seconds
[0m03:15:17.483215 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:15:17.600981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a52fd17-64d7-4d08-a3d4-5c2695c591ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dca5460>]}
[0m03:15:17.602221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:17.604199 [info ] [MainThread]: 
[0m03:15:17.621948 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:15:17.622839 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m03:15:17.623955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m03:15:17.624527 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:15:17.638824 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:15:17.641226 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:15:17.655010 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:15:17.656238 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:15:17.656612 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m03:15:17.656943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:18.299842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m03:15:18.313440 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m03:15:18.453421 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.83s]
[0m03:15:18.458091 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:15:18.458768 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:15:18.459453 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m03:15:18.460176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m03:15:18.460492 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:15:18.465198 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:15:18.466525 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:15:18.467799 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:15:18.468677 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:15:18.468914 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:18.469154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:19.216345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m03:15:19.226846 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m03:15:19.349335 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.89s]
[0m03:15:19.350539 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:15:19.352891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:19.353258 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m03:15:19.353737 [info ] [MainThread]: 
[0m03:15:19.354280 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m03:15:19.355322 [debug] [MainThread]: Command end result
[0m03:15:19.389428 [info ] [MainThread]: 
[0m03:15:19.390279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:19.390754 [info ] [MainThread]: 
[0m03:15:19.391434 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:15:19.393969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9438891, "process_user_time": 2.65205, "process_kernel_time": 0.387286, "process_mem_max_rss": "208544", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m03:15:19.394483 [debug] [MainThread]: Command `dbt test` succeeded at 03:15:19.394425 after 3.94 seconds
[0m03:15:19.394896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5c4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d087e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d086240>]}
[0m03:15:19.395206 [debug] [MainThread]: Flushing usage events
[0m03:15:22.364388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcac2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae9b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb32f7a0>]}


============================== 03:15:22.368672 | eaaee179-911b-48e0-932e-a8eeeb7256a8 ==============================
[0m03:15:22.368672 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:15:22.371077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:15:22.987931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb9c7ef0>]}
[0m03:15:23.021199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0de2f90>]}
[0m03:15:23.021959 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:15:23.076617 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:15:23.224931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:15:23.225485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:15:23.252222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a02a7e0>]}
[0m03:15:23.315928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0202f0>]}
[0m03:15:23.316340 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:15:23.317149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d3f1a0>]}
[0m03:15:23.318557 [info ] [MainThread]: 
[0m03:15:23.319105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:15:23.321345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m03:15:23.328794 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m03:15:23.329103 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m03:15:23.329363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:23.766577 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.437 seconds
[0m03:15:23.773581 [debug] [ThreadPool]: On list_weather: Close
[0m03:15:23.898542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m03:15:23.909834 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:15:23.910397 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:15:23.910726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:24.483636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.573 seconds
[0m03:15:24.487542 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:15:24.614718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m03:15:24.620059 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:15:24.620818 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:15:24.621387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:25.091776 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.470 seconds
[0m03:15:25.095622 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:15:25.229263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb83d5b0>]}
[0m03:15:25.230483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:25.234527 [info ] [MainThread]: 
[0m03:15:25.248832 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m03:15:25.249746 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m03:15:25.250826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now snapshot.proj.snapshot_daily_changes)
[0m03:15:25.251458 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m03:15:25.259970 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m03:15:25.293657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:25.294023 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:15:25.294328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:25.788179 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.494 seconds
[0m03:15:25.835641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:25.836302 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:15:27.080080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.243 seconds
[0m03:15:27.086298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.087171 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:15:27.213933 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m03:15:27.219586 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.220494 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:15:27.365766 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.144 seconds
[0m03:15:27.373425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.374233 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:15:27.496497 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.122 seconds
[0m03:15:27.501993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.502653 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:15:27.638697 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m03:15:27.648059 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.648864 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:15:27.750815 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.101 seconds
[0m03:15:27.779164 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:27.779924 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:28.129040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.348 seconds
[0m03:15:28.136022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:28.136773 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:28.252543 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m03:15:28.254101 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m03:15:28.258550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:28.259245 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m03:15:28.391826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m03:15:28.392899 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:28.393643 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:15:29.123348 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.729 seconds
[0m03:15:29.124716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:15:29.125294 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m03:15:29.516769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m03:15:29.548893 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m03:15:29.683099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba9d2420>]}
[0m03:15:29.685252 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 4.43s]
[0m03:15:29.688698 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m03:15:29.689827 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m03:15:29.691380 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m03:15:29.692570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m03:15:29.693184 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m03:15:29.698137 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m03:15:29.702830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:29.703322 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:15:29.703757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:30.144075 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.440 seconds
[0m03:15:30.156046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:30.157159 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:15:31.215891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.057 seconds
[0m03:15:31.220571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.221576 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:15:31.365850 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.144 seconds
[0m03:15:31.373657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.374394 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:15:31.487426 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.112 seconds
[0m03:15:31.493060 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.493858 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:15:31.604446 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.110 seconds
[0m03:15:31.610385 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.611044 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:15:31.774821 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.163 seconds
[0m03:15:31.780514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.781251 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:15:31.911487 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.129 seconds
[0m03:15:31.920584 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:31.921622 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:32.161737 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.239 seconds
[0m03:15:32.164236 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:32.165019 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:32.248859 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m03:15:32.251108 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m03:15:32.256677 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:32.257442 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m03:15:32.386834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m03:15:32.388399 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:32.389276 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:15:32.924124 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.534 seconds
[0m03:15:32.924818 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:15:32.925255 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m03:15:33.241683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m03:15:33.246403 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m03:15:33.364978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99186e40>]}
[0m03:15:33.367743 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 0[0m in 3.67s]
[0m03:15:33.371339 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m03:15:33.372224 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m03:15:33.373718 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m03:15:33.375276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m03:15:33.376106 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m03:15:33.381770 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m03:15:33.386842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:33.387402 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:15:33.387897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:33.879961 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.492 seconds
[0m03:15:33.893352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:33.894463 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:15:34.874768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m03:15:34.877564 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:34.878077 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:15:34.999296 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.121 seconds
[0m03:15:35.002745 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.003217 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:15:35.094620 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m03:15:35.100714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.101411 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:15:35.204842 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m03:15:35.209519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.210359 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:15:35.310963 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.100 seconds
[0m03:15:35.316918 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.317801 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:15:35.438336 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.120 seconds
[0m03:15:35.448259 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.449302 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:35.733161 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.283 seconds
[0m03:15:35.735616 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.736333 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:35.835321 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m03:15:35.837219 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.841549 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.842457 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m03:15:35.967738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m03:15:35.968963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:35.970047 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:15:36.746904 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.776 seconds
[0m03:15:36.748415 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:15:36.749121 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m03:15:37.060465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m03:15:37.066446 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m03:15:37.187826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991f3560>]}
[0m03:15:37.190574 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.81s]
[0m03:15:37.193118 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m03:15:37.194027 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m03:15:37.194973 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m03:15:37.196607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m03:15:37.197417 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m03:15:37.203633 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m03:15:37.208069 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:37.208644 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:15:37.209137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:37.574615 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.365 seconds
[0m03:15:37.585079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:37.585933 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:15:38.561032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m03:15:38.568285 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:38.568968 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:15:38.679462 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.110 seconds
[0m03:15:38.685717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:38.686480 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:15:38.783494 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.096 seconds
[0m03:15:38.797112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:38.798157 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:15:38.938806 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.140 seconds
[0m03:15:38.951083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:38.954334 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:15:39.087370 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.132 seconds
[0m03:15:39.090090 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.090555 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:15:39.218995 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.128 seconds
[0m03:15:39.228752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.229727 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:39.486675 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.256 seconds
[0m03:15:39.490042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.490867 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:39.599972 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m03:15:39.602268 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.607434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.608339 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m03:15:39.789921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m03:15:39.792610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:39.793538 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:15:40.351576 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.556 seconds
[0m03:15:40.352929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:15:40.353802 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m03:15:40.666513 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m03:15:40.670522 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m03:15:40.792102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98735ac0>]}
[0m03:15:40.794712 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 3.59s]
[0m03:15:40.800023 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m03:15:40.801035 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m03:15:40.802768 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m03:15:40.803514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m03:15:40.804046 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m03:15:40.808051 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m03:15:40.812036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:40.812427 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:15:40.812917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:41.320474 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.507 seconds
[0m03:15:41.331332 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:41.332320 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:15:42.401244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.064 seconds
[0m03:15:42.412919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.413477 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:15:42.528087 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m03:15:42.533280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.533718 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:15:42.616687 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m03:15:42.622835 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.623848 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:15:42.725075 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m03:15:42.731649 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.732556 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:15:42.837547 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m03:15:42.847879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.848807 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:15:42.967281 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.118 seconds
[0m03:15:42.972037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:42.972738 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:43.318621 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.345 seconds
[0m03:15:43.420989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:43.421543 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:15:43.514300 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m03:15:43.515127 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m03:15:43.518167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:43.518624 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m03:15:43.674655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m03:15:43.675842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:43.677013 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:15:44.330019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.652 seconds
[0m03:15:44.331163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:15:44.331936 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m03:15:44.641967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m03:15:44.645836 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m03:15:44.756425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaaee179-911b-48e0-932e-a8eeeb7256a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2ff860>]}
[0m03:15:44.758120 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 3.95s]
[0m03:15:44.763153 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m03:15:44.766179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:44.766936 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m03:15:44.767605 [info ] [MainThread]: 
[0m03:15:44.768881 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 21.45 seconds (21.45s).
[0m03:15:44.770273 [debug] [MainThread]: Command end result
[0m03:15:44.809867 [info ] [MainThread]: 
[0m03:15:44.810645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:44.811130 [info ] [MainThread]: 
[0m03:15:44.811564 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m03:15:44.813275 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 22.496828, "process_user_time": 3.853453, "process_kernel_time": 0.431264, "process_mem_max_rss": "207616", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m03:15:44.813744 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:15:44.813659 after 22.50 seconds
[0m03:15:44.814082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe96aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991d37a0>]}
[0m03:15:44.814379 [debug] [MainThread]: Flushing usage events
[0m03:45:06.248479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc7c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa133d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8511f0>]}


============================== 03:45:06.253779 | bf9ca093-ad47-4708-8f61-f9f48465d20a ==============================
[0m03:45:06.253779 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:45:06.254233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:45:06.769804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e562360>]}
[0m03:45:06.792030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7b2420>]}
[0m03:45:06.792536 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:45:06.842085 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:45:06.918805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:45:06.919101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:45:06.941569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e324dd0>]}
[0m03:45:07.049547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e02d700>]}
[0m03:45:07.049916 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:45:07.050192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f46b6b0>]}
[0m03:45:07.051307 [info ] [MainThread]: 
[0m03:45:07.051740 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:45:07.054243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m03:45:07.063103 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m03:45:07.063352 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m03:45:07.063546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:07.632556 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.569 seconds
[0m03:45:07.634720 [debug] [ThreadPool]: On list_weather: Close
[0m03:45:07.773651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_data)
[0m03:45:07.788542 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:45:07.789312 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:45:07.789824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:08.277867 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.488 seconds
[0m03:45:08.281892 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:45:08.392737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m03:45:08.399257 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:45:08.399962 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:45:08.400552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:08.914746 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.514 seconds
[0m03:45:08.920443 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:45:09.079925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e042720>]}
[0m03:45:09.081994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:45:09.082886 [info ] [MainThread]: 
[0m03:45:09.101512 [debug] [Thread-1 (]: Began running node model.proj.daily_weather
[0m03:45:09.102455 [info ] [Thread-1 (]: 1 of 7 START sql view model data.custom_daily_weather_view ..................... [RUN]
[0m03:45:09.103099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.proj.daily_weather)
[0m03:45:09.103486 [debug] [Thread-1 (]: Began compiling node model.proj.daily_weather
[0m03:45:09.113844 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_weather"
[0m03:45:09.116331 [debug] [Thread-1 (]: Began executing node model.proj.daily_weather
[0m03:45:09.134854 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_weather"
[0m03:45:09.136188 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_weather"
[0m03:45:09.136523 [debug] [Thread-1 (]: On model.proj.daily_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_weather"} */
create or replace   view weather.data.custom_daily_weather_view
  
   as (
    WITH weather_data AS (
    SELECT
        *
    FROM weather.source.daily_weather
)

SELECT * FROM weather_data
  );
[0m03:45:09.136784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:10.014348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m03:45:10.031163 [debug] [Thread-1 (]: On model.proj.daily_weather: Close
[0m03:45:10.150286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e660620>]}
[0m03:45:10.151447 [info ] [Thread-1 (]: 1 of 7 OK created sql view model data.custom_daily_weather_view ................ [[32mSUCCESS 1[0m in 1.05s]
[0m03:45:10.152633 [debug] [Thread-1 (]: Finished running node model.proj.daily_weather
[0m03:45:10.154950 [debug] [Thread-1 (]: Began running node model.proj.cumulative_precipitation
[0m03:45:10.155654 [info ] [Thread-1 (]: 2 of 7 START sql table model data.cumulative_precipitation ..................... [RUN]
[0m03:45:10.156314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_weather, now model.proj.cumulative_precipitation)
[0m03:45:10.156848 [debug] [Thread-1 (]: Began compiling node model.proj.cumulative_precipitation
[0m03:45:10.159856 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.cumulative_precipitation"
[0m03:45:10.162788 [debug] [Thread-1 (]: Began executing node model.proj.cumulative_precipitation
[0m03:45:10.179422 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.cumulative_precipitation"
[0m03:45:10.181061 [debug] [Thread-1 (]: Using snowflake connection "model.proj.cumulative_precipitation"
[0m03:45:10.181419 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.cumulative_precipitation"} */
create or replace transient table weather.data.cumulative_precipitation
         as
        (WITH cumulative_precip_data AS (
    SELECT 
        datetime, 
        precip, 
        SUM(precip) OVER (ORDER BY datetime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_precip
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    precip, 
    cumulative_precip
FROM cumulative_precip_data
ORDER BY datetime DESC
        );
[0m03:45:10.181710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:11.650420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.468 seconds
[0m03:45:11.653467 [debug] [Thread-1 (]: On model.proj.cumulative_precipitation: Close
[0m03:45:11.779658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d453470>]}
[0m03:45:11.781579 [info ] [Thread-1 (]: 2 of 7 OK created sql table model data.cumulative_precipitation ................ [[32mSUCCESS 1[0m in 1.62s]
[0m03:45:11.782906 [debug] [Thread-1 (]: Finished running node model.proj.cumulative_precipitation
[0m03:45:11.783941 [debug] [Thread-1 (]: Began running node model.proj.daily_changes
[0m03:45:11.784999 [info ] [Thread-1 (]: 3 of 7 START sql table model data.daily_changes ................................ [RUN]
[0m03:45:11.785853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.cumulative_precipitation, now model.proj.daily_changes)
[0m03:45:11.786763 [debug] [Thread-1 (]: Began compiling node model.proj.daily_changes
[0m03:45:11.791945 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daily_changes"
[0m03:45:11.795053 [debug] [Thread-1 (]: Began executing node model.proj.daily_changes
[0m03:45:11.797700 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daily_changes"
[0m03:45:11.800134 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daily_changes"
[0m03:45:11.800691 [debug] [Thread-1 (]: On model.proj.daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daily_changes"} */
create or replace transient table weather.data.daily_changes
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        temp, 
        humidity,
        LAG(temp) OVER (ORDER BY datetime) AS prev_temp,
        LAG(humidity) OVER (ORDER BY datetime) AS prev_humidity
    FROM weather.data.custom_daily_weather_view
),
calculated_changes AS (
    SELECT 
        datetime, 
        temp, 
        prev_temp,
        ((temp - prev_temp) / NULLIF(prev_temp, 0)) * 100 AS temp_change,
        humidity, 
        prev_humidity,
        ((humidity - prev_humidity) / NULLIF(prev_humidity, 0)) * 100 AS humidity_change
    FROM weather_data
)
SELECT 
    datetime, 
    temp, 
    prev_temp,
    temp_change,
    humidity, 
    prev_humidity,
    humidity_change
FROM calculated_changes
ORDER BY datetime
        );
[0m03:45:11.801202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:12.906341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m03:45:12.911995 [debug] [Thread-1 (]: On model.proj.daily_changes: Close
[0m03:45:13.038403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d46bd70>]}
[0m03:45:13.044954 [info ] [Thread-1 (]: 3 of 7 OK created sql table model data.daily_changes ........................... [[32mSUCCESS 1[0m in 1.25s]
[0m03:45:13.054693 [debug] [Thread-1 (]: Finished running node model.proj.daily_changes
[0m03:45:13.055545 [debug] [Thread-1 (]: Began running node model.proj.daylight_duration
[0m03:45:13.072314 [info ] [Thread-1 (]: 4 of 7 START sql table model data.daylight_duration ............................ [RUN]
[0m03:45:13.084715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daily_changes, now model.proj.daylight_duration)
[0m03:45:13.085299 [debug] [Thread-1 (]: Began compiling node model.proj.daylight_duration
[0m03:45:13.092969 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.daylight_duration"
[0m03:45:13.094777 [debug] [Thread-1 (]: Began executing node model.proj.daylight_duration
[0m03:45:13.098126 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.daylight_duration"
[0m03:45:13.099802 [debug] [Thread-1 (]: Using snowflake connection "model.proj.daylight_duration"
[0m03:45:13.100106 [debug] [Thread-1 (]: On model.proj.daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.daylight_duration"} */
create or replace transient table weather.data.daylight_duration
         as
        (WITH daylight_hours_data AS (
    SELECT 
        datetime, 
        CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP) AS sunrise_ts,
        CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP) AS sunset_ts,
        DATEDIFF('second', 
                 CAST(CONCAT(datetime, ' ', sunrise) AS TIMESTAMP), 
                 CAST(CONCAT(datetime, ' ', sunset) AS TIMESTAMP)
        ) / 3600.0 AS daylight_hours
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    sunrise_ts AS sunrise, 
    sunset_ts AS sunset, 
    daylight_hours
FROM daylight_hours_data
ORDER BY datetime DESC
        );
[0m03:45:13.100421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:14.316058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.215 seconds
[0m03:45:14.319694 [debug] [Thread-1 (]: On model.proj.daylight_duration: Close
[0m03:45:14.440019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d429bb0>]}
[0m03:45:14.441008 [info ] [Thread-1 (]: 4 of 7 OK created sql table model data.daylight_duration ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m03:45:14.441820 [debug] [Thread-1 (]: Finished running node model.proj.daylight_duration
[0m03:45:14.442445 [debug] [Thread-1 (]: Began running node model.proj.pressure_drops
[0m03:45:14.443166 [info ] [Thread-1 (]: 5 of 7 START sql table model data.pressure_drops ............................... [RUN]
[0m03:45:14.443744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.daylight_duration, now model.proj.pressure_drops)
[0m03:45:14.444208 [debug] [Thread-1 (]: Began compiling node model.proj.pressure_drops
[0m03:45:14.447275 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.pressure_drops"
[0m03:45:14.448536 [debug] [Thread-1 (]: Began executing node model.proj.pressure_drops
[0m03:45:14.450552 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.pressure_drops"
[0m03:45:14.452087 [debug] [Thread-1 (]: Using snowflake connection "model.proj.pressure_drops"
[0m03:45:14.452493 [debug] [Thread-1 (]: On model.proj.pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.pressure_drops"} */
create or replace transient table weather.data.pressure_drops
         as
        (WITH weather_data AS (
    SELECT 
        datetime, 
        pressure, 
        LAG(pressure) OVER (ORDER BY datetime) AS prev_pressure,
        (pressure - LAG(pressure) OVER (ORDER BY datetime)) AS pressure_change,
        CASE 
            WHEN (pressure - LAG(pressure) OVER (ORDER BY datetime)) < -2 THEN 'Yes'
            ELSE 'No'
        END AS pressure_drop
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    datetime, 
    pressure, 
    prev_pressure, 
    pressure_change, 
    pressure_drop
FROM weather_data
        );
[0m03:45:14.452866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:15.893777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m03:45:15.900263 [debug] [Thread-1 (]: On model.proj.pressure_drops: Close
[0m03:45:16.050051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d44c770>]}
[0m03:45:16.052381 [info ] [Thread-1 (]: 5 of 7 OK created sql table model data.pressure_drops .......................... [[32mSUCCESS 1[0m in 1.61s]
[0m03:45:16.054715 [debug] [Thread-1 (]: Finished running node model.proj.pressure_drops
[0m03:45:16.055695 [debug] [Thread-1 (]: Began running node model.proj.solar_efficiency
[0m03:45:16.056635 [info ] [Thread-1 (]: 6 of 7 START sql table model data.solar_efficiency ............................. [RUN]
[0m03:45:16.057540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.pressure_drops, now model.proj.solar_efficiency)
[0m03:45:16.058533 [debug] [Thread-1 (]: Began compiling node model.proj.solar_efficiency
[0m03:45:16.063203 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.solar_efficiency"
[0m03:45:16.065864 [debug] [Thread-1 (]: Began executing node model.proj.solar_efficiency
[0m03:45:16.069015 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.solar_efficiency"
[0m03:45:16.070899 [debug] [Thread-1 (]: Using snowflake connection "model.proj.solar_efficiency"
[0m03:45:16.071367 [debug] [Thread-1 (]: On model.proj.solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.solar_efficiency"} */
create or replace transient table weather.data.solar_efficiency
         as
        (WITH weather_data AS (
    SELECT 
        DATETIME, 
        solarradiation, 
        cloudcover, 
        CASE 
            WHEN cloudcover > 0 THEN solarradiation / cloudcover
            ELSE NULL
        END AS solar_efficiency
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    solarradiation, 
    cloudcover, 
    solar_efficiency
FROM weather_data
        );
[0m03:45:16.071864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:17.290216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.218 seconds
[0m03:45:17.294700 [debug] [Thread-1 (]: On model.proj.solar_efficiency: Close
[0m03:45:17.460648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d493bf0>]}
[0m03:45:17.462194 [info ] [Thread-1 (]: 6 of 7 OK created sql table model data.solar_efficiency ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m03:45:17.463304 [debug] [Thread-1 (]: Finished running node model.proj.solar_efficiency
[0m03:45:17.464145 [debug] [Thread-1 (]: Began running node model.proj.temperature_range
[0m03:45:17.465012 [info ] [Thread-1 (]: 7 of 7 START sql table model data.temperature_range ............................ [RUN]
[0m03:45:17.465790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.proj.solar_efficiency, now model.proj.temperature_range)
[0m03:45:17.466430 [debug] [Thread-1 (]: Began compiling node model.proj.temperature_range
[0m03:45:17.470562 [debug] [Thread-1 (]: Writing injected SQL for node "model.proj.temperature_range"
[0m03:45:17.473386 [debug] [Thread-1 (]: Began executing node model.proj.temperature_range
[0m03:45:17.476110 [debug] [Thread-1 (]: Writing runtime sql for node "model.proj.temperature_range"
[0m03:45:17.477894 [debug] [Thread-1 (]: Using snowflake connection "model.proj.temperature_range"
[0m03:45:17.478387 [debug] [Thread-1 (]: On model.proj.temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "model.proj.temperature_range"} */
create or replace transient table weather.data.temperature_range
         as
        (WITH temperature_range AS (
    SELECT
        DATETIME,
        TEMPMAX,
        TEMPMIN,
        (TEMPMAX - TEMPMIN) AS TEMP_RANGE,
        CONDITIONS
    FROM weather.data.custom_daily_weather_view
)
SELECT 
    DATETIME, 
    TEMPMAX, 
    TEMPMIN, 
    TEMP_RANGE, 
    CONDITIONS
FROM temperature_range
ORDER BY DATETIME DESC
        );
[0m03:45:17.478881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:19.338298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.858 seconds
[0m03:45:19.346546 [debug] [Thread-1 (]: On model.proj.temperature_range: Close
[0m03:45:19.475948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9ca093-ad47-4708-8f61-f9f48465d20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4bce60>]}
[0m03:45:19.477472 [info ] [Thread-1 (]: 7 of 7 OK created sql table model data.temperature_range ....................... [[32mSUCCESS 1[0m in 2.01s]
[0m03:45:19.479085 [debug] [Thread-1 (]: Finished running node model.proj.temperature_range
[0m03:45:19.485210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:19.485769 [debug] [MainThread]: Connection 'model.proj.temperature_range' was properly closed.
[0m03:45:19.486740 [info ] [MainThread]: 
[0m03:45:19.487290 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 12.43 seconds (12.43s).
[0m03:45:19.488975 [debug] [MainThread]: Command end result
[0m03:45:19.525721 [info ] [MainThread]: 
[0m03:45:19.526121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:45:19.526410 [info ] [MainThread]: 
[0m03:45:19.526741 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m03:45:19.529502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.321756, "process_user_time": 2.868338, "process_kernel_time": 0.540892, "process_mem_max_rss": "204676", "process_out_blocks": "1999", "process_in_blocks": "0"}
[0m03:45:19.530367 [debug] [MainThread]: Command `dbt run` succeeded at 03:45:19.530295 after 13.32 seconds
[0m03:45:19.530853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f448bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb995b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4afaa0>]}
[0m03:45:19.531101 [debug] [MainThread]: Flushing usage events
[0m03:45:21.984957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56c1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a0b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80e1430>]}


============================== 03:45:21.988774 | 852f8417-7823-4dd6-a8e5-7879fea05972 ==============================
[0m03:45:21.988774 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:45:21.989312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/proj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:45:22.472332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99721340>]}
[0m03:45:22.493846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e19280>]}
[0m03:45:22.494295 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:45:22.539707 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:45:22.617358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:45:22.617645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:45:22.639762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99653a40>]}
[0m03:45:22.707472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9935ad20>]}
[0m03:45:22.707785 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:45:22.708027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997d6ea0>]}
[0m03:45:22.708959 [info ] [MainThread]: 
[0m03:45:22.709328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:45:22.711659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_data'
[0m03:45:22.719691 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:45:22.719918 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:45:22.720108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:23.313116 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.593 seconds
[0m03:45:23.322340 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:45:23.441101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_data, now list_weather_snapshot)
[0m03:45:23.447412 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:45:23.448122 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:45:23.448655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:23.897467 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.449 seconds
[0m03:45:23.900039 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:45:24.016593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852f8417-7823-4dd6-a8e5-7879fea05972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99783c80>]}
[0m03:45:24.018153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:45:24.019296 [info ] [MainThread]: 
[0m03:45:24.038755 [debug] [Thread-1 (]: Began running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:45:24.039676 [info ] [Thread-1 (]: 1 of 2 START test not_null_temperature_range_datetime .......................... [RUN]
[0m03:45:24.040498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now test.proj.not_null_temperature_range_datetime.e1768264d8)
[0m03:45:24.041104 [debug] [Thread-1 (]: Began compiling node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:45:24.056167 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:45:24.058155 [debug] [Thread-1 (]: Began executing node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:45:24.071785 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:45:24.073517 [debug] [Thread-1 (]: Using snowflake connection "test.proj.not_null_temperature_range_datetime.e1768264d8"
[0m03:45:24.074102 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.not_null_temperature_range_datetime.e1768264d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datetime
from weather.data.temperature_range
where datetime is null



      
    ) dbt_internal_test
[0m03:45:24.074562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:24.564547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m03:45:24.574965 [debug] [Thread-1 (]: On test.proj.not_null_temperature_range_datetime.e1768264d8: Close
[0m03:45:24.698725 [info ] [Thread-1 (]: 1 of 2 PASS not_null_temperature_range_datetime ................................ [[32mPASS[0m in 0.66s]
[0m03:45:24.701322 [debug] [Thread-1 (]: Finished running node test.proj.not_null_temperature_range_datetime.e1768264d8
[0m03:45:24.702367 [debug] [Thread-1 (]: Began running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:45:24.703638 [info ] [Thread-1 (]: 2 of 2 START test unique_temperature_range_datetime ............................ [RUN]
[0m03:45:24.704740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.proj.not_null_temperature_range_datetime.e1768264d8, now test.proj.unique_temperature_range_datetime.9db51823a8)
[0m03:45:24.705489 [debug] [Thread-1 (]: Began compiling node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:45:24.714234 [debug] [Thread-1 (]: Writing injected SQL for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:45:24.716134 [debug] [Thread-1 (]: Began executing node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:45:24.718402 [debug] [Thread-1 (]: Writing runtime sql for node "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:45:24.720095 [debug] [Thread-1 (]: Using snowflake connection "test.proj.unique_temperature_range_datetime.9db51823a8"
[0m03:45:24.720612 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "test.proj.unique_temperature_range_datetime.9db51823a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datetime as unique_field,
    count(*) as n_records

from weather.data.temperature_range
where datetime is not null
group by datetime
having count(*) > 1



      
    ) dbt_internal_test
[0m03:45:24.721042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:25.279912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m03:45:25.284306 [debug] [Thread-1 (]: On test.proj.unique_temperature_range_datetime.9db51823a8: Close
[0m03:45:25.419125 [info ] [Thread-1 (]: 2 of 2 PASS unique_temperature_range_datetime .................................. [[32mPASS[0m in 0.71s]
[0m03:45:25.420609 [debug] [Thread-1 (]: Finished running node test.proj.unique_temperature_range_datetime.9db51823a8
[0m03:45:25.423411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:25.424120 [debug] [MainThread]: Connection 'test.proj.unique_temperature_range_datetime.9db51823a8' was properly closed.
[0m03:45:25.424906 [info ] [MainThread]: 
[0m03:45:25.425606 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m03:45:25.426837 [debug] [MainThread]: Command end result
[0m03:45:25.463076 [info ] [MainThread]: 
[0m03:45:25.463667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:45:25.464087 [info ] [MainThread]: 
[0m03:45:25.464566 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:45:25.467972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5263364, "process_user_time": 2.361303, "process_kernel_time": 0.276475, "process_mem_max_rss": "204596", "process_out_blocks": "1945", "process_in_blocks": "0"}
[0m03:45:25.469093 [debug] [MainThread]: Command `dbt test` succeeded at 03:45:25.469036 after 3.53 seconds
[0m03:45:25.469631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb598d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb587a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb587a4b0>]}
[0m03:45:25.469927 [debug] [MainThread]: Flushing usage events
[0m03:45:28.179602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa365b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa403d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa367b0e0>]}


============================== 03:45:28.184382 | 82a7ad15-d431-4400-b396-981a8ec528b1 ==============================
[0m03:45:28.184382 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:45:28.184941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/proj', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/proj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/proj --project-dir /opt/airflow/proj', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:45:28.705200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83caf9e0>]}
[0m03:45:28.728298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fbfb00>]}
[0m03:45:28.728817 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:45:28.783687 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:45:28.854629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:45:28.854917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:45:28.877260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834661e0>]}
[0m03:45:28.944506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835b2f90>]}
[0m03:45:28.944945 [info ] [MainThread]: Found 7 models, 5 snapshots, 2 data tests, 2 sources, 459 macros
[0m03:45:28.945270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310d910>]}
[0m03:45:28.946452 [info ] [MainThread]: 
[0m03:45:28.947182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:45:28.949590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m03:45:28.959808 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m03:45:28.960108 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m03:45:28.960333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:29.491082 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.531 seconds
[0m03:45:29.493715 [debug] [ThreadPool]: On list_weather: Close
[0m03:45:29.617079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_snapshot)
[0m03:45:29.621969 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m03:45:29.622315 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m03:45:29.622562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:30.104874 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.482 seconds
[0m03:45:30.109240 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m03:45:30.218540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_data)
[0m03:45:30.226258 [debug] [ThreadPool]: Using snowflake connection "list_weather_data"
[0m03:45:30.227379 [debug] [ThreadPool]: On list_weather_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "connection_name": "list_weather_data"} */
show objects in weather.data limit 10000
[0m03:45:30.227945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:30.748577 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.519 seconds
[0m03:45:30.758680 [debug] [ThreadPool]: On list_weather_data: Close
[0m03:45:30.909008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d0ab70>]}
[0m03:45:30.911492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:45:30.912311 [info ] [MainThread]: 
[0m03:45:30.936425 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daily_changes
[0m03:45:30.937319 [info ] [Thread-1 (]: 1 of 5 START snapshot snapshot.snapshot_daily_changes .......................... [RUN]
[0m03:45:30.937981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_data, now snapshot.proj.snapshot_daily_changes)
[0m03:45:30.938416 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daily_changes
[0m03:45:30.952811 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daily_changes
[0m03:45:30.984610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:30.984923 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:45:30.985198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:31.424937 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.439 seconds
[0m03:45:31.480914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:31.481448 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:45:32.444736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m03:45:32.451737 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.452671 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:45:32.558751 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.105 seconds
[0m03:45:32.563053 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.565328 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:45:32.659560 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m03:45:32.664626 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.665280 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:45:32.777784 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m03:45:32.779912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.780152 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
[0m03:45:32.865873 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m03:45:32.875288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.875766 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp"
[0m03:45:32.971132 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m03:45:32.985042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:32.985419 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daily_changes

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:33.282818 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.297 seconds
[0m03:45:33.290283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:33.291352 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:33.393350 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m03:45:33.396024 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daily_changes"
[0m03:45:33.400447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:33.401292 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
BEGIN
[0m03:45:33.543419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m03:45:33.548316 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:33.549189 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAILY_CHANGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMP", "PREV_TEMP", "TEMP_CHANGE", "HUMIDITY", "PREV_HUMIDITY", "HUMIDITY_CHANGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:34.182411 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.632 seconds
[0m03:45:34.183897 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daily_changes"
[0m03:45:34.184269 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daily_changes"} */
COMMIT
[0m03:45:34.415980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m03:45:34.441865 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daily_changes: Close
[0m03:45:34.567712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e160c0>]}
[0m03:45:34.570117 [info ] [Thread-1 (]: 1 of 5 OK snapshotted snapshot.snapshot_daily_changes .......................... [[32mSUCCESS 0[0m in 3.63s]
[0m03:45:34.571698 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daily_changes
[0m03:45:34.572836 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_daylight_duration
[0m03:45:34.574550 [info ] [Thread-1 (]: 2 of 5 START snapshot snapshot.snapshot_daylight_duration ...................... [RUN]
[0m03:45:34.575493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daily_changes, now snapshot.proj.snapshot_daylight_duration)
[0m03:45:34.576203 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_daylight_duration
[0m03:45:34.582482 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_daylight_duration
[0m03:45:34.590796 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:34.591248 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:45:34.591995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:35.036378 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.444 seconds
[0m03:45:35.045347 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:35.045966 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:45:36.129658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.082 seconds
[0m03:45:36.139095 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.140596 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:45:36.229364 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m03:45:36.239512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.240409 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:45:36.362172 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.121 seconds
[0m03:45:36.367721 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.368461 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:45:36.488200 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.119 seconds
[0m03:45:36.494244 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.494835 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
[0m03:45:36.593802 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.098 seconds
[0m03:45:36.599895 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.600637 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp"
[0m03:45:36.691785 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m03:45:36.695879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:36.696346 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.daylight_duration

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:37.053408 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.356 seconds
[0m03:45:37.054539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:37.054823 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:37.146651 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.091 seconds
[0m03:45:37.147687 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_daylight_duration"
[0m03:45:37.149968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:37.150313 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
BEGIN
[0m03:45:37.294603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m03:45:37.295435 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:37.296034 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_DAYLIGHT_DURATION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SUNRISE", "SUNSET", "DAYLIGHT_HOURS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:38.070802 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.774 seconds
[0m03:45:38.072062 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_daylight_duration"
[0m03:45:38.072487 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_daylight_duration"} */
COMMIT
[0m03:45:38.483946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m03:45:38.490392 [debug] [Thread-1 (]: On snapshot.proj.snapshot_daylight_duration: Close
[0m03:45:38.603113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825b79e0>]}
[0m03:45:38.605836 [info ] [Thread-1 (]: 2 of 5 OK snapshotted snapshot.snapshot_daylight_duration ...................... [[32mSUCCESS 0[0m in 4.03s]
[0m03:45:38.607358 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_daylight_duration
[0m03:45:38.608399 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_pressure_drops
[0m03:45:38.609426 [info ] [Thread-1 (]: 3 of 5 START snapshot snapshot.snapshot_pressure_drops ......................... [RUN]
[0m03:45:38.610481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_daylight_duration, now snapshot.proj.snapshot_pressure_drops)
[0m03:45:38.611339 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_pressure_drops
[0m03:45:38.626787 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_pressure_drops
[0m03:45:38.633980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:38.634457 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:45:38.634919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:39.081880 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.447 seconds
[0m03:45:39.094054 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:39.094924 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:45:40.078740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m03:45:40.091728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.092619 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:45:40.186480 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m03:45:40.194592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.195609 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:45:40.301939 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m03:45:40.312310 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.313008 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:45:40.401393 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.088 seconds
[0m03:45:40.408472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.409557 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
[0m03:45:40.491415 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m03:45:40.494981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.495450 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp"
[0m03:45:40.592042 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m03:45:40.601331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.602330 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.pressure_drops

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:40.822859 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.219 seconds
[0m03:45:40.825258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.825988 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:40.936375 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.110 seconds
[0m03:45:40.937374 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.939820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:40.940278 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
BEGIN
[0m03:45:41.046786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m03:45:41.047974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:41.048708 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_PRESSURE_DROPS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "PRESSURE", "PREV_PRESSURE", "PRESSURE_CHANGE", "PRESSURE_DROP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:41.758966 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.709 seconds
[0m03:45:41.760634 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_pressure_drops"
[0m03:45:41.761487 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_pressure_drops"} */
COMMIT
[0m03:45:42.168254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m03:45:42.174317 [debug] [Thread-1 (]: On snapshot.proj.snapshot_pressure_drops: Close
[0m03:45:42.310751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825632c0>]}
[0m03:45:42.312023 [info ] [Thread-1 (]: 3 of 5 OK snapshotted snapshot.snapshot_pressure_drops ......................... [[32mSUCCESS 0[0m in 3.70s]
[0m03:45:42.314111 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_pressure_drops
[0m03:45:42.314911 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_solar_efficiency
[0m03:45:42.317721 [info ] [Thread-1 (]: 4 of 5 START snapshot snapshot.snapshot_solar_efficiency ....................... [RUN]
[0m03:45:42.318437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_pressure_drops, now snapshot.proj.snapshot_solar_efficiency)
[0m03:45:42.318823 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_solar_efficiency
[0m03:45:42.322409 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_solar_efficiency
[0m03:45:42.324842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:42.325126 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:45:42.325418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:42.826924 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.499 seconds
[0m03:45:42.848207 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:42.849711 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:45:43.903131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m03:45:43.915693 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:43.916672 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:45:44.018247 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.100 seconds
[0m03:45:44.027630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.028896 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:45:44.119676 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.090 seconds
[0m03:45:44.124722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.125290 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:45:44.247479 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m03:45:44.260058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.260813 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
[0m03:45:44.371493 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.110 seconds
[0m03:45:44.379171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.380022 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp"
[0m03:45:44.479601 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.099 seconds
[0m03:45:44.490345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.491202 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.solar_efficiency

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:44.713219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.221 seconds
[0m03:45:44.718701 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.719444 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:44.820655 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m03:45:44.821643 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.823971 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.824404 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
BEGIN
[0m03:45:44.964905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m03:45:44.966539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:44.967472 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_SOLAR_EFFICIENCY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "SOLARRADIATION", "CLOUDCOVER", "SOLAR_EFFICIENCY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:45.647289 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.679 seconds
[0m03:45:45.648048 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_solar_efficiency"
[0m03:45:45.648322 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_solar_efficiency"} */
COMMIT
[0m03:45:45.953763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m03:45:45.959895 [debug] [Thread-1 (]: On snapshot.proj.snapshot_solar_efficiency: Close
[0m03:45:46.084603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825cb6b0>]}
[0m03:45:46.086480 [info ] [Thread-1 (]: 4 of 5 OK snapshotted snapshot.snapshot_solar_efficiency ....................... [[32mSUCCESS 0[0m in 3.77s]
[0m03:45:46.087831 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_solar_efficiency
[0m03:45:46.088811 [debug] [Thread-1 (]: Began running node snapshot.proj.snapshot_temperature_range
[0m03:45:46.090130 [info ] [Thread-1 (]: 5 of 5 START snapshot snapshot.snapshot_temperature_range ...................... [RUN]
[0m03:45:46.090835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.proj.snapshot_solar_efficiency, now snapshot.proj.snapshot_temperature_range)
[0m03:45:46.091397 [debug] [Thread-1 (]: Began compiling node snapshot.proj.snapshot_temperature_range
[0m03:45:46.102082 [debug] [Thread-1 (]: Began executing node snapshot.proj.snapshot_temperature_range
[0m03:45:46.105865 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:46.106268 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:45:46.106680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:46.590091 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.483 seconds
[0m03:45:46.599979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:46.600724 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
create or replace temporary table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m03:45:47.602084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m03:45:47.613520 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:47.614424 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:45:47.785052 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.170 seconds
[0m03:45:47.791099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:47.792003 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:45:47.939649 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.147 seconds
[0m03:45:47.944635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:47.945091 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:45:48.040497 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m03:45:48.043517 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.043949 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
[0m03:45:48.148419 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m03:45:48.162700 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.163311 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
describe table "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp"
[0m03:45:48.256753 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m03:45:48.266599 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.267482 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM weather.data.temperature_range

    ),

    snapshotted_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            
  
  coalesce(nullif(datetime, datetime), null)
  as dbt_valid_to
,
            md5(coalesce(cast(datetime as varchar ), '')
         || '|' || coalesce(cast(datetime as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    
,
            datetime as dbt_updated_at,
            datetime as dbt_valid_from,
            datetime as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        datetime as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.datetime))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:48.618493 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.350 seconds
[0m03:45:48.791232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.791738 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:48.888501 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.096 seconds
[0m03:45:48.889053 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.890917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:48.891202 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
BEGIN
[0m03:45:49.036384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m03:45:49.037263 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:49.037995 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
merge into "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE" as DBT_INTERNAL_DEST
    using "WEATHER"."SNAPSHOT"."SNAPSHOT_TEMPERATURE_RANGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATETIME", "TEMPMAX", "TEMPMIN", "TEMP_RANGE", "CONDITIONS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:49.747461 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.709 seconds
[0m03:45:49.748545 [debug] [Thread-1 (]: Using snowflake connection "snapshot.proj.snapshot_temperature_range"
[0m03:45:49.749108 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "proj", "target_name": "dev", "node_id": "snapshot.proj.snapshot_temperature_range"} */
COMMIT
[0m03:45:50.155344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m03:45:50.160767 [debug] [Thread-1 (]: On snapshot.proj.snapshot_temperature_range: Close
[0m03:45:50.296502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a7ad15-d431-4400-b396-981a8ec528b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83464ec0>]}
[0m03:45:50.297549 [info ] [Thread-1 (]: 5 of 5 OK snapshotted snapshot.snapshot_temperature_range ...................... [[32mSUCCESS 0[0m in 4.21s]
[0m03:45:50.298510 [debug] [Thread-1 (]: Finished running node snapshot.proj.snapshot_temperature_range
[0m03:45:50.301602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:50.302303 [debug] [MainThread]: Connection 'snapshot.proj.snapshot_temperature_range' was properly closed.
[0m03:45:50.302954 [info ] [MainThread]: 
[0m03:45:50.303534 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 21.36 seconds (21.36s).
[0m03:45:50.305039 [debug] [MainThread]: Command end result
[0m03:45:50.350973 [info ] [MainThread]: 
[0m03:45:50.351498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:45:50.351877 [info ] [MainThread]: 
[0m03:45:50.352225 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m03:45:50.357291 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 22.234045, "process_user_time": 3.736407, "process_kernel_time": 0.40399, "process_mem_max_rss": "207624", "process_out_blocks": "2086", "process_in_blocks": "0"}
[0m03:45:50.357890 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:45:50.357765 after 22.23 seconds
[0m03:45:50.358374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42be7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36060f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36079e0>]}
[0m03:45:50.358686 [debug] [MainThread]: Flushing usage events
